{
  String dockerImage=config.getDockerImage();
  String name=config.getName();
  Map<String,String> labels=config.getLabels();
  String replicationControllerName=validateKubernetesId(config.getReplicationControllerName(),"replicationControllerName");
  String serviceName=config.getServiceName();
  if (Strings.isNotBlank(serviceName)) {
    serviceName=validateKubernetesId(serviceName,"serviceName");
  }
  if (Strings.notEmpty(serviceName)) {
    if (Objects.equal(serviceName,replicationControllerName)) {
      throw new IllegalArgumentException("replicationControllerName and serviceName are the same! (" + serviceName + ")");
    }
  }
  KubernetesListBuilder builder=new KubernetesListBuilder().withKind("Config").withId(name).addNewReplicationController().withKind("ReplicationController").withId(replicationControllerName).withNewDesiredState().withReplicas(config.getReplicaCount()).withReplicaSelector(config.getLabels()).withNewPodTemplate().withNewDesiredState().withNewManifest().addNewContainer().withName(config.getContainerName()).withImage(dockerImage).withImagePullPolicy(config.getImagePullPolicy()).withEnv(config.getEnvironmentVariables()).endContainer().endManifest().endDesiredState().endPodTemplate().endDesiredState().withLabels(labels).endReplicationController();
  if (serviceName != null) {
    builder=builder.addNewService().withId(serviceName).withKind("Service").withContainerPort(config.getServiceContainerPort()).withPort(config.getServicePort()).withSelector(labels).endService();
  }
  KubernetesList kubernetesList=builder.build();
  try {
    ObjectMapper mapper=new ObjectMapper();
    String generated=mapper.writeValueAsString(kubernetesList);
    Files.writeToFile(kubernetesJson,generated,Charset.defaultCharset());
  }
 catch (  IOException e) {
    throw new IllegalArgumentException("Failed to generate Kubernetes JSON.",e);
  }
}
