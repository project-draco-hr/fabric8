{
  String providerType=options.get("providerType");
  if (providerType == null) {
    throw new RuntimeException("No providerType provided");
  }
  CreateContainerOptions createContainerOptions=null;
  ObjectMapper mapper=new ObjectMapper();
  if (providerType.equals("child")) {
    createContainerOptions=mapper.convertValue(options,CreateContainerChildOptions.class);
    createContainerOptions.setResolver(null);
  }
 else   if (providerType.equals("ssh")) {
    createContainerOptions=mapper.convertValue(options,CreateSshContainerOptions.class);
  }
 else   if (providerType.equals("jclouds")) {
    createContainerOptions=mapper.convertValue(options,CreateJCloudsContainerOptions.class);
  }
  if (createContainerOptions == null) {
    throw new RuntimeException("Unknown provider type : " + providerType);
  }
  createContainerOptions.setZookeeperPassword(getFabricService().getZookeeperPassword());
  createContainerOptions.setZookeeperUrl(getFabricService().getZookeeperUrl());
  CreateContainerMetadata<?> metadatas[]=getFabricService().createContainers(createContainerOptions);
  Map<String,String> rc=new HashMap<String,String>();
  for (  CreateContainerMetadata<?> metadata : metadatas) {
    if (!metadata.isSuccess()) {
      rc.put(metadata.getContainerName(),metadata.getFailure().getMessage());
    }
  }
  return rc;
}
