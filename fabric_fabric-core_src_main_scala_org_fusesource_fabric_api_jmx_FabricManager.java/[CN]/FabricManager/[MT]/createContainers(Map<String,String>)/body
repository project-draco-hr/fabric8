{
  String providerType=options.get("providerType");
  if (providerType == null) {
    throw new RuntimeException("No providerType provided");
  }
  CreateContainerBasicOptions.Builder builder=null;
  ObjectMapper mapper=new ObjectMapper();
  if (providerType.equals("child")) {
    builder=mapper.convertValue(options,CreateChildContainerOptions.Builder.class);
    builder.resolver(null);
  }
 else   if (providerType.equals("ssh")) {
    builder=mapper.convertValue(options,CreateSshContainerOptions.Builder.class);
  }
 else   if (providerType.equals("jclouds")) {
    builder=mapper.convertValue(options,CreateJCloudsContainerOptions.Builder.class);
  }
  if (builder == null) {
    throw new RuntimeException("Unknown provider type : " + providerType);
  }
  builder.zookeeperPassword(getFabricService().getZookeeperPassword());
  builder.zookeeperUrl(getFabricService().getZookeeperUrl());
  CreateContainerMetadata<?> metadatas[]=getFabricService().createContainers(builder.build());
  Map<String,String> rc=new HashMap<String,String>();
  for (  CreateContainerMetadata<?> metadata : metadatas) {
    if (!metadata.isSuccess()) {
      rc.put(metadata.getContainerName(),metadata.getFailure().getMessage());
    }
  }
  return rc;
}
