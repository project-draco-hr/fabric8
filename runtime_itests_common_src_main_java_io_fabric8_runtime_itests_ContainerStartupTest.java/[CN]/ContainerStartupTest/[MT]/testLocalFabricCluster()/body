{
  String zkpassword=System.getProperty(CreateEnsembleOptions.ZOOKEEPER_PASSWORD);
  Assert.assertNotNull(CreateEnsembleOptions.ZOOKEEPER_PASSWORD + " not null",zkpassword);
  Builder<?> builder=CreateEnsembleOptions.builder().agentEnabled(false).clean(true).zookeeperPassword(zkpassword).waitForProvision(false);
  CreateEnsembleOptions options=builder.build();
  ModuleContext syscontext=RuntimeLocator.getRequiredRuntime().getModuleContext();
  ZooKeeperClusterBootstrap bootstrap=syscontext.getService(syscontext.getServiceReference(ZooKeeperClusterBootstrap.class));
  bootstrap.create(options);
  FabricService fabricService=FabricTestSupport.awaitService(FabricService.class);
  Container[] containers=fabricService.getContainers();
  Assert.assertNotNull("Containers not null",containers);
  ConfigurationAdmin configurationAdmin=FabricTestSupport.getService(ConfigurationAdmin.class);
  org.osgi.service.cm.Configuration configuration=configurationAdmin.getConfiguration(io.fabric8.api.Constants.ZOOKEEPER_CLIENT_PID);
  Dictionary<String,Object> dictionary=configuration.getProperties();
  Assert.assertEquals("Expected provided zookeeper password","systempassword",dictionary.get("zookeeper.password"));
}
