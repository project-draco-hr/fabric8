{
  LOG.info("Writing HAProxy file: " + configFile);
  File outFile=new File(configFile);
  outFile.getParentFile().mkdirs();
  PrintWriter writer=new PrintWriter(new FileWriter(outFile));
  try {
    Map<String,MappedServices> mappedServices=getMappedServices();
    CompiledTemplate compiledTemplate=getTemplate();
    Map<String,?> data=createTemplateData();
    String renderedTemplate=TemplateRuntime.execute(compiledTemplate,parserContext,data).toString();
    writer.println(renderedTemplate);
  }
  finally {
    try {
      writer.close();
    }
 catch (    Exception e) {
      LOG.debug("Caught while closing: " + e,e);
    }
  }
}
