{
  boolean connected=getZooKeeper().isConnected();
  Container current=null;
  if (connected) {
    if (getZooKeeper().exists(ZkPath.CLOUD_PROVIDER.getPath(provider)) != null) {
      getZooKeeper().deleteWithChildren(ZkPath.CLOUD_PROVIDER.getPath(provider));
    }
    current=fabricService.getCurrentContainer();
  }
  Configuration[] computeConfigs=findConfigurationByFactoryPid("org.jclouds.compute");
  if (computeConfigs != null) {
    for (    Configuration configuration : computeConfigs) {
      Dictionary props=configuration.getProperties();
      if (props != null) {
        String fabricPid=(String)props.get("fabric.zookeeper.pid");
        if (fabricPid.equals("org.jclouds.compute-" + provider.replaceAll("-",""))) {
          configuration.delete();
        }
      }
    }
  }
  return null;
}
