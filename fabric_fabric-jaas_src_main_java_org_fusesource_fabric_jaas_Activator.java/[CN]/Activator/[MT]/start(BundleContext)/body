{
  ServiceReference configurationAdminReference=context.getServiceReference(ConfigurationAdmin.class.getName());
  if (configurationAdminReference != null) {
    LOG.info("Changing security realm to zookeeper");
    ConfigurationAdmin confAdmin=(ConfigurationAdmin)context.getService(configurationAdminReference);
    Configuration config=confAdmin.getConfiguration("org.apache.karaf.shell");
    Dictionary props=config.getProperties();
    props.put("sshRealm","zookeeper");
    config.setBundleLocation(null);
    config.update(props);
    config=confAdmin.getConfiguration("org.apache.karaf.management");
    props=config.getProperties();
    props.put("jmxRealm","zookeeper");
    config.setBundleLocation(null);
    config.update(props);
  }
}
