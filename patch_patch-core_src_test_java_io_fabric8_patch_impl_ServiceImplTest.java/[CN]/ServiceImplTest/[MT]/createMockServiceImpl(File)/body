{
  BundleContext bundleContext=createMock(BundleContext.class);
  Bundle sysBundle=createMock(Bundle.class);
  BundleContext sysBundleContext=createMock(BundleContext.class);
  Bundle bundle=createMock(Bundle.class);
  expect(bundleContext.getBundle(0)).andReturn(sysBundle);
  expect(sysBundle.getBundleContext()).andReturn(sysBundleContext);
  expect(sysBundleContext.getProperty(Service.PATCH_LOCATION)).andReturn(patches.toString()).anyTimes();
  replay(sysBundleContext,sysBundle,bundleContext,bundle);
  return new ServiceImpl(bundleContext);
}
