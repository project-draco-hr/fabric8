{
  for (  Map<Long,ImportRegistration> registrations : this.importedServices.values()) {
    for (    ImportRegistration registration : registrations.values()) {
      registration.getImportedService().unregister();
    }
  }
  for (  ServiceReference reference : this.exportedServices.keySet()) {
    unExportService(reference);
  }
  this.server.stop();
  this.client.stop();
  this.tree.close();
  if (registration != null) {
    this.registration.unregister();
  }
  this.bundleContext.removeServiceListener(this);
}
