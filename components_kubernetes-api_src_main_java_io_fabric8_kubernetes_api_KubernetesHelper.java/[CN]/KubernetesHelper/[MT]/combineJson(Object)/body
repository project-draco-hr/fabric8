{
  JsonNode config=findOrCreateConfig(objects);
  JsonNode items=config.get("items");
  ArrayNode itemArray;
  if (items instanceof ArrayNode) {
    itemArray=(ArrayNode)items;
  }
 else {
    itemArray=new ArrayNode(createNodeFactory());
    if (config instanceof ObjectNode) {
      ObjectNode objectNode=(ObjectNode)config;
      objectNode.set("items",itemArray);
    }
 else {
      throw new IllegalArgumentException("config " + config + " is not a ObjectNode");
    }
  }
  for (  Object object : objects) {
    if (object != config) {
      addObjectsToItemArray(itemArray,object);
    }
  }
  moveServicesToFrontOfArray(itemArray);
  removeDuplicates(itemArray);
  return config;
}
