{
  Set<CreateOpenshiftContainerMetadata> metadata=new HashSet<CreateOpenshiftContainerMetadata>();
  IUser user=getOrCreateConnection(options).getUser();
  IDomain domain=getOrCreateDomain(user,options);
  int number=Math.max(options.getNumber(),1);
  StandaloneCartridge cartridge=options.isEnsembleServer() ? new StandaloneCartridge(REGISTRY_CART) : new StandaloneCartridge(PLAIN_CART);
  String zookeeperUrl=fabricService.getZookeeperUrl();
  String zookeeperPassword=fabricService.getZookeeperPassword();
  Map<String,String> userEnvVars=new HashMap<String,String>();
  userEnvVars.put("OPENSHIFT_FUSE_ZOOKEEPER_URL",zookeeperUrl);
  userEnvVars.put("OPENSHIFT_FUSE_ZOOKEEPER_PASSWORD",zookeeperPassword);
  String initGitUrl=null;
  int timeout=IHttpClient.NO_TIMEOUT;
  ApplicationScale scale=null;
  for (int i=1; i <= number; i++) {
    IApplication application=domain.createApplication(options.getName(),cartridge,scale,new GearProfile(options.getGearProfile()),initGitUrl,timeout,userEnvVars);
    String containerName=application.getName() + "-" + application.getUUID();
    CreateOpenshiftContainerMetadata meta=new CreateOpenshiftContainerMetadata(domain.getId(),application.getUUID(),application.getCreationLog());
    meta.setContainerName(containerName);
    meta.setCreateOptions(options);
    metadata.add(meta);
  }
  return metadata;
}
