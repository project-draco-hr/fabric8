{
  if (encryption == null) {
    Map<String,String> encOpts=new HashMap<String,String>();
    for (    String key : options.keySet()) {
      if (key.startsWith("encryption.")) {
        encOpts.put(key.substring("encryption.".length()),options.get(key).toString());
      }
    }
    setEncryptionPrefix(encOpts.remove("prefix"));
    setEncryptionSuffix(encOpts.remove("suffix"));
    boolean enabled=Boolean.parseBoolean(encOpts.remove("enabled"));
    if (enabled) {
      encOpts.remove("name");
      encryption=new BasicEncryption(encOpts);
    }
  }
  return encryption;
}
