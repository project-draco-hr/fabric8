{
  Message currentMessage=null;
  Map<String,Object> properties=new HashMap<String,Object>();
  try {
    for (    final Message message : messages) {
      currentMessage=message;
      final Destination targetDestination=getTargetDestination(sendSession,currentMessage.getStringProperty(getDestinationNameHeader()),currentMessage.getBooleanProperty(getDestinationTypeHeader()));
      if (isReuseMessage()) {
        getMessageProperties(currentMessage,properties);
        currentMessage.clearProperties();
        setMessageProperties(currentMessage,properties);
        properties.clear();
      }
 else {
        currentMessage=copyMessage(currentMessage,sendSession);
      }
      if (getDispatchPolicy().getMessageConverter() != null) {
        currentMessage=getDispatchPolicy().getMessageConverter().convert(currentMessage);
      }
      messageProducer.send(targetDestination,currentMessage);
    }
    if (!isReuseSession()) {
      JmsUtils.commitIfNecessary(sendSession);
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Sent " + messages.size() + " messages in session "+ sendSession);
    }
    return null;
  }
 catch (  JMSException exception) {
    LOG.error("Error sending message " + currentMessage + ": "+ exception.getMessage(),exception);
    throw exception;
  }
}
