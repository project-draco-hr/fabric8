{
  String port=System.getProperty("HTTP_PORT");
  if (port == null) {
    port=System.getenv("HTTP_PORT");
  }
  if (port == null) {
    port="8586";
  }
  Integer num=Integer.parseInt(port);
  System.out.println("Starting REST server on port: " + port);
  String service=System.getProperty("SERVICE");
  if (service == null) {
    service=System.getenv("SERVICE");
  }
  if (service == null) {
    service="java-cxf-cdi";
  }
  Map<String,String> env=System.getenv();
  for (  String envName : env.keySet()) {
    System.out.format("%s=%s%n",envName,env.get(envName));
  }
  final Server server=new Server(num);
  final ServletHolder servletHolder=new ServletHolder(new CXFCdiServlet());
  final ServletContextHandler context=new ServletContextHandler();
  context.setContextPath("/");
  context.addEventListener(new Listener());
  context.addEventListener(new BeanManagerResourceBindingListener());
  context.addServlet(servletHolder,"/" + service + "/*");
  server.setHandler(context);
  server.start();
  return server;
}
