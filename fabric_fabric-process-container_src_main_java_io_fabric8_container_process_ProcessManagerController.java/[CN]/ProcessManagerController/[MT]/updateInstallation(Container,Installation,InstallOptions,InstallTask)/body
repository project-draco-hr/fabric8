{
  boolean requiresRestart=false;
  ProcessConfig processConfig=processManager.loadProcessConfig(parameters);
  processConfig.setName(parameters.getName());
  ProcessConfig oldConfig=getProcessConfig(installation);
  String id=installation.getId();
  File installDir=installation.getInstallDir();
  InstallContext installContext=new InstallContext(parameters.getContainer(),installDir,true);
  if (processConfig != null && !oldConfig.equals(processConfig)) {
    installContext.addRestartReason("Environment Variables");
    if (LOG.isDebugEnabled()) {
      LOG.debug("Requires restart as config has changed: OLD: " + JsonHelper.toJson(oldConfig) + " and NEW: "+ JsonHelper.toJson(processConfig));
    }
  }
  if (postInstall != null) {
    postInstall.install(installContext,processConfig,id,installDir);
    JsonHelper.saveProcessConfig(processConfig,installDir);
  }
 else {
    JarInstaller installer=new JarInstaller(parameters,processManager.getExecutor());
    installer.install(installContext,processConfig,id,installDir);
  }
  installContext.updateContainerChecksums();
  if (installContext.isRestartRequired()) {
    LOG.info("Restarting " + container.getId() + " due to profile changes: "+ installContext.getRestartReasons());
    ProcessController controller=installation.getController();
    if (controller != null && container != null && container.isAlive()) {
      controller.restart();
    }
  }
}
