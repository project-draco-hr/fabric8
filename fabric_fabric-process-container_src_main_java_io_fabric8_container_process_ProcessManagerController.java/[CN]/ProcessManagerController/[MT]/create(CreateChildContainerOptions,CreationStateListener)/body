{
  String containerName=options.getName();
  CreateChildContainerMetadata metadata=new CreateChildContainerMetadata();
  metadata.setCreateOptions(options);
  metadata.setContainerName(containerName);
  Map<String,String> environmentVariables=ChildContainers.getEnvironmentVariables(fabricService,options);
  LOG.info("Creating process container with environment vars: " + environmentVariables);
  Installation installation=null;
  try {
    if (ChildContainers.isJavaContainer(fabricService,options)) {
      InstallOptions parameters=createJavaInstallOptions(metadata,options,environmentVariables);
      Objects.notNull(parameters,"JavaInstall parameters");
      installation=processManager.installJar(parameters);
    }
 else {
      InstallOptions parameters=createProcessInstallOptions(metadata,options,environmentVariables);
      InstallTask postInstall=createProcessPostInstall(options);
      Objects.notNull(parameters,"process parameters");
      installation=processManager.install(parameters,postInstall);
    }
  }
 catch (  Exception e) {
    handleException("Creating container " + containerName,e);
  }
  if (installation != null) {
    installation.getController().start();
  }
  return metadata;
}
