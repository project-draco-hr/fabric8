{
  Set<String> profileIds=options.getProfiles();
  String versionId=options.getVersion();
  List<Profile> profiles=Profiles.getProfiles(fabricService,profileIds,versionId);
  String layout=configObject.getOverlayFolder();
  InstallTask answer=createCommonPostInstal(options,environmentVariables,layout);
  if (!configObject.isInternalAgent()) {
    Map<String,File> javaArtifacts=JavaContainers.getJavaContainerArtifactsFiles(fabricService,profiles,downloadExecutor);
    if (!javaArtifacts.isEmpty()) {
      answer=CompositeTask.combine(answer,new InstallDeploymentsTask(javaArtifacts));
      setProvisionList(container,javaArtifacts);
    }
  }
  return answer;
}
