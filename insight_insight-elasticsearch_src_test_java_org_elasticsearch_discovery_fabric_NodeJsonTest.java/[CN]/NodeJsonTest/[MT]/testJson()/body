{
  Map<String,String> attr=new HashMap<String,String>();
  attr.put("key","value");
  DiscoveryNode n=new DiscoveryNode("thename","theid",new InetSocketTransportAddress("thehost",3234),attr,Version.CURRENT);
  FabricDiscovery.ESNode node=new FabricDiscovery.ESNode("thecluster",n,false);
  byte[] data=encode(node);
  System.err.println(new String(data));
  FabricDiscovery.ESNode newNode=decode(data);
  assertEquals(node.getId(),newNode.getId());
  assertEquals(node.getNode().id(),newNode.getNode().id());
  assertEquals(node.getNode().name(),newNode.getNode().name());
  assertEquals(node.getNode().address(),newNode.getNode().address());
  assertEquals(node.getNode().attributes(),newNode.getNode().attributes());
  assertEquals(node.getNode().version().toString(),newNode.getNode().version().toString());
}
