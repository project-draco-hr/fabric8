{
  Map<ProfileVersionKey,Map<String,Parser>> profileArtifacts=new HashMap<ProfileVersionKey,Map<String,Parser>>();
  FabricService fabric=fabricService.get();
  DownloadManager downloadManager=DownloadManagers.createDownloadManager(fabric,executorService);
  Container[] containers=fabric.getContainers();
  for (  Container container : containers) {
    container.getProvisionList();
    Profile[] profiles=container.getProfiles();
    for (    Profile profile : profiles) {
      Profile overlay=profile.getOverlay();
      ProfileVersionKey key=new ProfileVersionKey(profile);
      if (!profileArtifacts.containsKey(key)) {
        Map<String,Parser> artifacts=AgentUtils.getProfileArtifacts(fabric,downloadManager,overlay);
        profileArtifacts.put(key,artifacts);
      }
    }
  }
  return profileArtifacts;
}
