{
  try {
    if (val.length() > 255 || val.getBytes("utf-8").length > 255) {
      return AmqpStringMarshaller.STRING_ENCODING.STR32_UTF8;
    }
  }
 catch (  UnsupportedEncodingException uee) {
    throw new AmqpEncodingError(uee.getMessage(),uee);
  }
  return AmqpStringMarshaller.STRING_ENCODING.STR8_UTF8;
}
