{
  Dependency core=CamelProjectHelper.findCamelCoreDependency(project);
  if (core == null) {
    return null;
  }
  CamelCatalog catalog=new DefaultCamelCatalog();
  List<String> names=catalog.findComponentNames();
  if (excludeComponentsOnClasspath) {
    Set<Dependency> artifacts=findCamelArtifacts(project);
    for (    Dependency dep : artifacts) {
      Set<String> components=componentsFromArtifact(dep.getCoordinate().getArtifactId());
      names.removeAll(components);
    }
  }
  if (label != null && !"<all>".equals(label)) {
    names=filterByLabel(names,label);
  }
  List<ComponentDto> answer=new ArrayList<>();
  for (  String filter : names) {
    ComponentDto dto=createComponentDto(filter);
    answer.add(dto);
  }
  return answer;
}
