{
  try {
    List<CamelEndpointFactoryBean> endpoints=contextElement.getEndpoints();
    List<String> uris=new LinkedList<String>();
    if (endpoints != null) {
      for (      CamelEndpointFactoryBean cefb : endpoints) {
        uris.add(cefb.getUri());
      }
    }
    List<Node> sessions=nodesByNamespace(doc,droolsNamespace.getURI(),"ksession");
    if (sessions != null) {
      for (      Node session : sessions) {
        if (session instanceof Element) {
          Element e=(Element)session;
          String node=e.getAttributeValue("node");
          String sid=e.getAttributeValue("id");
          if (node != null && node.length() > 0 && sid != null && sid.length() > 0) {
            String du="drools:" + node + "/"+ sid;
            boolean exists=false;
            for (            String uri : uris) {
              if (uri.startsWith(du)) {
                exists=true;
              }
            }
            if (!exists) {
              uris.add(du);
            }
          }
        }
      }
    }
    return new TreeSet<String>(uris);
  }
 catch (  Exception e) {
    LOG.error(e.getMessage(),e);
    return new HashSet<String>();
  }
}
