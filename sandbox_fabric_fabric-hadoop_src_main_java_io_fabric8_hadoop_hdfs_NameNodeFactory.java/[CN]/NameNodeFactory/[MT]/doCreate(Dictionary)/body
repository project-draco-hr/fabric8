{
  Configuration conf=new Configuration();
  for (Enumeration e=properties.keys(); e.hasMoreElements(); ) {
    Object key=e.nextElement();
    Object val=properties.get(key);
    conf.set(key.toString(),val.toString());
  }
  boolean exists=false;
  for (  File file : FSNamesystem.getNamespaceDirs(conf)) {
    exists|=file.exists();
  }
  if (!exists) {
    NameNode.format(conf);
  }
  NameNode nameNode=NameNode.createNameNode(null,conf);
  return nameNode;
}
