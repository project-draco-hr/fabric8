{
  while (pending.size() > 0) {
    Object data=pending.getFirst();
    if (!transport.offer(data)) {
      transports.put(transport,State.Writing);
      return;
    }
 else {
      pending.removeFirst();
    }
  }
  transports.put(transport,State.Idle);
}
