{
  String testProfileNameBase="mytestprofile-";
  System.err.println(executeCommand("fabric:create -n"));
  System.err.println(executeCommand("features:install fabric-git"));
  String gitRepoUrl=GitUtils.getMasterUrl(getCurator());
  assertNotNull(gitRepoUrl);
  GitUtils.waitForBranchUpdate(getCurator(),"1.0");
  Git.cloneRepository().setURI(gitRepoUrl).setCloneAllBranches(true).setDirectory(testrepo).setCredentialsProvider(getCredentialsProvider()).call();
  Git git=Git.open(testrepo);
  GitUtils.configureBranch(git,"origin",gitRepoUrl,"1.0");
  git.fetch().setCredentialsProvider(getCredentialsProvider());
  GitUtils.checkoutBranch(git,"origin","1.0");
  assertTrue(new File(testrepo,"default").exists());
  for (int i=1; i <= 5; i++) {
    String testProfileName=testProfileNameBase + i;
    createAndTestProfileInGit(git,"1.0",testProfileName);
  }
}
