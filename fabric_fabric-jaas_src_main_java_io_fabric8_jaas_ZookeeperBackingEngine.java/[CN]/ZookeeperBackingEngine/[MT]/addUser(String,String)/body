{
  String[] infos=null;
  StringBuffer userInfoBuffer=new StringBuffer();
  String newPassword=password;
  if (encryptionSupport != null && encryptionSupport.getEncryption() != null) {
    newPassword=encryptionSupport.getEncryption().encryptPassword(password);
    if (encryptionSupport.getEncryptionPrefix() != null) {
      newPassword=encryptionSupport.getEncryptionPrefix() + newPassword;
    }
    if (encryptionSupport.getEncryptionSuffix() != null) {
      newPassword=newPassword + encryptionSupport.getEncryptionSuffix();
    }
  }
  String userInfos=users.get(username);
  if (userInfos != null && userInfos.length() > 0) {
    infos=userInfos.split(",");
    userInfoBuffer.append(newPassword);
    for (int i=1; i < infos.length; i++) {
      userInfoBuffer.append(",");
      userInfoBuffer.append(infos[i]);
    }
    String newUserInfo=userInfoBuffer.toString();
    users.put(username,newUserInfo);
  }
 else {
    users.put(username,newPassword);
  }
  saveUserProperties();
}
