{
  Project project=getSelectedProject(context);
  Dependency core=findCamelCoreDependency(project);
  if (core == null) {
    return Results.fail("The project does not include camel-core");
  }
  ProjectDto camelProject=new ProjectDto();
  ResourcesFacet resourcesFacet=project.getFacet(ResourcesFacet.class);
  WebResourcesFacet webResourcesFacet=null;
  if (project.hasFacet(WebResourcesFacet.class)) {
    webResourcesFacet=project.getFacet(WebResourcesFacet.class);
  }
  XmlEndpointsCompleter xmlEndpointCompleter=new XmlEndpointsCompleter(resourcesFacet,webResourcesFacet);
  JavaSourceFacet javaSourceFacet=project.getFacet(JavaSourceFacet.class);
  RouteBuilderEndpointsCompleter javaEndpointsCompleter=new RouteBuilderEndpointsCompleter(javaSourceFacet);
  camelProject.addEndpoints(javaEndpointsCompleter.getEndpoints());
  camelProject.addEndpoints(xmlEndpointCompleter.getEndpoints());
  CamelCurrentComponentsFinder componentsFinder=new CamelCurrentComponentsFinder(getCamelCatalog(),project);
  List<ComponentDto> currentComponents=componentsFinder.findCurrentComponents();
  camelProject.setComponents(currentComponents);
  String result=formatResult(camelProject);
  return Results.success(result);
}
