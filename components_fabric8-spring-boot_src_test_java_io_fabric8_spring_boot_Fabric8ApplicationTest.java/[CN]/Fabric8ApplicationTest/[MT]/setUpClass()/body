{
  System.setProperty("MY_CONFIG_TEST","value1");
  System.setProperty("MY_OTHER_CONFIG_TEST","value2");
  System.setProperty("FABRIC8_CONSOLE_SERVICE_PROTOCOL","https");
  System.setProperty("KUBERNETES_PROTOCOL","https");
  FABRIC8_CONSOLE_SERVICE_JSON=Resources.toString(Fabric8ApplicationTest.class.getResource("/mock/fabric8-console-service.json"),Charsets.UTF_8);
  KUBERNETES_SERVICE_JSON=Resources.toString(Fabric8ApplicationTest.class.getResource("/mock/kubernetes-service.json"),Charsets.UTF_8);
  APP_LIBRARY_SERVICE_JSON=Resources.toString(Fabric8ApplicationTest.class.getResource("/mock/app-library-service.json"),Charsets.UTF_8);
  SERVICES_JSON=Resources.toString(Fabric8ApplicationTest.class.getResource("/mock/services.json"),Charsets.UTF_8);
  server.setDispatcher(new Dispatcher(){
    @Override public MockResponse dispatch(    RecordedRequest request) throws InterruptedException {
      if (request.getPath().equals("/api/v1beta3/services") || request.getPath().equals("/api/v1beta3/namespaces/default/services")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody(SERVICES_JSON);
      }
 else       if (request.getPath().matches("/api/[^/]+/namespaces/[^/]+/services/kubernetes")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody(KUBERNETES_SERVICE_JSON);
      }
 else       if (request.getPath().matches("/api/[^/]+/namespaces/[^/]+/services/app-library")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody(APP_LIBRARY_SERVICE_JSON);
      }
 else       if (request.getPath().matches("/api/[^/]+/namespaces/[^/]+/services/fabric8")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody(FABRIC8_CONSOLE_SERVICE_JSON);
      }
 else       if (request.getPath().matches("/osapi/[^/]+/namespaces/[^/]+/routes")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody("{}");
      }
 else       if (request.getPath().matches("/api/[^/]+/namespaces/[^/]+/endpoints")) {
        return new MockResponse().setResponseCode(200).setHeader("Content-Type","application/json").setBody("{}");
      }
 else {
        return new MockResponse().setResponseCode(401);
      }
    }
  }
);
  server.play();
  System.setProperty(KubernetesFactory.KUBERNETES_MASTER_SYSTEM_PROPERTY,"http://" + server.getHostName() + ":"+ server.getPort());
  System.setProperty(KubernetesFactory.KUBERNETES_TRUST_ALL_CERIFICATES,"true");
  System.setProperty(KubernetesFactory.KUBERNETES_VERIFY_SYSTEM_PROPERTY,"false");
}
