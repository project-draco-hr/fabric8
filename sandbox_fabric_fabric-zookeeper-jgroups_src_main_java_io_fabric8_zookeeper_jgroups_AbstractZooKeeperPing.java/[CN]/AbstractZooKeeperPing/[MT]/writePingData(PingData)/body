{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=null;
  try {
    dos=new DataOutputStream(baos);
    data.writeTo(dos);
    if (curator.checkExists().forPath(localNodePath) == null) {
      curator.create().creatingParentsIfNeeded().withMode(getCreateMode()).forPath(localNodePath,baos.toByteArray());
    }
 else {
      curator.setData().forPath(localNodePath,baos.toByteArray());
    }
  }
 catch (  Exception ex) {
    log.error("Error saving ping data",ex);
  }
 finally {
    Util.close(dos);
    Util.close(baos);
  }
}
