{
  try {
    String basedir=System.getProperty("basedir",".");
    File propertiesFile=new File(basedir + "/target/" + envPropertiesFileName).getCanonicalFile();
    File scriptFile=new File(basedir + "/target/" + envScriptFileName).getCanonicalFile();
    Object config=loadKubernetesJson();
    List<HasMetadata> list=KubernetesHelper.toItemList(config);
    Map<String,String> env=getEnvFromConfig(list);
    String namespace=getNamespace();
    env.putAll(getNamespaceServiceEnv(namespace));
    displayEnv(env);
    for (    Map.Entry<String,String> entry : env.entrySet()) {
      String key=entry.getKey();
      String value=entry.getValue();
      if (key == null) {
        getLog().warn("Ignoring null key!");
      }
 else       if (value == null) {
        getLog().warn("Ignoring null value for key: " + key);
      }
 else {
        getProject().getProperties().setProperty(DOCKE_ENV_PREFIX + key,value);
      }
    }
    getProject().getProperties().setProperty(DOCKER_NAME,name);
    getProject().getProperties().setProperty(EXEC_ENV_SCRIPT,scriptFile.getAbsolutePath());
    Properties envProperties=new OrderedProperties();
    Set<Map.Entry<String,String>> entries=env.entrySet();
    for (    Map.Entry<String,String> entry : entries) {
      String key=entry.getKey();
      String value=entry.getValue();
      if (key == null) {
        getLog().warn("Ignoring null key!");
      }
 else       if (value == null) {
        getLog().warn("Ignoring null value for key: " + key);
      }
 else {
        envProperties.put(key,value);
      }
    }
    saveScript(env,scriptFile);
    saveProperties(envProperties,propertiesFile);
  }
 catch (  IOException e) {
    throw new MojoExecutionException("Failed to load environment schemas: " + e,e);
  }
}
