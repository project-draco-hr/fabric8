{
  if (trustStoreURL == null) {
    return getKeyStore();
  }
  if (trustStore == null) {
    if (storeType == null) {
      storeType="JKS";
    }
    if (trustStorePassword == null) {
      trustStorePassword="";
    }
    KeyStore store=KeyStore.getInstance(storeType);
    InputStream stream=trustStoreURL.openStream();
    try {
      store.load(stream,trustStorePassword.toCharArray());
    }
  finally {
      stream.close();
    }
    trustStore=store;
  }
  return trustStore;
}
