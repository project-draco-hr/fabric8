{
  MavenProject project=getProject();
  Properties properties=project.getProperties();
  Map<String,Object> variables=new HashMap<>();
  Set<Map.Entry<Object,Object>> entries=properties.entrySet();
  for (  Map.Entry<Object,Object> entry : entries) {
    Object key=entry.getKey();
    Object value=entry.getValue();
    if (key instanceof String) {
      String keyText=key.toString();
      keyText=keyText.replace('.','_');
      variables.put(keyText,value);
    }
  }
  Map<String,String> labelMap=getLabels();
  String name=getKubernetesName();
  if (labelMap.isEmpty() && Strings.isNotBlank(name)) {
    labelMap.put("component",name);
  }
  IntOrString actualServiceContainerPort=new IntOrString();
  try {
    actualServiceContainerPort.setIntVal(Integer.valueOf(serviceContainerPort));
  }
 catch (  NumberFormatException e) {
    actualServiceContainerPort.setStrVal(serviceContainerPort);
  }
  KubernetesListBuilder builder=new KubernetesListBuilder().withId(name).addNewReplicationController().withId(KubernetesHelper.validateKubernetesId(replicationControllerName,"fabric8.replicationController.name")).withLabels(labels).withNewDesiredState().withReplicas(replicaCount).withReplicaSelector(labelMap).withNewPodTemplate().withLabels(labelMap).withNewDesiredState().withNewManifest().addNewContainer().withName(getKubernetesContainerName()).withImage(getDockerImage()).withImagePullPolicy(getImagePullPolicy()).withEnv(getEnvironmentVariables()).withPorts(getPorts()).endContainer().endManifest().endDesiredState().endPodTemplate().endDesiredState().endReplicationController();
  if (serviceName != null && servicePort != null && actualServiceContainerPort != null && (actualServiceContainerPort.getIntVal() != null || actualServiceContainerPort.getStrVal() != null)) {
    KubernetesListFluent<KubernetesListBuilder>.ServicesNested<KubernetesListBuilder> serviceBuilder=builder.addNewService().withId(serviceName).withContainerPort(actualServiceContainerPort).withPort(servicePort).withSelector(labelMap).withLabels(labelMap);
    if (Strings.isNotBlank(serviceProtocol)) {
      serviceBuilder=serviceBuilder.withProtocol(serviceProtocol);
    }
    builder=serviceBuilder.endService();
  }
  KubernetesList kubernetesList=builder.build();
  try {
    ObjectMapper mapper=new ObjectMapper().enable(SerializationFeature.INDENT_OUTPUT);
    String generated=mapper.writeValueAsString(kubernetesList);
    Files.writeToFile(kubernetesJson,generated,Charset.defaultCharset());
  }
 catch (  IOException e) {
    throw new IllegalArgumentException("Failed to generate Kubernetes JSON.",e);
  }
}
