{
  Parser parser=new Parser(url.substring("mvn:".length()));
  Set<DownloadableArtifact> downloadables;
  if (!parser.getVersion().contains("SNAPSHOT")) {
    downloadables=doCollectPossibleDownloads(parser,Collections.singletonList(system));
    if (!downloadables.isEmpty()) {
      DownloadableArtifact artifact=downloadables.iterator().next();
      URL url=artifact.getArtifactURL();
      File file=new File(URI.create(url.toString()));
      if (file.exists()) {
        return file;
      }
    }
  }
  downloadables=collectPossibleDownloads(parser);
  if (LOG.isTraceEnabled()) {
    LOG.trace("Possible download locations for [" + url + "]");
    for (    DownloadableArtifact artifact : downloadables) {
      LOG.trace("  " + artifact);
    }
  }
  for (  DownloadableArtifact artifact : downloadables) {
    LOG.trace("Downloading [" + artifact + "]");
    try {
      configuration.enableProxy(artifact.getArtifactURL());
      String repository=new File(URI.create(system.getURL().toString())).getPath();
      if (!repository.endsWith(Parser.FILE_SEPARATOR)) {
        repository=repository + Parser.FILE_SEPARATOR;
      }
      InputStream is=artifact.getInputStream();
      File file=new File(repository + parser.getArtifactPath());
      File tmp=new File(file.toString() + ".tmp");
      tmp.getParentFile().mkdirs();
      OutputStream os=new FileOutputStream(tmp);
      copy(is,os);
      file.delete();
      tmp.renameTo(file);
      return file;
    }
 catch (    IOException ignore) {
      LOG.debug(Ix2 + "Could not download [" + artifact+ "]");
      LOG.trace(Ix2 + "Reason [" + ignore.getClass().getName()+ ": "+ ignore.getMessage()+ "]");
    }
  }
  throw new IOException("URL [" + url + "] could not be resolved.");
}
