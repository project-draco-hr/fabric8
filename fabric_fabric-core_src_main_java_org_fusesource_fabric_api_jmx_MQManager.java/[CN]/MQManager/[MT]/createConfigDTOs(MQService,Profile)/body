{
  List<MQBrokerConfigDTO> answer=new ArrayList<MQBrokerConfigDTO>();
  Map<String,Map<String,String>> configurations=profile.getConfigurations();
  Set<Map.Entry<String,Map<String,String>>> entries=configurations.entrySet();
  for (  Map.Entry<String,Map<String,String>> entry : entries) {
    String key=entry.getKey();
    Map<String,String> configuration=entry.getValue();
    if (isBrokerConfigPid(key)) {
      String brokerName=getBrokerNameFromPID(key);
      String profileId=profile.getId();
      MQBrokerConfigDTO dto=new MQBrokerConfigDTO();
      dto.setProfile(profileId);
      dto.setBrokerName(brokerName);
      String version=profile.getVersion();
      dto.setVersion(version);
      Profile[] parents=profile.getParents();
      if (parents != null && parents.length > 0) {
        dto.setParentProfile(parents[0].getId());
      }
      if (configuration != null) {
        dto.setData(configuration.get(DATA));
        dto.setConfigUrl(configuration.get(CONFIG_URL));
        dto.setGroup(configuration.get(GROUP));
        dto.setKind(BrokerKind.fromValue(configuration.get(KIND)));
        dto.setMinimumInstances(Maps.integerValue(configuration,MINIMUM_INSTANCES));
        dto.setNetworks(Maps.stringValues(configuration,NETWORKS));
        dto.setNetworksUserName(configuration.get(NETWORK_USER_NAME));
        dto.setNetworksPassword(configuration.get(NETWORK_PASSWORD));
        dto.setReplicas(Maps.integerValue(configuration,REPLICAS));
      }
      for (      String configurationKey : configuration.keySet()) {
        if (configurationKey.endsWith("-port")) {
          dto.getPorts().put(configurationKey.substring(0,configurationKey.indexOf("-port")),configuration.get(configurationKey));
        }
      }
      answer.add(dto);
    }
  }
  return answer;
}
