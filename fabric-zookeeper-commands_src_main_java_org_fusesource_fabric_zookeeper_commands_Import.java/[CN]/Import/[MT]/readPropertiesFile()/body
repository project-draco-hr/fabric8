{
  List<Pattern> patterns=RegexSupport.getPatterns(regex);
  InputStream in=new BufferedInputStream(new URL(source).openStream());
  List<String> paths=new ArrayList<String>();
  Properties props=new Properties();
  props.load(in);
  for (Enumeration names=props.propertyNames(); names.hasMoreElements(); ) {
    String name=(String)names.nextElement();
    String value=props.getProperty(name);
    if (value != null && value.isEmpty()) {
      value=null;
    }
    if (!name.startsWith("/")) {
      name="/" + name;
    }
    if (!RegexSupport.matches(patterns,name)) {
      continue;
    }
    name=target + name;
    paths.add(name);
    if (!dryRun) {
      getZooKeeper().createOrSetWithParents(name,value,ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 else {
      System.out.printf("Creating path \"%s\" with value \"%s\"\n",name,value);
    }
  }
  if (delete) {
    deletePathsNotIn(paths);
  }
}
