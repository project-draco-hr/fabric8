{
  String zookeeperUrl=curatorConfig.getZookeeperUrl();
  System.out.println("ZK URL: " + zookeeperUrl);
  if (Strings.isNullOrBlank(zookeeperUrl)) {
    System.out.println("No ZK string so creating a local ensemble server");
    serverFactory=new ZooKeeperServerFactory(peerConfig,"rootEnsembleNode");
    zookeeperUrl=serverFactory.getZooKeeperUrl();
    Objects.notNull(zookeeperUrl,"zookeeperUrl");
    curatorConfig.setZookeeperUrl(zookeeperUrl);
  }
  List<ConnectionStateListener> connectionListenerList=new ArrayList<>();
  CuratorFramework curatorFramework=ManagedCuratorFramework.createCuratorFramework(curatorConfig,aclProvider,connectionListenerList);
  curatorFramework.start();
  return curatorFramework;
}
