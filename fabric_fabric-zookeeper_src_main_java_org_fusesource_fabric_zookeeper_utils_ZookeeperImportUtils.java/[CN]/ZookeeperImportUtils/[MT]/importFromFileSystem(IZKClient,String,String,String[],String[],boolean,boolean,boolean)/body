{
  Map<String,String> settings=new TreeMap<String,String>();
  File s=new File(source);
  getCandidates(zooKeeper,s,s,settings,target);
  List<Pattern> include=getPatterns(includeRegex);
  List<Pattern> exclude=getPatterns(excludeRegex);
  if (!target.endsWith("/")) {
    target=target + "/";
  }
  if (!target.startsWith("/")) {
    target="/" + target;
  }
  List<String> paths=new ArrayList<String>();
  for (  Map.Entry<String,String> entry : settings.entrySet()) {
    String key=entry.getKey();
    String data=entry.getValue();
    key=target + key;
    paths.add(key);
    if (!matches(include,key,true) || matches(exclude,key,false)) {
      continue;
    }
    if (!dryRun) {
      if (data != null) {
        if (verbose) {
          System.out.println("importing: " + key);
        }
        ZookeeperCommandBuilder.set(key,data).execute(zooKeeper);
      }
    }
 else {
      System.out.printf("Creating path \"%s\" with value \"%s\"\n",key,data);
    }
  }
  if (delete) {
    deletePathsNotIn(zooKeeper,paths,target,dryRun);
  }
}
