{
  List<Pattern> profile=getPatterns(new String[]{RegexSupport.PROFILE_REGEX});
  List<Pattern> containerProperties=getPatterns(new String[]{RegexSupport.PROFILE_CONTAINER_PROPERTIES_REGEX});
  List<Pattern> attributes=getPatterns(new String[]{RegexSupport.PROFILE_ATTRIBUTES_REGEX});
  if (current.isDirectory()) {
    for (    File child : current.listFiles()) {
      getCandidates(curator,parent,child,settings,target);
    }
    String p=buildZKPath(parent,current).replaceFirst("/","");
    if (!matches(profile,"/" + p,false)) {
      settings.put(p,null);
    }
  }
 else {
    BufferedInputStream in=new BufferedInputStream(new FileInputStream(current));
    byte[] contents=new byte[in.available()];
    in.read(contents);
    in.close();
    String p=buildZKPath(parent,current).replaceFirst("/","");
    if (p.endsWith(".cfg")) {
      p=p.substring(0,p.length() - ".cfg".length());
    }
    if (matches(attributes,"/" + p,false)) {
      settings.put(p.substring(0,p.lastIndexOf('/')),new String(contents));
    }
 else     if (matches(containerProperties,"/" + p,false)) {
      settings.put(p,new String(contents).replaceAll(RegexSupport.PARENTS_REGEX,""));
      Properties props=new Properties();
      props.load(new StringReader(new String(contents)));
      if (settings.get(p.substring(0,p.lastIndexOf('/'))) == null) {
        String parents=(String)props.get("parents");
        if (parents != null && !parents.isEmpty()) {
          settings.put(p.substring(0,p.lastIndexOf('/')),"parents=" + parents);
        }
      }
    }
 else     if (!matches(profile,"/" + p,false)) {
      settings.put(p,new String(contents));
    }
  }
}
