{
  System.err.println(executeCommand("fabric:create -n"));
  Set<ContainerProxy> containers=null;
  ServiceProxy<FabricService> fabricProxy=ServiceProxy.createServiceProxy(bundleContext,FabricService.class);
  try {
    containers=ContainerBuilder.child(fabricProxy,1).withName("child").assertProvisioningResult().build();
    Thread.sleep(5000);
    Container container=containers.iterator().next();
    System.err.println(executeCommands("jaas:manage --realm karaf --module io.fabric8.jaas.ZookeeperLoginModule","jaas:userdel admin","jaas:useradd admin newpassword","jaas:roleadd admin admin","jaas:update"));
    System.err.println(executeCommand("fabric:container-stop --user admin --password newpassword " + container.getId()));
    Provision.containersAlive(containers,false,6 * DEFAULT_TIMEOUT);
  }
  finally {
    ContainerBuilder.destroy(containers);
    fabricProxy.close();
  }
}
