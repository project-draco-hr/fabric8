{
  ClassLoader parentClassLoader;
  if (childClassLoaders == null || childClassLoaders.isEmpty()) {
    parentClassLoader=parent;
  }
 else {
    parentClassLoader=new TreeClassLoader(childClassLoaders,parent);
  }
  List<DependencyTree> dependencies=new ArrayList<DependencyTree>();
  if (!tree.getUrl().endsWith(".pom")) {
    dependencies.add(tree);
  }
  dependencies.addAll(nonSharedDependencies);
  List<URL> urlList=new ArrayList<URL>();
  for (  DependencyTree dependency : dependencies) {
    URL u=getJarURL(dependency);
    urlList.add(u);
  }
  URL[] urls=urlList.toArray(new URL[urlList.size()]);
  return new DependencyClassLoader(tree,urls,parentClassLoader);
}
