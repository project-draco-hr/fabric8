{
  String region=AWSUtils.parseHandle(node.getId())[0];
  Optional<? extends SecurityGroupApi> securityGroupApi=getSecurityGroup(service,region);
  if (securityGroupApi.isPresent()) {
    String groupName="jclouds-" + node.getGroup();
    Optional<? extends SecurityGroup> securityGroup=getSecurityGroupForGroup(securityGroupApi.get(),groupName);
    if (securityGroup.isPresent()) {
      for (      int port : ports) {
        try {
          securityGroupApi.get().createRuleAllowingCidrBlock(securityGroup.get().getId(),Ingress.builder().ipProtocol(org.jclouds.openstack.nova.v2_0.domain.IpProtocol.TCP).fromPort(port).toPort(port).build(),source);
        }
 catch (        IllegalStateException e) {
        }
      }
    }
  }
}
