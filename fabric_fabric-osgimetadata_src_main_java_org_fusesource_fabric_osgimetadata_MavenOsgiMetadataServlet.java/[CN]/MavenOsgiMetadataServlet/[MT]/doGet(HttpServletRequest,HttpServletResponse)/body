{
  resp.setBufferSize(32 * 1024);
  resp.setContentType("application/javascript");
  resp.setContentLength(-1);
  String ae=req.getHeader(HEADER_ACCEPT_ENCODING);
  Writer writer;
  if (ae != null && ae.contains(GZIP)) {
    resp.setHeader(HEADER_CONTENT_ENCODING,GZIP);
    GZIPOutputStream zos=new GZIPOutputStream(resp.getOutputStream(),32 * 1024);
    writer=new BufferedWriter(new OutputStreamWriter(zos));
  }
 else {
    writer=resp.getWriter();
  }
  JsonWriter.write(writer,provider.getMetadatas());
  writer.close();
}
