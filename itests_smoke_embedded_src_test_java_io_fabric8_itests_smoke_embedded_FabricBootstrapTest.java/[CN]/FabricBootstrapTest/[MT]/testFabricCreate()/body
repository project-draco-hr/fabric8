{
  Builder<?> builder=CreateEnsembleOptions.builder().agentEnabled(false).clean(true).waitForProvision(false);
  CreateEnsembleOptions options=builder.build();
  ZooKeeperClusterBootstrap bootstrap=ServiceLocator.getRequiredService(ZooKeeperClusterBootstrap.class);
  bootstrap.create(options);
  FabricService fabricService=ServiceLocator.getRequiredService(FabricService.class);
  Container[] containers=fabricService.getContainers();
  Assert.assertNotNull("Containers not null",containers);
  ServiceLocator.getRequiredService(CuratorFramework.class);
  ServiceLocator.getRequiredService(GitService.class);
  ServiceLocator.getRequiredService(DataStore.class);
  ServiceLocator.getRequiredService(PortService.class);
  ConfigurationAdmin configAdmin=ServiceLocator.getRequiredService(ConfigurationAdmin.class);
  org.osgi.service.cm.Configuration configuration=configAdmin.getConfiguration(io.fabric8.api.Constants.ZOOKEEPER_CLIENT_PID);
  Dictionary<String,Object> dictionary=configuration.getProperties();
  Assert.assertNotNull("Expected provided zookeeper url",dictionary.get("zookeeper.url"));
  assertConfigurations(configAdmin);
}
