{
  if (active.compareAndSet(true,false)) {
    treeCache.getListenable().removeListener(treeListener);
    Closeables.closeQuietly(treeCache);
    treeCache=null;
    treeCacheExecutor.shutdownNow();
    for (    TcpGateway gateway : gateways) {
      gateway.destroy();
    }
  }
}
