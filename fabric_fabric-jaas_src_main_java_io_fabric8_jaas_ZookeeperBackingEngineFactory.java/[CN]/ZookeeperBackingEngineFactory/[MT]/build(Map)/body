{
  assertValid();
  ZookeeperBackingEngine engine=null;
  EncryptionSupport encryptionSupport=new BasicEncryptionSupport(options);
  String path=(String)options.get("path");
  if (path == null) {
    path=ZookeeperBackingEngine.USERS_NODE;
  }
  try {
    if (curator != null) {
      CuratorFramework framework=curator.get();
      if (framework.checkExists().forPath(path) == null) {
        framework.create().creatingParentsIfNeeded().forPath(path);
      }
    }
    ZookeeperProperties users=new ZookeeperProperties(curator.get(),path);
    users.load();
    engine=new ZookeeperBackingEngine(users,encryptionSupport);
  }
 catch (  Exception e) {
    LOGGER.warn("Cannot initialize engine",e);
  }
  return engine;
}
