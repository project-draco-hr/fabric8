{
  boolean editInLine=false;
  ProfileBuilder builder=ProfileBuilder.Factory.createFrom(profile);
  if (delete || remove) {
    editInLine=true;
  }
  if (features != null && features.length > 0) {
    editInLine=true;
    handleFeatures(builder,features,profile);
  }
  if (repositories != null && repositories.length > 0) {
    editInLine=true;
    handleFeatureRepositories(builder,repositories,profile);
  }
  if (libs != null && libs.length > 0) {
    editInLine=true;
    handleLibraries(builder,libs,profile,"lib",LIB_PREFIX);
  }
  if (endorsed != null && endorsed.length > 0) {
    editInLine=true;
    handleLibraries(builder,endorsed,profile,"endorsed lib",ENDORSED_PREFIX);
  }
  if (extension != null && extension.length > 0) {
    editInLine=true;
    handleLibraries(builder,extension,profile,"extension lib",EXT_PREFIX);
  }
  if (bundles != null && bundles.length > 0) {
    editInLine=true;
    handleBundles(builder,bundles,profile);
  }
  if (fabs != null && fabs.length > 0) {
    editInLine=true;
    handleFabs(builder,fabs,profile);
  }
  if (overrides != null && overrides.length > 0) {
    editInLine=true;
    handleOverrides(builder,overrides,profile);
  }
  if (pidProperties != null && pidProperties.length > 0) {
    editInLine=handlePid(builder,pidProperties,profile);
  }
  if (systemProperties != null && systemProperties.length > 0) {
    editInLine=true;
    handleSystemProperties(builder,systemProperties,profile);
  }
  if (configProperties != null && configProperties.length > 0) {
    editInLine=true;
    handleConfigProperties(builder,configProperties,profile);
  }
  if (!editInLine) {
    resource=resource != null ? resource : "io.fabric8.agent.properties";
    if (pidProperties != null && pidProperties.length == 1) {
      resource=pidProperties[0] + ".properties";
    }
    openInEditor(profile,resource);
  }
  profileService.updateProfile(builder.getProfile());
}
