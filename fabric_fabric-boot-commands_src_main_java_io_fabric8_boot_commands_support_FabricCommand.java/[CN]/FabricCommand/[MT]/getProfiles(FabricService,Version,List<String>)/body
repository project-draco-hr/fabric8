{
  List<Profile> allProfiles=version.getProfiles();
  List<Profile> profiles=new ArrayList<>();
  if (names == null) {
    return new Profile[0];
  }
  for (  String profileId : names) {
    Profile profile=null;
    for (    Profile p : allProfiles) {
      if (profileId.equals(p.getId())) {
        profile=p;
        break;
      }
    }
    if (profile == null) {
      ProfileBuilder builder=ProfileBuilder.Factory.create(version.getId(),profileId);
      ProfileService profileService=fabricService.adapt(ProfileService.class);
      profile=profileService.createProfile(builder.getProfile());
    }
    profiles.add(profile);
  }
  return profiles.toArray(new Profile[profiles.size()]);
}
