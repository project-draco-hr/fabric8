{
  if (cacheEnabled) {
    runMarshallCacheEvictionSweep();
  }
  if (o != null) {
    DataStructure c=(DataStructure)o;
    byte type=c.getDataStructureType();
    DataStreamMarshaller dsm=(DataStreamMarshaller)dataMarshallers[type & 0xFF];
    if (dsm == null) {
      throw new IOException("Unknown data type: " + type);
    }
    ds.writeByte(type);
    bs.marshal(ds);
    dsm.tightMarshal2(this,c,ds,bs);
  }
}
