{
  System.out.println("Testing profile:" + profileName + " on container:"+ containerName+ " by adding feature:"+ featureNames);
  FabricService fabricService=getOsgiService(FabricService.class);
  containerSetProfile(containerName,"default");
  Container container=fabricService.getContainer(containerName);
  Version version=container.getVersion();
  Profile targetProfile=fabricService.getProfile(version.getName(),profileName);
  List<String> originalFeatures=targetProfile.getFeatures();
  List<String> testFeatures=new ArrayList(originalFeatures.size());
  Collections.copy(originalFeatures,testFeatures);
  for (  String featureName : featureNames.split(" ")) {
    testFeatures.add(featureNames);
  }
  targetProfile.setFeatures(testFeatures);
  containerSetProfile(containerName,profileName);
  for (  String symbolicName : expectedSymbolicNames.split(" ")) {
    String bundles=executeCommand("container-connect -u admin -p admin " + containerName + " osgi:list -s -t 0 | grep "+ symbolicName);
    Assert.assertNotNull(bundles);
    Assert.assertTrue(bundles.contains(symbolicName));
    System.out.println(bundles);
  }
  containerSetProfile(containerName,"default");
  targetProfile.setFeatures(originalFeatures);
}
