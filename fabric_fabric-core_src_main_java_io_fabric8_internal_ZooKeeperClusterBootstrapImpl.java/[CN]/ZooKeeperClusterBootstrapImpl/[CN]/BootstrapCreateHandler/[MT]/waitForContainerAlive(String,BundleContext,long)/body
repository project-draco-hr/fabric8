{
  System.out.println(String.format("Waiting for container: %s",containerName));
  Exception lastException=null;
  long now=System.currentTimeMillis();
  long end=now + timeout;
  while (!Thread.interrupted() && now < end) {
    FabricService fabricService=ServiceLocator.getRequiredService(FabricService.class);
    try {
      Container container=fabricService.getContainer(containerName);
      if (container != null && container.isAlive()) {
        return;
      }
 else {
        Thread.sleep(500);
        now=System.currentTimeMillis();
      }
    }
 catch (    InterruptedException ex) {
      Thread.currentThread().interrupt();
      lastException=ex;
    }
catch (    Exception ex) {
      lastException=ex;
    }
  }
  TimeoutException toex=new TimeoutException("Cannot create container in time");
  if (lastException != null) {
    toex.initCause(lastException);
  }
  throw toex;
}
