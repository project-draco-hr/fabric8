{
  super.validate();
  IllegalStateAssertion.assertNotNull(profileId,"Profile must have an identity");
  IllegalStateAssertion.assertNotNull(versionId,"Version must be specified");
  for (  Profile profile : parentProfiles.values()) {
    String prfversion=profile.getVersion();
    IllegalStateAssertion.assertEquals(versionId,prfversion,"Profile version not '" + versionId + "' for: "+ profile);
  }
  for (  Entry<String,String> entry : getAttributes().entrySet()) {
    String key=entry.getKey();
    IllegalStateAssertion.assertFalse(key.startsWith(DataStore.ATTRIBUTE_PREFIX),"Invalid attribute key: " + key);
  }
}
