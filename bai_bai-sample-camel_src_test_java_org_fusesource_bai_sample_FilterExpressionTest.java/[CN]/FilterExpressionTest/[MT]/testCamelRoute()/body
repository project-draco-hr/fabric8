{
  String expectedBody="<matched/>";
  String expectedHeader="cheese";
  String ignoreBody="<shouldNotMatch/>";
  resultEndpoint.expectedMessageCount(1);
  template.sendBodyAndHeader(ignoreBody,"foo","ignored");
  template.sendBodyAndHeader(expectedBody,"foo",expectedHeader);
  template.sendBodyAndHeader(ignoreBody,"foo","ignored");
  resultEndpoint.assertIsSatisfied();
  List<Exchange> exchanges=resultEndpoint.getExchanges();
  Exchange exchange=exchanges.get(0);
  AuditEvent auditEvent=exchange.getIn().getMandatoryBody(AuditEvent.class);
  System.out.println("Got: " + auditEvent);
  AbstractExchangeEvent event=auditEvent.getEvent();
  assertTrue("Should be a sent event",event instanceof ExchangeSentEvent);
  String body=auditEvent.getExchange().getIn().getBody(String.class);
  assertEquals("body of audit exchange",expectedBody,body);
  Object header=auditEvent.getExchange().getIn().getHeader("foo");
  assertEquals("foo header of audit exchange",expectedHeader,header);
}
