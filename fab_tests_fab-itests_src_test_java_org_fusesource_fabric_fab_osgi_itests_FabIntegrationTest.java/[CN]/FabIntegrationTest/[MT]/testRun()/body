{
  Thread.sleep(10000);
  assertNotNull(getOsgiService(BlueprintContainer.class,"osgi.blueprint.container.symbolicname=org.apache.karaf.shell.obr",20000));
  assertNotNull(getOsgiService(BlueprintContainer.class,"osgi.blueprint.container.symbolicname=org.apache.karaf.shell.wrapper",20000));
  CommandProcessor cp=getOsgiService(CommandProcessor.class);
  CommandSession cs=cp.createSession(System.in,System.out,System.err);
  cs.execute("osgi:list");
  assertStartBundle("org.apache.karaf.shell.log");
  assertStartBundle("org.fusesource.fabric.fab.fabric-fab-osgi");
  Thread.sleep(1000);
  Thread.sleep(1000);
  cs.execute("osgi:list");
  cs.close();
}
