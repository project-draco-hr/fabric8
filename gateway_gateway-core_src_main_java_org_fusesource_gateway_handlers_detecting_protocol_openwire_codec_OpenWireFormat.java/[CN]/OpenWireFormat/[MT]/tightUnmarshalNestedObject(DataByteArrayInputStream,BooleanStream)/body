{
  if (bs.readBoolean()) {
    byte dataType=dis.readByte();
    DataStreamMarshaller dsm=(DataStreamMarshaller)dataMarshallers[dataType & 0xFF];
    if (dsm == null) {
      throw new IOException("Unknown data type: " + dataType);
    }
    DataStructure data=dsm.createObject();
    if (data.isMarshallAware() && bs.readBoolean()) {
      dis.readInt();
      dis.readByte();
      BooleanStream bs2=new BooleanStream();
      bs2.unmarshal(dis);
      dsm.tightUnmarshal(this,data,dis,bs2);
    }
 else {
      dsm.tightUnmarshal(this,data,dis,bs);
    }
    return data;
  }
 else {
    return null;
  }
}
