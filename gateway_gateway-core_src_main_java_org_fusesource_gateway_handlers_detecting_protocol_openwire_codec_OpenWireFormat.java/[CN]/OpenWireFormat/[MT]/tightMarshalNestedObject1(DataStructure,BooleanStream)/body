{
  bs.writeBoolean(o != null);
  if (o == null) {
    return 0;
  }
  if (o.isMarshallAware()) {
    Buffer sequence=null;
    bs.writeBoolean(sequence != null);
    if (sequence != null) {
      return 1 + sequence.getLength();
    }
  }
  byte type=o.getDataStructureType();
  DataStreamMarshaller dsm=(DataStreamMarshaller)dataMarshallers[type & 0xFF];
  if (dsm == null) {
    throw new IOException("Unknown data type: " + type);
  }
  return 1 + dsm.tightMarshal1(this,o,bs);
}
