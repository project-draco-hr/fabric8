{
  File jbossHome=getContainerHome();
  if (!jbossHome.isDirectory())   throw new IllegalStateException("Not a valid WildFly home dir: " + jbossHome);
  String javaArgs=config.getJavaVmArguments() != null ? config.getJavaVmArguments() : "";
  if (!javaArgs.contains("-Xmx")) {
    javaArgs=WildFlyContainerConfiguration.DEFAULT_JAVAVM_ARGUMENTS + javaArgs;
  }
  File modulesPath=new File(jbossHome,"modules");
  File modulesJar=new File(jbossHome,"jboss-modules.jar");
  if (!modulesJar.exists())   throw new IllegalStateException("Cannot find: " + modulesJar);
  List<String> cmd=new ArrayList<String>();
  cmd.add("java");
  for (  String opt : javaArgs.split("\\s+")) {
    cmd.add(opt);
  }
  cmd.add("-Djboss.home.dir=" + jbossHome);
  cmd.add("-jar");
  cmd.add(modulesJar.getAbsolutePath());
  cmd.add("-mp");
  cmd.add(modulesPath.getAbsolutePath());
  cmd.add("org.jboss.as.standalone");
  cmd.add("-server-config");
  cmd.add(config.getServerConfig());
  ProcessBuilder processBuilder=new ProcessBuilder(cmd);
  processBuilder.redirectErrorStream(true);
  startProcess(processBuilder,config);
}
