{
  if (isReady()) {
    FabricService fabricService=getOsgiService(FabricService.class);
    assertNotNull(fabricService);
    System.err.println(executeCommand("fabric:create"));
    CreateContainerOptions options=CreateContainerOptionsBuilder.ssh().name("ssh1").host(host).port(Integer.parseInt(port)).username(username).password(password).providerUri("ssh://" + username + ":"+ password+ "@"+ host+ ":"+ port);
    CreateContainerMetadata[] metadata=fabricService.createContainers(options);
    assertNotNull(metadata);
    assertEquals(1,metadata.length);
    if (metadata[0].getFailure() != null) {
      throw metadata[0].getFailure();
    }
    assertTrue("Expected succesful creation of remote ssh container",metadata[0].isSuccess());
    assertNotNull("Expected succesful creation of remote ssh container",metadata[0].getContainer());
    waitForProvisionSuccess(metadata[0].getContainer(),3 * PROVISION_TIMEOUT);
    System.out.println(executeCommand("fabric:container-list -v"));
    Container container=fabricService.getContainer("ssh1");
    assertTrue(container.isAlive());
    createAndAssetChildContainer("ssh2","ssh1","default");
    container.stop();
    assertFalse(container.isAlive());
    System.out.println(executeCommand("fabric:container-list -v"));
    container.start();
    waitForProvisionSuccess(container,PROVISION_TIMEOUT);
    System.out.println(executeCommand("fabric:container-list -v"));
    assertTrue(container.isAlive());
    boolean error=false;
    try {
      container.destroy();
    }
 catch (    IllegalStateException ex) {
      error=true;
    }
    assertTrue("Should receive error when trying to destroy a container with alive children.",error);
  }
}
