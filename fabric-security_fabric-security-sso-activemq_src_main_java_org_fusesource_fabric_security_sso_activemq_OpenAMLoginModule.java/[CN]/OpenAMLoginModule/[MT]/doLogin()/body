{
  Callback[] callbacks=new Callback[2];
  callbacks[0]=new NameCallback("Username: ");
  callbacks[1]=new PasswordCallback("Password: ",false);
  try {
    handler.handle(callbacks);
  }
 catch (  IOException ioe) {
    throw new LoginException(ioe.getMessage());
  }
catch (  UnsupportedCallbackException uce) {
    throw new LoginException(uce.getMessage() + " not available to obtain information from user");
  }
  String user=((NameCallback)callbacks[0]).getName();
  char[] tmpPassword=((PasswordCallback)callbacks[1]).getPassword();
  if (tmpPassword == null) {
    tmpPassword=new char[0];
  }
  if (user == null) {
    throw new FailedLoginException("user name is null");
  }
  String pass=new String(tmpPassword);
  token=client.authenticate(user,pass);
  if (token == null) {
    return true;
  }
  if (!client.isValidToken(token)) {
    return true;
  }
  return client.authorize("/login",token);
}
