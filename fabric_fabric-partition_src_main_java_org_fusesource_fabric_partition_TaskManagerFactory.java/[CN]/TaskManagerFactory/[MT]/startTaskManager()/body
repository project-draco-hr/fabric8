{
  if (!balancingPolicies.containsKey(policyType)) {
    LOGGER.warn("Policy type {} not found. Will resume: {} when policy is made available.",policyType,taskId);
  }
 else   if (!partitionListeners.containsKey(workerType)) {
    LOGGER.warn("Worker type {} not found. Will resume: {} when worker type is made available.",workerType,taskId);
  }
 else {
    BalancingPolicy balancingPolicy=balancingPolicies.get(policyType);
    PartitionListener partitionListener=partitionListeners.get(workerType);
    taskManager=new DefaultTaskManager(curator.get(),taskId,taskDefinition,partitionsPath,partitionListener,balancingPolicy);
    taskManager.start();
  }
}
