{
  try {
    if (password != null) {
      Properties users=ZooKeeperUtils.getProperties(service.getZooKeeper(),UserService.USERS_NODE,null);
      if (!users.containsKey(username)) {
        throw new FabricException("No such user " + username);
      }
      users.setProperty(username,encryptPassword(password));
      ZooKeeperUtils.setProperties(service.getZooKeeper(),UserService.USERS_NODE,users);
    }
  }
 catch (  Exception e) {
    throw new FabricException(e);
  }
}
