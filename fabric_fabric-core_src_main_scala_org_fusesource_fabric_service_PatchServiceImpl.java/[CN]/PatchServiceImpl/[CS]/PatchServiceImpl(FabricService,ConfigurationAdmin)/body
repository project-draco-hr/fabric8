{
  Bundle bundle=FrameworkUtil.getBundle(getClass());
  BundleContext bundleContext=bundle != null ? bundle.getBundleContext() : null;
  String dir=bundleContext != null ? bundleContext.getProperty("fuse.patch.location") : System.getProperty("fuse.patch.location");
  this.patchDir=dir != null ? new File(dir) : bundleContext != null ? bundleContext.getDataFile("patches") : null;
  if (this.patchDir == null) {
    throw new IllegalArgumentException("Unable to retrieve patch directory");
  }
  createDir(patchDir);
  this.fabric=fabric;
  this.configAdmin=configAdmin;
}
