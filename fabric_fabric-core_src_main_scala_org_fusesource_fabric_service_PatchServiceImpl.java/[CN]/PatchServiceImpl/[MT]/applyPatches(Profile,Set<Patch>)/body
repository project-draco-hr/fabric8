{
  List<String> bundles=profile.getBundles();
  List<String> newBundles=doApplyPatches(bundles,patches);
  if (!newBundles.equals(bundles)) {
    profile.setBundles(newBundles);
  }
  List<String> fabs=profile.getFabs();
  List<String> newFabs=doApplyPatches(fabs,patches);
  if (!newFabs.equals(fabs)) {
    profile.setFabs(newFabs);
  }
  List<String> repositories=profile.getRepositories();
  List<String> newRepositories=doApplyPatches(repositories,patches);
  if (!newRepositories.equals(repositories)) {
    profile.setRepositories(newRepositories);
  }
  List<String> features=profile.getFeatures();
  List<String> newFeatures=new ArrayList<String>();
  for (  String feature : features) {
    int idx=feature.lastIndexOf('/');
    if (idx > 0) {
      feature=feature.substring(0,idx);
    }
    newFeatures.add(feature);
  }
  if (!newFeatures.equals(features)) {
    profile.setFeatures(newFeatures);
  }
}
