{
  Matcher matcher=PORT_PROPERTY_URL_PATTERN.matcher(value);
  if (!matcher.matches()) {
    throw new IllegalArgumentException("Value doesn't match the port substitution pattern: port:<from port>,<to port>");
  }
  String fromPortValue=matcher.group(1);
  String toPortValue=matcher.group(2);
  int fromPort=Integer.parseInt(fromPortValue);
  int toPort=Integer.parseInt(toPortValue);
  Set<Integer> locallyAllocatedPorts=Ports.findUsedPorts(fromPort,toPort);
  int port=fabricService.get().getPortService().registerPort(fabricService.get().getCurrentContainer(),pid,key,fromPort,toPort,locallyAllocatedPorts);
  return String.valueOf(port);
}
