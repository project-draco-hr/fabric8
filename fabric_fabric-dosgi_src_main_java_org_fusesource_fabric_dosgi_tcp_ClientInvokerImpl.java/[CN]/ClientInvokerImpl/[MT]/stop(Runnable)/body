{
  if (running.compareAndSet(true,false)) {
    queue().execute(new Runnable(){
      public void run(){
        final AtomicInteger latch=new AtomicInteger(transports.size());
        final Runnable coutDown=new Runnable(){
          public void run(){
            if (latch.decrementAndGet() == 0) {
              if (onComplete != null) {
                onComplete.run();
              }
            }
          }
        }
;
        for (        TransportPool pool : transports.values()) {
          pool.stop(coutDown);
        }
      }
    }
);
  }
 else {
    if (onComplete != null) {
      onComplete.run();
    }
  }
}
