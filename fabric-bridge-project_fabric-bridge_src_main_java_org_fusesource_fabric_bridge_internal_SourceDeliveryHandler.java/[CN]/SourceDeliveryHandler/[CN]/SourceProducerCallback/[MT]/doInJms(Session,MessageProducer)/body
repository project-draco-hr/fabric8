{
  Message currentMessage=null;
  try {
    Map<String,Object> properties=new HashMap<String,Object>();
    for (    final Message message : messages) {
      currentMessage=message;
      if (isReuseMessage()) {
        getMessageProperties(currentMessage,properties);
        currentMessage.clearProperties();
        setMessageProperties(currentMessage,properties);
        properties.clear();
      }
 else {
        currentMessage=copyMessage(currentMessage,sendSession);
      }
      if (currentMessage.getStringProperty(getDestinationNameHeader()) == null) {
        currentMessage.setStringProperty(getDestinationNameHeader(),destinationName);
        currentMessage.setBooleanProperty(getDestinationTypeHeader(),pubSubDomain);
      }
      if (getDispatchPolicy().getMessageConverter() != null) {
        currentMessage=getDispatchPolicy().getMessageConverter().convert(currentMessage);
      }
      messageProducer.send(currentMessage);
    }
    if (!isReuseSession()) {
      JmsUtils.commitIfNecessary(sendSession);
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Sent " + messages.size() + " messages to "+ stagingDestination+ " in session "+ sendSession);
    }
    return null;
  }
 catch (  JMSException exception) {
    LOG.error("Error sending message " + currentMessage + ": "+ exception.getMessage(),exception);
    throw exception;
  }
}
