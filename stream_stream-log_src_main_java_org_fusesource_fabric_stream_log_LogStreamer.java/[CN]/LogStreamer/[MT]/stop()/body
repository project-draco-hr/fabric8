{
  if (runAllowed.compareAndSet(true,false)) {
    inputReader.shutdown();
    batchReader.shutdown();
    processor.stop();
  }
  runAllowed.set(false);
}
