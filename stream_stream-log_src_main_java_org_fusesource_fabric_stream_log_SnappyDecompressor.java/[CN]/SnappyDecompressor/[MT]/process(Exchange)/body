{
  Message in=exchange.getIn();
  if (in.getBody() != null) {
    byte[] data=in.getMandatoryBody(byte[].class);
    byte[] uncompressed=Snappy.uncompress(data,0,data.length);
    if (exchange.getPattern().isOutCapable()) {
      Message out=exchange.getOut();
      out.copyFrom(in);
      out.setBody(uncompressed);
    }
 else {
      in.setBody(uncompressed);
    }
  }
}
