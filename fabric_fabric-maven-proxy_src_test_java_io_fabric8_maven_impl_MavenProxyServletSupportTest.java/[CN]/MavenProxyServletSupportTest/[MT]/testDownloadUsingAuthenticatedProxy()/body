{
  testDownload(new AbstractHandler(){
    @Override public void handle(    String target,    Request baseRequest,    HttpServletRequest request,    HttpServletResponse response) throws IOException, ServletException {
      String proxyAuth=request.getHeader("Proxy-Authorization");
      if (proxyAuth == null || proxyAuth.trim().equals("")) {
        response.setStatus(HttpServletResponse.SC_PROXY_AUTHENTICATION_REQUIRED);
        response.addHeader("Proxy-Authenticate","Basic realm=\"Proxy Server\"");
        baseRequest.setHandled(true);
      }
 else {
        response.setStatus(HttpServletResponse.SC_OK);
        baseRequest.setHandled(true);
        response.getOutputStream().write(new byte[]{0x42});
        response.getOutputStream().close();
      }
    }
  }
);
}
