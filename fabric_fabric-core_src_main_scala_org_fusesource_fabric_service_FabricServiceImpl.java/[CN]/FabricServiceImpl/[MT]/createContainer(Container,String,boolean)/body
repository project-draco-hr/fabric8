{
  final String zooKeeperUrl=getZooKeeperUrl();
  createContainerConfig(parent.getId(),name);
  return getContainerTemplate(parent).execute(new ContainerTemplate.AdminServiceCallback<Container>(){
    public Container doWithAdminService(    AdminServiceMBean adminService) throws Exception {
      String javaOpts=zooKeeperUrl != null ? "-Dzookeeper.url=\"" + zooKeeperUrl + "\" -Xmx512M -server" : "";
      if (debugContainer) {
        javaOpts+=ContainerProvider.DEBUG_CONTAINER;
      }
      String features="fabric-agent";
      String featuresUrls="mvn:org.fusesource.fabric/fuse-fabric/" + FabricConstants.FABRIC_VERSION + "/xml/features";
      adminService.createInstance(name,0,0,0,null,javaOpts,features,featuresUrls);
      adminService.startInstance(name,null);
      return new ContainerImpl(parent,name,FabricServiceImpl.this);
    }
  }
);
}
