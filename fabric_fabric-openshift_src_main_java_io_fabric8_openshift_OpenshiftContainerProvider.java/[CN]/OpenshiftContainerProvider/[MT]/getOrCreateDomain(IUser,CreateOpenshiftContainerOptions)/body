{
  if (options.getDomain() == null || options.getDomain().isEmpty()) {
    return user.getDefaultDomain();
  }
 else {
    return domainExists(user,options.getDomain()) ? user.getDomain(options.getDomain()) : user.createDomain(options.getDomain());
  }
}
