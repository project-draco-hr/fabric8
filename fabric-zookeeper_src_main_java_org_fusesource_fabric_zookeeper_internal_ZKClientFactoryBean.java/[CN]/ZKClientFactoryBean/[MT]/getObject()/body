{
  LOG.debug("Connecting to ZooKeeper at " + connectString);
  zkClient=new ZKClient(connectString,getTimeout(),watcher);
  if (connectString.length() == 0) {
    LOG.info("No ZooKeeper URL provided. No connection attempted.");
    return zkClient;
  }
  zkClient.registerListener(new LifecycleListener(){
    final String address=connectString;
    @Override public void onConnected(){
      LOG.debug("Connected to Zookeeper at " + address);
    }
    @Override public void onDisconnected(){
      LOG.debug("Disconnected from ZooKeeper at " + address);
    }
  }
);
  for (  LifecycleListener listener : dynListeners) {
    zkClient.registerListener(listener);
  }
  for (  LifecycleListener listener : listeners) {
    if (listener instanceof ZooKeeperAware) {
      ((ZooKeeperAware)listener).setZooKeeper(zkClient);
    }
    zkClient.registerListener(listener);
  }
  zkClient.start();
  return zkClient;
}
