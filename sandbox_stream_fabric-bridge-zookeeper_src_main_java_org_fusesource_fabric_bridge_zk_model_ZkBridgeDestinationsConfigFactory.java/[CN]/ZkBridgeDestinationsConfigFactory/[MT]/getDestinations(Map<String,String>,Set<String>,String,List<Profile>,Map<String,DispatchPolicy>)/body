{
  List<BridgedDestination> destinations=new ArrayList<BridgedDestination>();
  for (  String prefix : prefixSet) {
    Map<String,String> destinationProps=new HashMap<String,String>();
    for (    Map.Entry<String,String> entry : properties.entrySet()) {
      if (entry.getKey().startsWith(prefix)) {
        destinationProps.put(entry.getKey().substring(prefix.length()),entry.getValue());
      }
    }
    BridgedDestination destination=new BridgedDestination();
    String destinationId=id + "." + prefix.substring(0,prefix.length() - 1);
    destination.setId(destinationId);
    ConfigurablePropertyAccessor accessor=PropertyAccessorFactory.forDirectFieldAccess(destination);
    accessor.setPropertyValues(destinationProps);
    String dispatchPolicyRef=destination.getDispatchPolicyRef();
    if (StringUtils.hasText(dispatchPolicyRef)) {
      destination.setDispatchPolicy(getDispatchPolicy(dispatchPolicies,profiles,dispatchPolicyRef,destinationId + "." + dispatchPolicyRef));
    }
    destinations.add(destination);
  }
  return destinations;
}
