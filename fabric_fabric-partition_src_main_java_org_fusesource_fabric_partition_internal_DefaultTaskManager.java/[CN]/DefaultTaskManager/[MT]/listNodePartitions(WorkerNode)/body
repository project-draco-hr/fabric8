{
  Set<String> paths=node.getPartitions() != null ? Sets.newHashSet(node.getPartitions()) : Sets.<String>newHashSet();
  return Sets.newHashSet(Iterables.transform(paths,new Function<String,Partition>(){
    @Override public Partition apply(    String input){
      try {
        return new PartitionImpl(input,(Map<String,String>)singleton.mapper().readValue(curator.getData().forPath(input),partitionTypeRef));
      }
 catch (      Exception e) {
        LOGGER.warn("Failed to read partition data, using empty configuration instead.");
        return new PartitionImpl(input,Maps.<String,String>newHashMap());
      }
    }
  }
));
}
