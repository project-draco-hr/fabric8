{
  this.curator=checkNotNull(curator,"curator");
  this.taskId=checkNotNull(taskId);
  this.taskDefinition=checkNotNull(taskDefinition);
  this.partitionPath=checkNotNull(partitionPath);
  this.partitionListener=partitionListener;
  this.balancingPolicy=balancingPolicy;
  this.partitionCache=new PathChildrenCache(curator,partitionPath,true,false,executorService);
  this.group=new ZooKeeperGroup<WorkerNode>(curator,ZkPath.TASK.getPath(taskId),WorkerNode.class);
  this.group.add(this);
}
