{
  Feature feature1=createMockFeatureWithOptionalBundles("feature-a","mvn:required/bundle1/1.0","mvn:optional/bundle1/1.0");
  Feature feature2=createMockFeatureWithOptionalBundles("feature-b","mvn:required/bundle2/1.0","mvn:optional/bundle2/1.0");
  Feature[] features=new Feature[]{feature1,feature2};
  assertEquals("feature-a",Features.getFeatureForBundle(features,"mvn:required/bundle1/1.0").getName());
  assertEquals("feature-b",Features.getFeatureForBundle(features,"mvn:required/bundle2/1.0").getName());
  assertNull(Features.getFeatureForBundle(features,"mvn:optional/bundle1/1.0??"));
  assertNull(Features.getFeatureForBundle(features,"mvn:required/bundle3/1.0??"));
  assertEquals("feature-a",Features.getFeatureForBundle(features,DependencyTree.newBuilder("required","bundle1","1.0").build()).getName());
  assertNull(Features.getFeatureForBundle(features,DependencyTree.newBuilder("optional","bundle1","1.0").build()));
}
