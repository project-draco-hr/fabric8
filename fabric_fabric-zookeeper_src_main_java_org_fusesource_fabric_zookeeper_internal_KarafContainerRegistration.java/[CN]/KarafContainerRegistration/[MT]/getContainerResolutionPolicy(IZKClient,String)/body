{
  String policy=ZkDefs.LOCAL_HOSTNAME;
  List<String> validResoverList=Arrays.asList(ZkDefs.VALID_RESOLVERS);
  if (zookeeper.exists(ZkPath.POLICIES.getPath(ZkDefs.RESOLVER)) != null) {
    policy=zookeeper.getStringData(ZkPath.CONTAINER_RESOLVER.getPath(container));
  }
 else   if (System.getProperty(ZkDefs.LOCAL_RESOLVER_PROPERTY) != null && validResoverList.contains(System.getProperty(ZkDefs.LOCAL_RESOLVER_PROPERTY))) {
    policy=System.getProperty(ZkDefs.LOCAL_RESOLVER_PROPERTY);
  }
  if (policy == null || !validResoverList.contains(policy)) {
    policy=getGlobalResolutionPolicy(zookeeper);
  }
  if (policy != null && zookeeper.exists(ZkPath.CONTAINER_RESOLVER.getPath(container)) == null) {
    zookeeper.createOrSetWithParents(ZkPath.CONTAINER_RESOLVER.getPath(container),policy,ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
  return policy;
}
