{
  String policy=ZkDefs.LOCAL_HOSTNAME;
  List<String> validResoverList=Arrays.asList(ZkDefs.VALID_RESOLVERS);
  if (ZooKeeperUtils.exists(zooKeeper,ZkPath.POLICIES.getPath(ZkDefs.RESOLVER)) != null) {
    policy=ZooKeeperUtils.get(zooKeeper,ZkPath.POLICIES.getPath(ZkDefs.RESOLVER));
  }
 else   if (System.getProperty(ZkDefs.GLOBAL_RESOLVER_PROPERTY) != null && validResoverList.contains(System.getProperty(ZkDefs.GLOBAL_RESOLVER_PROPERTY))) {
    policy=System.getProperty(ZkDefs.GLOBAL_RESOLVER_PROPERTY);
    ZooKeeperUtils.set(zooKeeper,ZkPath.POLICIES.getPath("resolver"),policy);
  }
  return policy;
}
