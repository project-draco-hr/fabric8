{
  String user=userDetails.getUser();
  String authorEmail=userDetails.getEmail();
  String branch=userDetails.getBranch();
  T answer=callback.call();
  disableSslCertificateChecks();
  CredentialsProvider credentials=userDetails.createCredentialsProvider();
  PersonIdent personIdent=new PersonIdent(user,authorEmail);
  FileRepositoryBuilder builder=new FileRepositoryBuilder();
  Repository repository=builder.setGitDir(gitFolder).readEnvironment().findGitDir().build();
  Git git=new Git(repository);
  if (Strings.isNullOrBlank(message)) {
    message="";
  }
  doAddCommitAndPushFiles(git,credentials,personIdent,branch,origin,message,isPushOnCommit());
  return answer;
}
