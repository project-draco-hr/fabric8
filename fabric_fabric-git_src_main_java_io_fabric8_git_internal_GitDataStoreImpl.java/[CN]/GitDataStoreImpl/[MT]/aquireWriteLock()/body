{
  final WriteLock writeLock=readWriteLock.writeLock();
  boolean success;
  try {
    success=writeLock.tryLock() || writeLock.tryLock(AQUIRE_LOCK_TIMEOUT,TimeUnit.MILLISECONDS);
  }
 catch (  InterruptedException ex) {
    success=false;
  }
  IllegalStateAssertion.assertTrue(success,"Cannot obtain profile write lock in time");
  allowPullInThreadContext();
  return new LockHandle(){
    @Override public void unlock(){
      writeLock.unlock();
    }
  }
;
}
