{
  LockHandle writeLock=aquireWriteLock();
  try {
    assertValid();
    File sourceDir=new File(importPath);
    if (!sourceDir.isDirectory())     throw new IllegalArgumentException("Not a valid source dir: " + sourceDir.getAbsolutePath());
    File fabricsDir=new File(sourceDir,"fabric");
    File configs=new File(fabricsDir,"configs");
    String defaultVersion=dataStore.get().getDefaultVersion();
    if (configs.exists()) {
      LOGGER.info("Importing the old ZooKeeper layout");
      File versions=new File(configs,"versions");
      if (versions.exists() && versions.isDirectory()) {
        File[] files=versions.listFiles();
        if (files != null) {
          for (          File versionFolder : files) {
            String version=versionFolder.getName();
            if (versionFolder.isDirectory()) {
              File[] versionFiles=versionFolder.listFiles();
              if (versionFiles != null) {
                for (                File versionFile : versionFiles) {
                  LOGGER.info("Importing version configuration " + versionFile + " to branch "+ version);
                  importFromFileSystem(versionFile,GitHelpers.CONFIG_ROOT_DIR,version,true);
                }
              }
            }
          }
        }
      }
      File metrics=new File(fabricsDir,"metrics");
      if (metrics.exists()) {
        LOGGER.info("Importing metrics from " + metrics + " to branch "+ defaultVersion);
        importFromFileSystem(metrics,GitHelpers.CONFIG_ROOT_DIR,defaultVersion,false);
      }
    }
 else {
      String version="1.0";
      LOGGER.info("Importing " + fabricsDir + " as version "+ version);
      importFromFileSystem(fabricsDir,"",version,false);
    }
  }
  finally {
    writeLock.unlock();
  }
}
