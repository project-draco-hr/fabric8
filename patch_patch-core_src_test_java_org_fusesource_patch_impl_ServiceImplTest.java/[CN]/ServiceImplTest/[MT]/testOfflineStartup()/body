{
  Offline offline=new Offline(karaf);
  String startup;
  String overrides;
  writeFully(new File(karaf,"etc/startup.properties"),"foo/my-bsn/1.3.1/my-bsn-1.3.1.jar=1");
  offline.apply(patch132);
  startup=readFully(new File(karaf,"etc/startup.properties"));
  overrides=readFully(new File(karaf,"etc/overrides.properties"));
  assertEquals("foo/my-bsn/1.3.2/my-bsn-1.3.2.jar=1",startup.trim());
  assertEquals("mvn:foo/my-bsn/1.3.2",overrides.trim());
  assertTrue(new File(karaf,"system/foo/my-bsn/1.3.2/my-bsn-1.3.2.jar").exists());
  assertFalse(new File(karaf,"system/foo/my-bsn/1.4.0/my-bsn-1.4.0.jar").exists());
  assertFalse(new File(karaf,"system/foo/my-bsn/2.0.0/my-bsn-2.0.0.jar").exists());
  offline.apply(patch140);
  startup=readFully(new File(karaf,"etc/startup.properties"));
  overrides=readFully(new File(karaf,"etc/overrides.properties"));
  assertEquals("foo/my-bsn/1.4.0/my-bsn-1.4.0.jar=1",startup.trim());
  assertEquals("mvn:foo/my-bsn/1.4.0;range=[1.3.0,1.5.0)",overrides.trim());
  assertFalse(new File(karaf,"system/foo/my-bsn/1.3.2/my-bsn-1.3.2.jar").exists());
  assertTrue(new File(karaf,"system/foo/my-bsn/1.4.0/my-bsn-1.4.0.jar").exists());
  assertFalse(new File(karaf,"system/foo/my-bsn/2.0.0/my-bsn-2.0.0.jar").exists());
  offline.apply(patch200);
  startup=readFully(new File(karaf,"etc/startup.properties"));
  overrides=readFully(new File(karaf,"etc/overrides.properties"));
  assertEquals("foo/my-bsn/1.4.0/my-bsn-1.4.0.jar=1",startup.trim());
  assertEquals("mvn:foo/my-bsn/1.4.0;range=[1.3.0,1.5.0)\nmvn:foo/my-bsn/2.0.0",overrides.trim());
  assertFalse(new File(karaf,"system/foo/my-bsn/1.3.2/my-bsn-1.3.2.jar").exists());
  assertTrue(new File(karaf,"system/foo/my-bsn/1.4.0/my-bsn-1.4.0.jar").exists());
  assertTrue(new File(karaf,"system/foo/my-bsn/2.0.0/my-bsn-2.0.0.jar").exists());
}
