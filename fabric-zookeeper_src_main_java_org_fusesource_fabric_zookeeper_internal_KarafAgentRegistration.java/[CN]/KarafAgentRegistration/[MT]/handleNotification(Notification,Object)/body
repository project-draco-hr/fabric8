{
  if (notif instanceof MBeanServerNotification) {
    MBeanServerNotification notification=(MBeanServerNotification)notif;
    String domain=notification.getMBeanName().getDomain();
    String path=AGENT_DOMAIN.getPath((String)o,domain);
    try {
      if (MBeanServerNotification.REGISTRATION_NOTIFICATION.equals(notification.getType())) {
        if (zooKeeper.exists(path) == null) {
          zooKeeper.create(path,"",ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
        }
      }
 else       if (MBeanServerNotification.UNREGISTRATION_NOTIFICATION.equals(notification.getType())) {
        if (Arrays.binarySearch(mbeanServer.getDomains(),domain) == -1) {
          zooKeeper.delete(path);
        }
      }
    }
 catch (    Exception e) {
      logger.warn("Exception while jmx domain synchronization",e);
    }
  }
}
