{
  if (Config.smartIndex) {
    String pattern=Config.smartIndexPattern;
    if (pattern == null) {
      pattern="'logstash-'yyyy.MM.dd";
    }
    Set<String> requested=new TreeSet<String>();
    for (    String p : pattern.split(",")) {
      SimpleDateFormat fmt=new SimpleDateFormat(p.trim());
      long stepTime=from;
      do {
        requested.add(fmt.format(new Date(stepTime)));
      }
 while ((stepTime+=Config.smartIndexStep) <= to);
      requested.add(fmt.format(new Date(to)));
    }
    requested.retainAll(getAllIndices());
    if (requested.size() <= Config.smartIndexLimit) {
      List<String> l=new ArrayList<String>(requested);
      Collections.reverse(l);
      if (limit > 0 && l.size() > limit) {
        l=l.subList(0,limit);
      }
      return l;
    }
 else {
      return Collections.singletonList(Config.defaultIndex);
    }
  }
 else {
    return Collections.singletonList(Config.defaultIndex);
  }
}
