{
  LOGGER.debug("\thash: {}",hash);
  LOGGER.debug("\tsegment: {}",segment);
  ClientRequest req=new ClientRequest(hash);
  Query query=Config.highlightResults ? new HighlightedQuery(req.getSearch(),req.getFrom(),req.getTo(),req.getOffset()) : new SortedQuery(req.getSearch(),req.getFrom(),req.getTo(),req.getOffset());
  LOGGER.debug("\tclient: {}",req);
  LOGGER.debug("\tquery: {}",query);
  Collection<String> indices=Kelastic.getIndices(req.getFrom(),req.getTo());
  LOGGER.debug("\tindices: {}",indices);
  ObjectNode result=kelasticMulti(query,indices);
  ObjectNode time=result.with("kibana").putObject("time");
  time.put("from",formatDate(new Date(req.getFrom())));
  time.put("to",formatDate(new Date(req.getTo())));
  ArrayNode fields=result.with("kibana").putArray("default_fields");
  for (  String s : Config.defaultFields) {
    fields.add(s);
  }
  result.with("kibana").put("clickable_urls",Config.clickableUrls);
  return Json.serialize(result);
}
