{
  ClientRequest req=new ClientRequest(hash);
  Query query=new StatsFacet(req.getSearch(),req.getFrom(),req.getTo(),field);
  LOGGER.debug("\tclient: {}",req);
  LOGGER.debug("\tquery: {}",query);
  List<String> indices=Kelastic.getIndices(req.getFrom(),req.getTo(),Config.facetIndexLimit);
  String type=Kelastic.getFieldType(indices.get(0),field);
  if ("long".equals(type) || "integer".equals(type) || "double".equals(type)|| "float".equals(type)) {
    ObjectNode result=new KelasticMultiFlat(query,indices).getResponse();
    ObjectNode time=((ObjectNode)result.get("kibana")).putObject("time");
    time.put("from",formatDate(new Date(req.getFrom())));
    time.put("to",formatDate(new Date(req.getTo())));
    String str=Json.serialize(result);
    return str;
  }
 else {
    ObjectNode node=Json.objectNode();
    node.put("error","Statistics not supported for type: " + type);
    return Json.serialize(node);
  }
}
