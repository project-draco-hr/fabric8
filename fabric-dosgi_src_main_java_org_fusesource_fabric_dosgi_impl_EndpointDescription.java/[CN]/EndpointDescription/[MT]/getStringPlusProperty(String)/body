{
  Object value=properties.get(key);
  if (value == null) {
    return Collections.EMPTY_LIST;
  }
  if (value instanceof String) {
    return Collections.singletonList((String)value);
  }
  if (value instanceof String[]) {
    String[] values=(String[])value;
    List<String> result=new ArrayList<String>(values.length);
    for (    String v : values) {
      if (v != null) {
        result.add(v);
      }
    }
    return Collections.unmodifiableList(result);
  }
  if (value instanceof Collection<?>) {
    Collection<?> values=(Collection<?>)value;
    List<String> result=new ArrayList<String>(values.size());
    for (Iterator<?> iter=values.iterator(); iter.hasNext(); ) {
      Object v=iter.next();
      if (v instanceof String) {
        result.add((String)v);
      }
    }
    return Collections.unmodifiableList(result);
  }
  return Collections.EMPTY_LIST;
}
