{
  List<Profile> list=new ArrayList<Profile>(existingProfiles.length);
  for (  Profile old : existingProfiles) {
    Profile newProfile=targetVersion.getRequiredProfile(old.getId());
    if (newProfile != null) {
      list.add(newProfile);
    }
 else {
      throw new IllegalArgumentException("Profile " + old.getId() + " with version "+ targetVersion.getId()+ " does not exists");
    }
  }
  return list.toArray(new Profile[0]);
}
