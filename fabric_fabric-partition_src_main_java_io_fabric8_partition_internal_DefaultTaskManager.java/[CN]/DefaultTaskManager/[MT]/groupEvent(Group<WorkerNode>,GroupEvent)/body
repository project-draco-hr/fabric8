{
switch (event) {
case CONNECTED:
case CHANGED:
    WorkerNode state=createNode();
  if (group.isMaster()) {
    startWatchingForTasks();
    state.setDefinition(taskDefinition);
    group.update(state);
    executorService.submit(new RebalanceTask());
  }
 else {
    group.update(state);
    stopWatchingForTasks();
  }
break;
case DISCONNECTED:
stopWatchingForTasks();
}
}
