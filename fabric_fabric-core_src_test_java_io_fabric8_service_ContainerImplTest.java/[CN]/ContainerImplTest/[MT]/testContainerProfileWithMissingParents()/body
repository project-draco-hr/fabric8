{
  String v="1.0";
  String profile1Id="feature-camel";
  String profile2Id="feature-cxf";
  String missing="missing";
  Version version=new VersionImpl(v,fabricService);
  List<String> profiles=Arrays.asList(profile1Id,profile2Id,missing);
  expect(fabricService.getVersion(eq(v))).andReturn(version).anyTimes();
  expect(fabricService.getEnvironment()).andReturn("").anyTimes();
  expect(dataStore.getContainerVersion(eq(CONTAINER_ID))).andReturn(v).anyTimes();
  expect(dataStore.getContainerProfiles(eq(CONTAINER_ID))).andReturn(profiles).anyTimes();
  expect(dataStore.hasProfile(v,profile1Id)).andReturn(true).anyTimes();
  expect(dataStore.hasProfile(v,profile2Id)).andReturn(true).anyTimes();
  expect(dataStore.hasProfile(v,missing)).andReturn(false).anyTimes();
  expect(dataStore.getProfileAttributes(eq(v),EasyMock.<String>anyObject())).andReturn(Maps.<String,String>newHashMap()).anyTimes();
  replay(fabricService);
  replay(dataStore);
  Profile overlay=container.getOverlayProfile();
  Profile[] parents=overlay.getParents();
  assertEquals(2,parents.length);
  verify(fabricService);
  verify(dataStore);
}
