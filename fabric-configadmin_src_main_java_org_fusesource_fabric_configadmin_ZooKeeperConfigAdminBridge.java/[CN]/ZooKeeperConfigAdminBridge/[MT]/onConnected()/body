{
  try {
    version=zooKeeper.getStringData(agentNode + "/" + name);
    if (version == null) {
      throw new IllegalStateException("Configuration for node " + name + " not found at "+ agentNode+ "/"+ name);
    }
    node=versionsNode + "/" + version+ "/agents/"+ name;
    if (zooKeeper.exists(node) == null) {
      zooKeeper.createWithParents(node,null,ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
    trees=new ConcurrentHashMap<String,ZooKeeperTreeTracker<String>>();
    tracking=true;
    try {
      track(node);
    }
  finally {
      tracking=false;
    }
    onEvents(null);
  }
 catch (  Exception e) {
    LOGGER.log(Level.WARNING,"Exception when tracking configurations",e);
  }
}
