{
  Map<String,String> nodeAttributes=discoveryNodeService.buildAttributes();
  String nodeId=UUID.randomBase64UUID();
  String host=settings.get("discovery.publish.host");
  String port=settings.get("discovery.publish.port");
  if (host != null && port != null) {
    TransportAddress address=new InetSocketTransportAddress(host,Integer.parseInt(port));
    localNode=new DiscoveryNode(settings.get("name"),nodeId,address,nodeAttributes);
  }
 else {
    localNode=new DiscoveryNode(settings.get("name"),nodeId,transportService.boundAddress().publishAddress(),nodeAttributes);
  }
  tracker.open();
}
