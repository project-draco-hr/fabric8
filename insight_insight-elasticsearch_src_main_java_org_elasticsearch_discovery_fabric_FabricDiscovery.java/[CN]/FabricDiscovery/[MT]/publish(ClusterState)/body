{
  if (!singleton.isMaster()) {
    throw new ElasticSearchIllegalStateException("Shouldn't publish state when not master");
  }
  latestDiscoNodes=clusterState.nodes();
  publishClusterState.publish(clusterState);
}
