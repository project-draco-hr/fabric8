{
  configuration=Collections.unmodifiableMap(config);
  Properties props=new Properties();
  for (  Entry<String,?> entry : config.entrySet()) {
    props.put(entry.getKey(),entry.getValue());
  }
  try {
    peerConfig=new QuorumPeerConfig();
    peerConfig.parseProperties(props);
    LOGGER.info("Created zookeeper peer configuration: {}",peerConfig);
  }
 catch (  RuntimeException rte) {
    throw rte;
  }
catch (  Exception ex) {
    throw new IllegalStateException("Cannot create peer config from: " + props);
  }
  try {
    serverConfig=new ServerConfig();
    serverConfig.readFrom(peerConfig);
    LOGGER.info("Created zookeeper server configuration: {}",serverConfig);
  }
 catch (  RuntimeException rte) {
    throw rte;
  }
catch (  Exception ex) {
    throw new IllegalStateException("Cannot create server config from: " + props);
  }
  activateComponent();
}
