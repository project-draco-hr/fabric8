{
  try {
    final String zooKeeperUrl=getZooKeeperUrl();
    URI uri=URI.create(url);
    AgentProvider provider=getProvider(uri.getScheme());
    if (provider == null) {
      throw new FabricException("Unable to find an agent provider supporting uri '" + url + "'");
    }
    createAgentConfig(name);
    provider.create(uri,name,zooKeeperUrl);
    return new AgentImpl(null,name,FabricServiceImpl.this);
  }
 catch (  FabricException e) {
    throw e;
  }
catch (  Exception e) {
    throw new FabricException(e);
  }
}
