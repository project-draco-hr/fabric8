{
  try {
    final String zooKeeperUrl=getZooKeeperUrl();
    createAgentConfig("",name);
    for (    AgentProvider provider : providers.values()) {
      if (provider.create(args,name,zooKeeperUrl)) {
        return new AgentImpl(null,name,FabricServiceImpl.this);
      }
    }
    throw new IllegalArgumentException("Unknown CreateAgentArguments " + args + " when creating agent "+ name);
  }
 catch (  FabricException e) {
    throw e;
  }
catch (  Exception e) {
    throw new FabricException(e);
  }
}
