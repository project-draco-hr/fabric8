{
  FabricService service=fabricService.get();
  Kubernetes kubernetes=getKubernetes();
  if (kubernetes != null && service != null) {
    try {
      PodListSchema podSchema=kubernetes.getPods();
      List<PodSchema> pods=podSchema.getItems();
      Container[] containerArray=service.getContainers();
      if (pods != null) {
        Map<String,Container> containerMap=createPodIdToContainerMap(containerArray);
        for (        PodSchema item : pods) {
          String podId=item.getId();
          CurrentState currentState=item.getCurrentState();
          if (currentState != null) {
            String host=currentState.getHost();
            String hostIp=currentState.getHost();
            String status=currentState.getStatus();
            Container container=containerMap.remove(podId);
            if (container != null) {
              DesiredState desiredState=item.getDesiredState();
              if (desiredState != null) {
                ManifestSchema manifest=desiredState.getManifest();
                if (manifest != null) {
                  List<ManifestContainer> containers=manifest.getContainers();
                  for (                  ManifestContainer manifestContainer : containers) {
                  }
                }
              }
              if (!container.isAlive()) {
                container.setAlive(true);
              }
              if (status != null) {
                String result=currentStatusStringToContainerProvisionResult(status);
                if (isProvisionSuccess(result)) {
                  keepAliveCheck(service,status,container,currentState,item);
                }
 else {
                  if (!result.equals(container.getProvisionResult())) {
                    container.setProvisionResult(result);
                  }
                }
              }
 else {
                if (container.isAlive()) {
                  container.setAlive(false);
                }
                if (!status.equals(container.getProvisionResult())) {
                  container.setProvisionResult(status);
                }
              }
            }
          }
        }
        Collection<Container> deadContainers=containerMap.values();
        for (        Container container : deadContainers) {
          CreateContainerMetadata<?> metadata=container.getMetadata();
          if (metadata instanceof CreateKubernetesContainerMetadata) {
            if (container.isAlive()) {
              container.setAlive(false);
            }
            String status=Container.PROVISION_STOPPED;
            if (!status.equals(container.getProvisionResult())) {
              container.setProvisionResult(status);
            }
          }
        }
      }
      Map<String,PodSchema> podMap=KubernetesHelper.toPodMap(pods);
      Map<String,ReplicationControllerSchema> replicationMap=KubernetesHelper.toReplicationControllerMap(kubernetes.getReplicationControllers());
      Map<String,ServiceSchema> serviceMap=KubernetesHelper.toServiceMap(kubernetes.getServices());
      checkKubeletContainers(service,containerArray,podMap,replicationMap,serviceMap);
    }
 catch (    Exception e) {
      LOGGER.warn("Health Check Caught: " + e,e);
    }
  }
 else {
    LOGGER.warn("Cannot perform kubernetes health check. kubernetes: " + kubernetes + " fabricService: "+ service);
  }
}
