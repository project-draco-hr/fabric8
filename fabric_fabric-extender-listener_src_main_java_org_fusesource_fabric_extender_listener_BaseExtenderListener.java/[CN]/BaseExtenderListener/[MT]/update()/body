{
  int starting=0;
  int failed=0;
  int waiting=0;
  int stopping=0;
  for (  Map.Entry<Long,ModuleStatus> entry : status.entrySet()) {
    ModuleStatus moduleStatus=entry.getValue();
    if (moduleStatus == ModuleStatus.FAILED) {
      failed++;
    }
 else     if (moduleStatus == ModuleStatus.WAITING) {
      waiting++;
    }
 else     if (moduleStatus == ModuleStatus.STOPPING) {
      stopping++;
    }
 else     if (moduleStatus == ModuleStatus.STARTING) {
      starting++;
    }
  }
  if (failed > 0) {
    setData(curator,ZkPath.CONTAINER_EXTENDER_STATUS.getPath(name,getExtenderType()),ModuleStatus.FAILED.name(),CreateMode.EPHEMERAL);
  }
 else   if (waiting > 0) {
    setData(curator,ZkPath.CONTAINER_EXTENDER_STATUS.getPath(name,getExtenderType()),ModuleStatus.WAITING.name(),CreateMode.EPHEMERAL);
  }
 else   if (stopping > 0) {
    setData(curator,ZkPath.CONTAINER_EXTENDER_STATUS.getPath(name,getExtenderType()),ModuleStatus.STOPPING.name(),CreateMode.EPHEMERAL);
  }
 else   if (starting > 0) {
    setData(curator,ZkPath.CONTAINER_EXTENDER_STATUS.getPath(name,getExtenderType()),ModuleStatus.STARTING.name(),CreateMode.EPHEMERAL);
  }
 else {
    setData(curator,ZkPath.CONTAINER_EXTENDER_STATUS.getPath(name,getExtenderType()),ModuleStatus.STARTED.name(),CreateMode.EPHEMERAL);
  }
}
