{
  Builder<?> builder=CreateEnsembleOptions.builder().agentEnabled(false).clean(true).waitForProvision(false);
  ServiceLocator.getRequiredService(ZooKeeperClusterBootstrap.class).create(builder.build());
  Path dataPath=ServiceLocator.getRequiredService(RuntimeProperties.class).getDataPath();
  Path remoteRepoPath=dataPath.resolve(Paths.get("git","remote","fabric"));
  remoteRoot=remoteRepoPath.toFile();
  recursiveDelete(remoteRoot.toPath());
  remoteRoot.mkdirs();
  URL remoteUrl=remoteRepoPath.toFile().toURI().toURL();
  git=Git.init().setDirectory(remoteRoot).call();
  ConfigurationAdmin configAdmin=ServiceLocator.getRequiredService(ConfigurationAdmin.class);
  Configuration config=configAdmin.getConfiguration(Constants.DATASTORE_PID);
  Dictionary<String,Object> properties=config.getProperties();
  properties.put("configuredUrl",remoteUrl.toExternalForm());
  config.update(properties);
  ProfileRegistry profileRegistry=ServiceLocator.awaitService(ProfileRegistry.class);
  Map<String,String> dsprops=profileRegistry.getDataStoreProperties();
  while (!dsprops.containsKey("configuredUrl")) {
    Thread.sleep(200);
    profileRegistry=ServiceLocator.awaitService(ProfileRegistry.class);
    dsprops=profileRegistry.getDataStoreProperties();
  }
}
