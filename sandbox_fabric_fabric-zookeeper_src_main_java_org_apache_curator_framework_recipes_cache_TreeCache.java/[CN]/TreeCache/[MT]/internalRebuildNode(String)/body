{
  if (cacheData) {
    try {
      Stat stat=new Stat();
      byte[] bytes=dataIsCompressed ? client.getData().decompressed().storingStatIn(stat).forPath(fullPath) : client.getData().storingStatIn(stat).forPath(fullPath);
      List<String> children=client.getChildren().forPath(fullPath);
      currentData.put(fullPath,new TreeData(fullPath,stat,bytes,children));
      for (      String child : children) {
        String childPath=ZKPaths.makePath(fullPath,child);
        internalRebuildNode(childPath);
      }
    }
 catch (    KeeperException.NoNodeException ignore) {
      currentData.invalidate(fullPath);
      removeFromParent(fullPath);
    }
  }
 else {
    Stat stat=client.checkExists().forPath(fullPath);
    if (stat != null) {
      List<String> children=client.getChildren().forPath(fullPath);
      currentData.put(fullPath,new TreeData(fullPath,stat,null,children));
      for (      String child : children) {
        String childPath=ZKPaths.makePath(fullPath,child);
        internalRebuildNode(childPath);
      }
    }
 else {
      currentData.invalidate(fullPath);
      removeFromParent(fullPath);
    }
  }
}
