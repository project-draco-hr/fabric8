{
  try {
    Configuration[] configurations=configurationAdmin.listConfigurations(filter);
    if (configurations != null) {
      for (      Configuration configuration : configurations) {
        Dictionary properties=configuration.getProperties();
        if (properties != null) {
          String name=String.valueOf(properties.get(Constants.NAME));
          String identity=String.valueOf(properties.get("identity"));
          String credential=String.valueOf(properties.get("credential"));
          if (name != null && identity != null && credential != null && getZooKeeper().isConnected()) {
            if (getZooKeeper().exists(ZkPath.CLOUD_SERVICE.getPath(name)) == null) {
              ZooKeeperUtils.create(getZooKeeper(),ZkPath.CLOUD_SERVICE.getPath(name));
              Enumeration keys=properties.keys();
              while (keys.hasMoreElements()) {
                String key=String.valueOf(keys.nextElement());
                String value=String.valueOf(properties.get(key));
                ZooKeeperUtils.set(getZooKeeper(),ZkPath.CLOUD_SERVICE_PROPERTY.getPath(name,key),value);
              }
            }
          }
        }
      }
    }
  }
 catch (  Exception e) {
    LOGGER.error("Failed to retrieve compute service information from configuration admin.",e);
  }
}
