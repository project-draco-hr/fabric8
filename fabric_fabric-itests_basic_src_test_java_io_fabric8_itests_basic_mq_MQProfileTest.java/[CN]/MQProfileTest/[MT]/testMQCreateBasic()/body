{
  System.err.println(executeCommand("fabric:create -n"));
  Thread.sleep(10000);
  System.out.println(executeCommand("mq-create --create-container mq --jmx-user admin --jmx-password admin --minimumInstances 1 mq"));
  Thread.sleep(5000);
  installAndCheckFeature("activemq");
  Container container=getFabricService().getContainer("mq1");
  containers.add(container);
  Provision.containersStatus(Arrays.asList(container),"success",PROVISION_TIMEOUT);
  BrokerViewMBean bean=(BrokerViewMBean)getMBean(container,new ObjectName("org.apache.activemq:type=Broker,brokerName=mq"),BrokerViewMBean.class);
  System.out.println(executeCommand("container-list"));
  containers.addAll(ContainerBuilder.create().withName("example").withProfiles("example-mq").assertProvisioningResult().build());
  Thread.sleep(10000);
  installAndCheckFeature("activemq");
  assertEquals("Producer not present",1,bean.getTotalProducerCount());
  assertEquals("Consumer not present",1,bean.getTotalConsumerCount());
}
