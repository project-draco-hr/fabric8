{
  BrokerConfig config=new BrokerConfig();
  config.setBrokerUrl(TEST_LOCAL_BROKER_URL);
  config.setClientId(TEST_CLIENT_ID);
  config.setConnectionFactory(new ActiveMQConnectionFactory(TEST_LOCAL_BROKER_URL));
  config.setMaxConnections(TEST_BATCH_SIZE);
  config.setUserName(TEST_USER_NAME);
  config.setPassword(TEST_PASSWORD);
  JAXBContext context=JAXBContext.newInstance(BrokerConfig.class);
  Marshaller marshaller=context.createMarshaller();
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  marshaller.marshal(config,stream);
  String str=stream.toString("UTF-8");
  LOG.info("Marshaled broker config is " + System.getProperty("line.separator") + str);
  Unmarshaller unmarshaller=context.createUnmarshaller();
  ByteArrayInputStream stream2=new ByteArrayInputStream(str.getBytes());
  BrokerConfig config2=(BrokerConfig)unmarshaller.unmarshal(stream2);
  assertEquals(config,config2);
}
