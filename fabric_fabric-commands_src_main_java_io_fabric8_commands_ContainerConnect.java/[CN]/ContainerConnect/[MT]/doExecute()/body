{
  checkFabricAvailable();
  validateContainersName(container);
  String cmdStr="";
  if (command != null) {
    StringBuilder sb=new StringBuilder();
    for (    String cmd : command) {
      if (sb.length() > 0) {
        sb.append(' ');
      }
      sb.append(cmd);
    }
    sb.append("\n");
    cmdStr=sb.toString();
  }
  Container found=FabricCommand.getContainer(fabricService,container);
  String sshUrl=found.getSshUrl();
  if (sshUrl == null) {
    throw new IllegalArgumentException("Container " + container + " has no SSH URL.");
  }
  String[] ssh=sshUrl.split(":");
  if (ssh.length < 2) {
    throw new IllegalArgumentException("Container " + container + " has an invalid SSH URL '"+ sshUrl+ "'");
  }
  username=username != null && !username.isEmpty() ? username : ShellUtils.retrieveFabricUser(session);
  password=password != null ? password : ShellUtils.retrieveFabricUserPassword(session);
  try {
    executSshCommand(session,username,password,ssh[0],ssh[1],cmdStr);
  }
 catch (  FabricAuthenticationException ex) {
    username=null;
    password=null;
    promptForSshCredentialsIfNeeded();
    executSshCommand(session,username,password,ssh[0],ssh[1],cmdStr);
  }
  return null;
}
