{
  assertValid();
  String ip=container.getIp();
  Set<Integer> ports=new HashSet<Integer>();
  String path=ZkPath.PORTS_IP.getPath(ip);
  try {
    if (interProcessLock.acquire(60,TimeUnit.SECONDS)) {
      createDefault(curator.get(),path,"");
      String boundPorts=getStringData(curator.get(),path);
      if (boundPorts != null && !boundPorts.isEmpty()) {
        for (        String port : boundPorts.split(" ")) {
          try {
            ports.add(Integer.parseInt(port.trim()));
          }
 catch (          NumberFormatException ex) {
          }
        }
      }
    }
 else {
      throw new FabricException("Could not acquire port lock");
    }
  }
 catch (  Exception ex) {
    throw FabricException.launderThrowable(ex);
  }
 finally {
    releaseLock();
  }
  return ports;
}
