{
  this.bundleContext=bundleContext;
  this.httpServiceTracker=new ServiceTracker<HttpService,HttpService>(bundleContext,HttpService.class,new ServiceTrackerCustomizer<HttpService,HttpService>(){
    @Override public HttpService addingService(    ServiceReference<HttpService> reference){
      HttpService service=ExtendedInternalNode.this.bundleContext.getService(reference);
      try {
        service.registerServlet("/elasticsearch",ExtendedInternalNode.this.servlet,null,null);
      }
 catch (      ServletException e) {
        e.printStackTrace();
      }
catch (      NamespaceException e) {
        e.printStackTrace();
      }
      return service;
    }
    @Override public void modifiedService(    ServiceReference<HttpService> reference,    HttpService service){
    }
    @Override public void removedService(    ServiceReference<HttpService> reference,    HttpService service){
      service.unregister("/elasticsearch");
    }
  }
);
  this.mbeanServerTracker=new ServiceTracker<MBeanServer,MBeanServer>(bundleContext,MBeanServer.class,new ServiceTrackerCustomizer<MBeanServer,MBeanServer>(){
    @Override public MBeanServer addingService(    ServiceReference<MBeanServer> reference){
      MBeanServer mBeanServer=bundleContext.getService(reference);
      try {
        JMXUtils.registerMBean(rest,mBeanServer,OBJECT_NAME);
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      return mBeanServer;
    }
    @Override public void modifiedService(    ServiceReference<MBeanServer> reference,    MBeanServer service){
    }
    @Override public void removedService(    ServiceReference<MBeanServer> reference,    MBeanServer service){
      try {
        JMXUtils.unregisterMBean(service,OBJECT_NAME);
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
);
  this.node=node;
  this.rest=new ElasticRest(node);
  this.storage=new ElasticStorageImpl(node);
  this.servlet=new ElasticSearchServlet(this);
}
