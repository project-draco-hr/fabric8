{
  DBObject filter=new BasicDBObject("_id",ev.breadCrumbId);
  filter.put("redeliveries.endpointUri",ev.endpointURI);
  DBCollection collection=db.getCollection(ev.sourceContextId + "." + ev.sourceRouteId);
  DBObject updateObj=new BasicDBObject();
  if (collection.count(filter) > 0) {
    updateObj.put("$inc",new BasicDBObject("redeliveries.$.attempts",1));
  }
 else {
    filter.removeField("redeliveries.endpointUri");
    DBObject content=new BasicDBObject("endpointUri",ev.endpointURI);
    content.put("attempts",1);
    updateObj.put("$push",new BasicDBObject("redeliveries",content));
  }
  updateDatabase(ev,filter,updateObj);
}
