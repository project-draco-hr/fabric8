{
  Pattern pattern=Pattern.compile(filename);
  Map<String,Object> answer=new HashMap<String,Object>();
  Version version=profileService.getVersion(versionId);
  for (  String profileId : profileIds) {
    Profile profile=version.getRequiredProfile(profileId);
    if (profile != null) {
      Map<String,String> files=new HashMap<String,String>();
      Map<String,byte[]> configs=profile.getFileConfigurations();
      for (      Map.Entry<String,byte[]> configEntry : configs.entrySet()) {
        if (pattern.matcher(configEntry.getKey()).matches()) {
          files.put(configEntry.getKey(),Base64.encodeBase64String(configEntry.getValue()));
        }
      }
      answer.put(profileId,files);
    }
  }
  return answer;
}
