{
  Properties userProps=new Properties(new File(System.getProperty("karaf.home") + "/etc/users.properties"));
  if (userProps.isEmpty()) {
    if (newUser == null || newUserPassword == null) {
      String[] credentials=promptForNewUser(newUser,newUserPassword);
      newUser=credentials[0];
      newUserPassword=credentials[1];
    }
  }
  if (newUser == null) {
    System.out.println("No user specified. Some features may not be accessible.");
    return null;
  }
 else {
    if (session != null) {
      StringBuilder sb=new StringBuilder();
      sb.append("jaas:manage --realm karaf --index 1;").append("jaas:useradd ").append(newUser).append(" ").append(newUserPassword).append(";").append("jaas:roleadd ").append(newUser).append(" ").append(newUserRole).append(";").append("jaas:update");
      session.execute(sb.toString());
    }
  }
  return null;
}
