{
  Version defaultVersion=profileRegistry.getRequiredVersion("1.0");
  Assert.assertNotNull(defaultVersion);
  Assert.assertFalse(profileRegistry.hasVersion("1.1"));
  Assert.assertNull(profileRegistry.getVersion("1.1"));
  String versionId=profileRegistry.createVersion("1.0","1.1",Collections.singletonMap("foo","bar"));
  Assert.assertTrue(profileRegistry.hasVersion(versionId));
  Assert.assertEquals("1.1",versionId);
  try {
    profileRegistry.createVersion("1.0","1.1",null);
    Assert.fail("IllegalStateException expected");
  }
 catch (  IllegalStateException ex) {
    Assert.assertTrue(ex.getMessage().contains("Version already exists: 1.1"));
  }
  Version version=profileRegistry.getRequiredVersion(versionId);
  Assert.assertEquals("bar",version.getAttributes().get("foo"));
  Assert.assertEquals(defaultVersion.getProfileIds(),version.getProfileIds());
  profileRegistry.deleteVersion(versionId);
  Assert.assertFalse(profileRegistry.hasVersion("1.1"));
  Assert.assertNull(profileRegistry.getVersion("1.1"));
}
