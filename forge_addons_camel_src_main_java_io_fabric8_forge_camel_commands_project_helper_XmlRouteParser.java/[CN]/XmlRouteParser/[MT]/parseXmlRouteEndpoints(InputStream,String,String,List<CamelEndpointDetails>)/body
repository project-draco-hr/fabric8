{
  Document dom=XmlLineNumberParser.parseXml(xml);
  if (dom != null) {
    List<Node> nodes=CamelXmlHelper.findAllEndpoints(dom);
    for (    Node node : nodes) {
      String uri=getSafeAttribute(node,"uri");
      String id=getSafeAttribute(node,"id");
      String lineNumber=(String)node.getUserData(XmlLineNumberParser.LINE_NUMBER);
      String fileName=fullyQualifiedFileName;
      if (fileName.startsWith(baseDir)) {
        fileName=fileName.substring(baseDir.length() + 1);
      }
      boolean consumerOnly=false;
      boolean producerOnly=false;
      String nodeName=node.getNodeName();
      if ("from".equals(nodeName) || "pollEnrich".equals(nodeName)) {
        consumerOnly=true;
      }
 else       if ("to".equals(nodeName) || "enrich".equals(nodeName) || "wireTap".equals(nodeName)) {
        producerOnly=true;
      }
      CamelEndpointDetails detail=new CamelEndpointDetails();
      detail.setFileName(fileName);
      detail.setLineNumber(lineNumber);
      detail.setEndpointInstance(id);
      detail.setEndpointUri(uri);
      detail.setEndpointComponentName(endpointComponentName(uri));
      detail.setConsumerOnly(consumerOnly);
      detail.setProducerOnly(producerOnly);
      endpoints.add(detail);
    }
  }
}
