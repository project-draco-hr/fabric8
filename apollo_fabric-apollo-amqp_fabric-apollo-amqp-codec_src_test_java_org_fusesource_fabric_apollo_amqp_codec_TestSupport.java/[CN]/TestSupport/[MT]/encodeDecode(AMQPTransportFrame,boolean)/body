{
  long size=in.getSize();
  if (size < MAX_SIZE && display) {
    System.out.printf("\n%s",in);
  }
  DataByteArrayOutputStream out=new DataByteArrayOutputStream((int)in.getSize());
  in.write(out);
  Buffer encoded=out.toBuffer();
  if (size < MAX_SIZE && display) {
    System.out.printf("\n%s",string(encoded.getData()));
  }
  AMQPTransportFrame rc=new AMQPTransportFrame(new DataByteArrayInputStream(encoded));
  if (size < MAX_SIZE && display) {
    System.out.printf("\n%s\n",rc);
  }
  return rc;
}
