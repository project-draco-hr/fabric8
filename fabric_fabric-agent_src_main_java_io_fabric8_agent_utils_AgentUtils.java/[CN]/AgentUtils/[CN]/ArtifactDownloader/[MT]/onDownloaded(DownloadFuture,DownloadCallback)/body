{
synchronized (lock) {
    try {
      String url=future.getUrl();
      File file=future.getFile();
      if (file != null) {
        T t=getArtifact(url,file);
        artifacts.put(url,t);
        if (callback != null) {
          callback.downloaded(file,pendings.get());
        }
      }
    }
 catch (    Throwable t) {
      errors.add(t);
    }
 finally {
      pendings.decrementAndGet();
      lock.notifyAll();
    }
  }
}
