{
  KubernetesProperties kubernetesProperties=new KubernetesProperties();
  KubernetesFactory kubernetesFactory=new KubernetesFactory(kubernetesProperties.getKubernetesMasterUrl());
  Kubernetes kubernetes=kubernetesFactory.createKubernetes();
  for (  final Service service : kubernetes.getServices("default").getItems()) {
    RootBeanDefinition beanDefinition=new RootBeanDefinition(Service.class);
    beanDefinition.addQualifier(new AutowireCandidateQualifier(ServiceName.class,service.getMetadata().getName()));
    beanDefinition.getPropertyValues().addPropertyValue("id",service.getMetadata().getName());
    beanDefinition.getPropertyValues().addPropertyValue("port",service.getSpec().getPorts().iterator().next().getPort());
    beanDefinition.getPropertyValues().addPropertyValue("portalIP",service.getSpec().getPortalIP());
    beanDefinition.getPropertyValues().addPropertyValue("protocol",service.getSpec().getPorts().iterator().next().getProtocol());
    beanDefinition.getPropertyValues().addPropertyValue("containerPort",service.getSpec().getPorts().iterator().next().getTargetPort());
    beanDefinition.getPropertyValues().addPropertyValue("kind",service.getKind());
    registry.registerBeanDefinition(service.getMetadata().getName() + "-service-bean",beanDefinition);
  }
}
