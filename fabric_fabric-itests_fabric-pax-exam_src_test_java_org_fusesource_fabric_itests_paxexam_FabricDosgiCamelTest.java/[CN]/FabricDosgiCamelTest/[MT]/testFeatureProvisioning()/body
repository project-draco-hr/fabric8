{
  FabricService fabricService=getOsgiService(FabricService.class);
  assertNotNull(fabricService);
  System.err.println(executeCommand("echo $APPLICATION"));
  System.err.println(executeCommand("fabric:ensemble-create root"));
  Thread.sleep(DEFAULT_WAIT);
  IZKClient zooKeeper=getOsgiService(IZKClient.class);
  System.err.println(executeCommand("shell:source mvn:org.fusesource.fabric/fuse-fabric/" + System.getProperty("fabric.version") + "/karaf/dosgi"));
  waitForProvisionSuccess(fabricService.getContainer("dosgi-camel"),PROVISION_TIMEOUT);
  waitForProvisionSuccess(fabricService.getContainer("dosgi-provider"),PROVISION_TIMEOUT);
  String response=executeCommand("fabric:container-connect dosgi-camel log:display | grep \"Message from distributed service to\"");
  System.err.println(executeCommand("fabric:container-connect dosgi-camel camel:route-info fabric-client"));
  assertNotNull(response);
  System.err.println(response);
  String[] lines=response.split("\n");
  assertTrue("At least one message is expected",lines.length >= 1);
}
