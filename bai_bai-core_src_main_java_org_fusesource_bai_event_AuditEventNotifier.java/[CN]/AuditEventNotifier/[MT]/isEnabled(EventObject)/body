{
  EventObject coreEvent=event;
  if (event instanceof AuditEvent) {
    AuditEvent auditEvent=(AuditEvent)event;
    coreEvent=auditEvent.event;
  }
  List<String> compareWith=null;
  if (coreEvent instanceof ExchangeSendingEvent || coreEvent instanceof ExchangeCreatedEvent) {
    compareWith=inRegex;
  }
 else   if (coreEvent instanceof ExchangeSentEvent || coreEvent instanceof ExchangeCompletedEvent) {
    compareWith=outRegex;
  }
 else   if (coreEvent instanceof ExchangeRedeliveryEvent) {
    compareWith=redeliveryRegex;
  }
 else   if (coreEvent instanceof ExchangeFailedEvent) {
    ExchangeFailedEvent failedEvent=(ExchangeFailedEvent)coreEvent;
    String exceptionClassName=failedEvent.getExchange().getException().getClass().getCanonicalName();
    return testRegexps(exceptionClassName,failureRegex);
  }
  String uri=endpointUri(event);
  return uri == null || compareWith == null ? false : testRegexps(uri,compareWith);
}
