{
  Daemon d=new Daemon(threadGroup,new Runnable(){
    /** 
 * Recover a list of blocks. It is run by the primary datanode. 
 */
    public void run(){
      for (int i=0; i < blocks.length; i++) {
        try {
          logRecoverBlock("NameNode",blocks[i],targets[i]);
          recoverBlock(blocks[i],false,targets[i],true);
        }
 catch (        IOException e) {
          LOG.warn("recoverBlocks FAILED, blocks[" + i + "]="+ blocks[i],e);
        }
      }
    }
  }
);
  d.start();
  return d;
}
