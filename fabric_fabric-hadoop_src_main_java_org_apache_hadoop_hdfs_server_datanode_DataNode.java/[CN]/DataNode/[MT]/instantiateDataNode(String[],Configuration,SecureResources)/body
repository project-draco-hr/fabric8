{
  if (conf == null)   conf=new Configuration();
  if (!parseArguments(args,conf)) {
    printUsage();
    return null;
  }
  if (conf.get("dfs.network.script") != null) {
    LOG.error("This configuration for rack identification is not supported" + " anymore. RackID resolution is handled by the NameNode.");
    System.exit(-1);
  }
  String[] dataDirs=conf.getStrings(DATA_DIR_KEY);
  dnThreadName="DataNode: [" + StringUtils.arrayToString(dataDirs) + "]";
  DefaultMetricsSystem.initialize("DataNode");
  return makeInstance(dataDirs,conf,resources);
}
