{
  UserGroupInformation.setConfiguration(conf);
  LocalFileSystem localFS=FileSystem.getLocal(conf);
  ArrayList<File> dirs=new ArrayList<File>();
  FsPermission dataDirPermission=new FsPermission(conf.get(DATA_DIR_PERMISSION_KEY,DEFAULT_DATA_DIR_PERMISSION));
  for (  String dir : dataDirs) {
    try {
      DiskChecker.checkDir(localFS,new Path(dir),dataDirPermission);
      dirs.add(new File(dir));
    }
 catch (    IOException e) {
      LOG.warn("Invalid directory in " + DATA_DIR_KEY + ": "+ e.getMessage());
    }
  }
  if (dirs.size() > 0)   return new DataNode(conf,dirs,resources);
  LOG.error("All directories in " + DATA_DIR_KEY + " are invalid.");
  return null;
}
