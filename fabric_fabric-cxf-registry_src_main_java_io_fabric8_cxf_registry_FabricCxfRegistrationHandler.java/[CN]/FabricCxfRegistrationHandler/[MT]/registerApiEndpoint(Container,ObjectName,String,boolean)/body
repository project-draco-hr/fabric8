{
  String actualEndpointUrl=null;
  try {
    String url;
    String id=container.getId();
    if (isFullAddress(address)) {
      url=toPublicAddress(id,address);
    }
 else {
      String cxfBus=getCxfServletPath(oName);
      url="${zk:" + id + "/http}"+ cxfBus+ address;
    }
    actualEndpointUrl=ZooKeeperUtils.getSubstitutedData(curator.get(),url);
    String apiDocPath="/api-docs";
    String wsdlPath="?wsdl";
    String wadlPath="?_wadl";
    Version version=container.getVersion();
    String versionId=version != null ? version.getId() : null;
    String json="{\"id\":" + JsonHelper.jsonEncodeString(id) + ", \"container\":"+ JsonHelper.jsonEncodeString(id)+ ", \"version\":"+ JsonHelper.jsonEncodeString(versionId)+ ", \"services\":["+ JsonHelper.jsonEncodeString(url)+ "]"+ ", \"objectName\":"+ JsonHelper.jsonEncodeString(oName.toString())+ "";
    boolean rest=false;
    if (booleanAttribute(oName,"isWADL")) {
      rest=true;
      json+=", \"wadl\":" + JsonHelper.jsonEncodeString(wadlPath);
    }
    if (booleanAttribute(oName,"isSwagger")) {
      rest=true;
      json+=", \"apidocs\":" + JsonHelper.jsonEncodeString(apiDocPath);
    }
    if (booleanAttribute(oName,"isWSDL")) {
      json+=", \"wsdl\":" + JsonHelper.jsonEncodeString(wsdlPath);
    }
    json+="}";
    String path=getPath(container,oName,address,rest);
    LOGGER.info("Registered CXF API at " + path + " JSON: "+ json);
    if (!started && !rest) {
      LOGGER.warn("Since the CXF service isn't started, this could really be a REST endpoint rather than WSDL at " + path);
    }
    registeredZkPaths.add(path);
    ZooKeeperUtils.setData(curator.get(),path,json,CreateMode.EPHEMERAL);
  }
 catch (  Exception e) {
    LOGGER.error("Failed to register API endpoint for {}.",actualEndpointUrl,e);
  }
}
