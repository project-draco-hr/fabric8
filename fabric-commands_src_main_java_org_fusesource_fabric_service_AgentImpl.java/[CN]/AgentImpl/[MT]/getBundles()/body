{
  try {
    return new JmxTemplate().execute(this,new BundleStateCallback<BundleInfo[]>(){
      public BundleInfo[] doWithBundleState(      BundleStateMBean bundleState) throws Exception {
        TabularData bundles=bundleState.listBundles();
        BundleInfo[] info=new BundleInfo[bundles.size()];
        int i=0;
        for (        Object data : bundles.values().toArray()) {
          info[i++]=new JmxBundleInfo((CompositeData)data);
        }
        Arrays.sort(info,new BundleInfoComparator());
        return info;
      }
    }
);
  }
 catch (  Exception e) {
    logger.error("Error while retrieving bundles",e);
    return new BundleInfo[0];
  }
}
