{
  try {
    List<ArchetypeInfo> archetypes=findArchetypes();
    for (    ArchetypeInfo archetype : archetypes) {
      archetypeIdToArchetypeInfoMap.put(archetype.artifactId,archetype);
    }
    Set<String> artifactIds=archetypeIdToArchetypeInfoMap.keySet();
    Set<String> answer=new TreeSet<>();
    String testArtifactId=System.getProperty(ARTIFACTID_SYSTEM_PROPERTY);
    if (Strings.isNotBlank(testArtifactId)) {
      if (artifactIds.contains(testArtifactId)) {
        answer.add(testArtifactId);
      }
 else {
        fail("System property " + ARTIFACTID_SYSTEM_PROPERTY + " value of '"+ testArtifactId+ "' is not a valid artifact id for the fabric8 archetypes");
      }
    }
 else {
      for (      String artifactId : artifactIds) {
        if (artifactId.contains("cdi") || artifactId.contains("drools") || artifactId.contains("camel-errorhandler")|| artifactId.contains("cxf-code-first")|| artifactId.contains("karaf-cxf-secure")) {
          continue;
        }
        answer.add(artifactId);
      }
    }
    return answer;
  }
 catch (  Exception e) {
    LOG.error("Failed to find archetype IDs: " + e,e);
    e.printStackTrace();
    fail("Failed to find archetype ids: " + e);
    return Collections.EMPTY_SET;
  }
}
