{
  try {
    List<ArchetypeInfo> archetypes=findArchetypes();
    for (    ArchetypeInfo archetype : archetypes) {
      archetypeIdToArchetypeInfoMap.put(archetype.artifactId,archetype);
    }
    Set<String> artifactIds=archetypeIdToArchetypeInfoMap.keySet();
    Set<String> answer=new TreeSet<>();
    String testArtifactId=System.getProperty(ARTIFACTID_SYSTEM_PROPERTY);
    for (    String artifactId : artifactIds) {
      boolean ignore=false;
      if (Strings.isNotBlank(testArtifactId)) {
        if (!artifactId.contains(testArtifactId)) {
          ignore=true;
        }
      }
 else {
        if (artifactId.contains("cdi") || artifactId.contains("drools")) {
          ignore=true;
        }
      }
      if (ignore) {
        ParameterRule.addIgnoredTest("ArchetypeTest(" + artifactId + ")");
      }
 else {
        answer.add(artifactId);
      }
    }
    if (Strings.isNotBlank(testArtifactId) && answer.isEmpty()) {
      fail("System property " + ARTIFACTID_SYSTEM_PROPERTY + " value of '"+ testArtifactId+ "' is not a valid artifact id for the fabric8 archetypes");
    }
    return answer;
  }
 catch (  Exception e) {
    LOG.error("Failed to find archetype IDs: " + e,e);
    e.printStackTrace();
    fail("Failed to find archetype ids: " + e);
    return Collections.EMPTY_SET;
  }
}
