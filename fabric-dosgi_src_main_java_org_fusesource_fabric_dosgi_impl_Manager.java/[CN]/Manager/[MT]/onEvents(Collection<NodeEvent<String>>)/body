{
  executor.execute(new Runnable(){
    public void run(){
      try {
        for (        NodeEvent<String> event : nodeEvents) {
          if (event.getDepth() == 0) {
            continue;
          }
switch (event.getEventType()) {
case ADDED:
{
              EndpointDescription endpoint=Utils.getEndpointDescription(event.getData());
              remoteEndpoints.addCapability(endpoint);
              for (              Map.Entry<ListenerInfo,SimpleFilter> entry : listeners.entrySet()) {
                if (CapabilitySet.matches(endpoint,entry.getValue())) {
                  doImportService(endpoint,entry.getKey());
                }
              }
            }
          break;
case UPDATED:
        break;
case DELETED:
{
        EndpointDescription endpoint=Utils.getEndpointDescription(event.getData());
        Map<Long,ImportRegistration> registrations=importedServices.remove(endpoint);
        for (        ImportRegistration reg : registrations.values()) {
          reg.getImportedService().unregister();
        }
      }
    break;
}
}
}
 catch (Exception e) {
LOGGER.info("Error when handling zookeeper events",e);
}
}
}
);
}
