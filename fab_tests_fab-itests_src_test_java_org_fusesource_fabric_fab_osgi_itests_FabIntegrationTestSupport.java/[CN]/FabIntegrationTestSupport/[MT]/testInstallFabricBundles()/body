{
  Thread.sleep(10000);
  assertNotNull(getOsgiService(BlueprintContainer.class,"osgi.blueprint.container.symbolicname=org.apache.karaf.shell.obr",20000));
  assertNotNull(getOsgiService(BlueprintContainer.class,"osgi.blueprint.container.symbolicname=org.apache.karaf.shell.wrapper",20000));
  commandProcessor=getOsgiService(CommandProcessor.class);
  commandSession=commandProcessor.createSession(System.in,System.out,System.err);
  commandSession.execute("osgi:list");
  assertStartBundle("org.apache.karaf.shell.log");
  assertStartBundle("org.fusesource.fabric.fab.fab-osgi");
  Thread.sleep(1000);
  doInstallFabricBundles();
  Thread.sleep(1000);
  commandSession.execute("osgi:list");
  Thread.sleep(2000);
  stopBundles();
  commandSession.close();
}
