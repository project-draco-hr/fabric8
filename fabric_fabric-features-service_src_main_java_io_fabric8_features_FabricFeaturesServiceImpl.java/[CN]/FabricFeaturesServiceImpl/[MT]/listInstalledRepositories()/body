{
  Set<String> repositoryUris=new LinkedHashSet<String>();
  Set<Repository> repos=new LinkedHashSet<Repository>();
  Profile overlayProfile=fabricService.get().getCurrentContainer().getOverlayProfile();
  Profile effectiveProfile=Profiles.getEffectiveProfile(fabricService.get(),overlayProfile);
  if (effectiveProfile.getRepositories() != null) {
    for (    String uri : effectiveProfile.getRepositories()) {
      repositoryUris.add(uri);
    }
  }
  for (  String uri : repositoryUris) {
    try {
      populateRepositories(uri,repos);
    }
 catch (    Exception ex) {
      LOGGER.warn("Error while populating repositories from uri.",ex);
    }
  }
  return repos.toArray(new Repository[repos.size()]);
}
