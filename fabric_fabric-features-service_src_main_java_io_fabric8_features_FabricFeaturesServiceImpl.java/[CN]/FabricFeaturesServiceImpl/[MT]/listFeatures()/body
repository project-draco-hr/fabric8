{
  assertValid();
  if (allfeatures.isEmpty()) {
    Repository[] repositories=listRepositories();
    for (    Repository repository : repositories) {
      try {
        for (        Feature feature : repository.getFeatures()) {
          if (!allfeatures.contains(feature)) {
            allfeatures.add(feature);
          }
        }
      }
 catch (      Exception ex) {
        LOGGER.debug("Could not load features from %s.",repository.getURI());
      }
    }
  }
  return allfeatures.toArray(new Feature[allfeatures.size()]);
}
