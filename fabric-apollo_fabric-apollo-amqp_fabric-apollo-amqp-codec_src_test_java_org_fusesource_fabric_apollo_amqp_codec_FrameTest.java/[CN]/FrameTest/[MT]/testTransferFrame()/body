{
  ValueMessage message=MessageFactory.createValueMessage(new AMQPString("HelloWorld!"));
  Transfer transfer=new Transfer(0L,0L,Buffer.ascii("0").buffer());
  AnnotatedMessage annotatedMessage=MessageFactory.createAnnotatedMessage(message);
  AMQPTransportFrame frame=new AMQPTransportFrame(0,transfer,MessageSupport.toBuffer(annotatedMessage));
  AMQPTransportFrame outFrame=TestSupport.encodeDecode(frame);
  Transfer outTransfer=(Transfer)outFrame.getPerformative();
  System.out.printf("Transfer : %s\n",outTransfer);
  AnnotatedMessage msg=MessageSupport.decodeAnnotatedMessage(outFrame.getPayload());
  System.out.printf("Msg : %s\n",msg);
  assertEquals(transfer.toString(),outTransfer.toString());
  assertEquals(annotatedMessage.toString(),msg.toString());
}
