{
  Properties versionProps=loadProps(git,METADATA);
  setData(zookeeper,zkNode,toString(versionProps));
  List<String> gitProfiles=list(git.getRepository().getWorkTree());
  gitProfiles.remove(".git");
  gitProfiles.remove(METADATA);
  gitProfiles.remove(CONTAINERS_PROPERTIES);
  List<String> zkProfiles=getChildren(zookeeper,zkNode + "/profiles");
  for (  String profile : gitProfiles) {
    Properties profileProps=loadProps(git,profile + "/" + METADATA);
    setData(zookeeper,zkNode + "/profiles/" + profile,toString(profileProps));
    List<String> zkConfigs=getChildren(zookeeper,zkNode + "/profiles/" + profile);
    List<String> gitConfigs=list(new File(git.getRepository().getWorkTree(),profile));
    gitConfigs.remove(METADATA);
    for (    String file : gitConfigs) {
      byte[] data=read(new File(git.getRepository().getWorkTree(),profile + "/" + file));
      setData(zookeeper,zkNode + "/profiles/" + profile+ "/"+ file,data);
      zkConfigs.remove(file);
    }
    for (    String config : zkConfigs) {
      deleteSafe(zookeeper,zkNode + "/profiles/" + profile+ "/"+ config);
    }
    zkProfiles.remove(profile);
  }
  for (  String profile : zkProfiles) {
    deleteSafe(zookeeper,zkNode + "/profiles/" + profile);
  }
  Properties containerProps=loadProps(git,CONTAINERS_PROPERTIES);
  for (  String container : containerProps.keySet()) {
    setData(zookeeper,zkNode + "/containers/" + container,containerProps.getProperty(container));
  }
  for (  String container : getChildren(zookeeper,zkNode + "/containers")) {
    if (!containerProps.containsKey(container)) {
      deleteSafe(zookeeper,zkNode + "/containers/" + container);
    }
  }
}
