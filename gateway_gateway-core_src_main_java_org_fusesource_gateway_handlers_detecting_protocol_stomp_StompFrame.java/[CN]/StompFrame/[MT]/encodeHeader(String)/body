{
  if (value == null)   return null;
  try {
    byte[] data=value.getBytes("UTF-8");
    Buffer rc=new Buffer(data.length);
    for (    byte d : data) {
switch (d) {
case ESCAPE_BYTE:
        rc.appendBuffer(ESCAPE_ESCAPE_SEQ.toBuffer());
      break;
case COLON_BYTE:
    rc.appendBuffer(COLON_ESCAPE_SEQ.toBuffer());
  break;
case NEWLINE_BYTE:
rc.appendBuffer(COLON_ESCAPE_SEQ.toBuffer());
break;
default :
rc.appendByte(d);
}
}
return ascii(rc);
}
 catch (UnsupportedEncodingException e) {
throw new RuntimeException(e);
}
}
