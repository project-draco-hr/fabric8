{
  if (saslClient == null) {
    saslState=SaslState.FAILED;
    throw new SaslException("saslClient failed to initialize properly: it's null.");
  }
  if (saslState == SaslState.INITIAL) {
    if (saslClient.hasInitialResponse()) {
      sendSaslPacket(cnxn);
    }
 else {
      byte[] emptyToken=new byte[0];
      sendSaslPacket(emptyToken,cnxn);
    }
    saslState=SaslState.INTERMEDIATE;
  }
}
