{
  assertValid();
  try {
    Bundle bundleFabricZooKeeper=bundleUtils.findAndStopBundle("org.fusesource.fabric.fabric-zookeeper");
    Bundle bundleFabricGit=bundleUtils.findAndStopBundle("org.fusesource.fabric.fabric-git");
    for (; ; ) {
      Configuration[] configs=configAdmin.get().listConfigurations("(|(service.factoryPid=org.fusesource.fabric.zookeeper.server)(service.pid=org.fusesource.fabric.zookeeper))");
      if (configs != null && configs.length > 0) {
        for (        Configuration config : configs) {
          config.delete();
        }
        Thread.sleep(100);
      }
 else {
        break;
      }
    }
    File zkDir=new File("data/zookeeper");
    if (zkDir.isDirectory()) {
      File newZkDir=new File("data/zookeeper." + System.currentTimeMillis());
      if (!zkDir.renameTo(newZkDir)) {
        newZkDir=zkDir;
      }
      delete(newZkDir);
    }
    File gitDir=new File("data/git");
    if (gitDir.isDirectory()) {
      delete(gitDir);
    }
    bundleFabricZooKeeper.start();
    bundleFabricGit.start();
  }
 catch (  Exception e) {
    throw new FabricException("Unable to delete zookeeper configuration",e);
  }
}
