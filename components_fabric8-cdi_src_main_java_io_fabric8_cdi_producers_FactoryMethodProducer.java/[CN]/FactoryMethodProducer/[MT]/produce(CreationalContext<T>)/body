{
  List<Object> arguments=new ArrayList<>();
  for (  AnnotatedParameter<X> parameter : factoryMethod.getParameters()) {
    Type type=parameter.getBaseType();
    ServiceName parameterServiceName=parameter.getAnnotation(ServiceName.class);
    Protocol paramterProtocol=parameter.getAnnotation(Protocol.class);
    PortName parameterPortName=parameter.getAnnotation(PortName.class);
    Endpoint paramEndpoint=parameter.getAnnotation(Endpoint.class);
    External paramExternal=parameter.getAnnotation(External.class);
    Configuration configuration=parameter.getAnnotation(Configuration.class);
    String serviceProtocol=(paramterProtocol != null && Strings.isNotBlank(paramterProtocol.value())) ? paramterProtocol.value() : "tcp";
    String servicePort=(parameterPortName != null && Strings.isNotBlank(parameterPortName.value())) ? parameterPortName.value() : "";
    Boolean serviceEndpoint=paramEndpoint != null ? true : false;
    Boolean serviceExternal=paramExternal != null ? true : false;
    if (parameterServiceName != null && String.class.equals(type)) {
      try {
        String serviceUrl=getServiceUrl(serviceId,serviceProtocol,servicePort,serviceEndpoint,serviceExternal,ctx);
        arguments.add(serviceUrl);
      }
 catch (      Throwable t) {
        throw new RuntimeException(String.format(SERVICE_LOOKUP_ERROR_FORMAT,factoryMethod.getJavaMember().getName(),factoryMethod.getJavaMember().getDeclaringClass().getName(),serviceId),t);
      }
    }
 else     if (parameterServiceName != null && !String.class.equals(type)) {
      try {
        Object serviceBean=getServiceBean(serviceId,serviceProtocol,servicePort,serviceEndpoint,serviceExternal,(Class<Object>)type,ctx);
        arguments.add(serviceBean);
      }
 catch (      Throwable t) {
        throw new RuntimeException(String.format(BEAN_LOOKUP_ERROR_FORMAT,factoryMethod.getJavaMember().getName(),factoryMethod.getJavaMember().getDeclaringClass().getName(),type,serviceId),t);
      }
    }
 else     if (configuration != null) {
      try {
        Object config=getConfiguration(serviceId,(Class<Object>)type,ctx);
        arguments.add(config);
      }
 catch (      Throwable t) {
        throw new RuntimeException(String.format(CONF_LOOKUP_ERROR_FORMAT,factoryMethod.getJavaMember().getName(),factoryMethod.getJavaMember().getDeclaringClass().getName(),serviceId),t);
      }
    }
 else {
      try {
        Object other=BeanProvider.getContextualReferences((Class)type,true);
        arguments.add(other);
      }
 catch (      Throwable t) {
        throw new RuntimeException(String.format(PARAMETER_ERROR_FORMAT,factoryMethod.getJavaMember().getName(),factoryMethod.getJavaMember().getDeclaringClass().getName(),parameter.getPosition()),t);
      }
    }
  }
  try {
    return (T)factoryMethod.getJavaMember().invoke(bean.create(ctx),arguments.toArray());
  }
 catch (  Throwable t) {
    throw new RuntimeException(String.format(INVOCATION_ERROR_FORMAT,factoryMethod.getJavaMember().getName(),factoryMethod.getJavaMember().getDeclaringClass().getName(),arguments));
  }
}
