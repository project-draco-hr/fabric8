{
  try {
    return BeanProvider.getContextualReference(serviceType,Qualifiers.create(serviceId,serviceProtocol,false));
  }
 catch (  IllegalStateException e) {
    Producer<S> producer=ServiceBean.anyBean(serviceId,serviceProtocol,serviceType).getProducer();
    if (producer != null) {
      return (S)producer.produce(context);
    }
 else {
      throw new IllegalStateException("Could not find producer for service:" + serviceId + " type:"+ serviceType+ " protocol:"+ serviceProtocol);
    }
  }
}
