{
  Multimap<String,String> distribution=LinkedHashMultimap.create();
  int index=0;
  for (  String item : items) {
    String path=members[index];
    distribution.put(path,item);
    index=(index + 1) % members.length;
  }
  for (  String member : members) {
    try {
      WorkerNode node=mapper.readValue(curator.getData().forPath(member),WorkerNode.class);
      Collection<String> assignedItems=distribution.get(member);
      if (assignedItems != null) {
        node.setPartitions(assignedItems.toArray(new String[assignedItems.size()]));
      }
 else {
        node.setPartitions(new String[0]);
      }
      String targetPath=ZkPath.TASK_MEMBER_PARTITIONS.getPath(node.getContainer(),workId);
      curator.setData().forPath(targetPath,mapper.writeValueAsBytes(node));
    }
 catch (    Exception ex) {
      LOGGER.error("Error while assigning work",ex);
    }
  }
}
