{
  assertValid();
  Version version=profileService.get().getRequiredVersion(versionId);
  Profile profile=version.getRequiredProfile(profileId);
  Map<String,byte[]> configs=profile.getFileConfigurations();
  byte[] bytes=configs.get(pid);
  Properties properties;
  try {
    if (bytes != null) {
      properties=DataStoreUtils.toProperties(bytes);
    }
 else {
      properties=new Properties();
    }
    properties.setProperty(key,value);
    bytes=DataStoreUtils.toBytes(properties);
    configs.put(pid,bytes);
  }
 catch (  IOException ex) {
    throw new FabricException(ex);
  }
  ProfileBuilder builder=ProfileBuilder.Factory.createFrom(profile);
  builder.setFileConfigurations(configs);
  profileService.get().updateProfile(builder.getProfile());
}
