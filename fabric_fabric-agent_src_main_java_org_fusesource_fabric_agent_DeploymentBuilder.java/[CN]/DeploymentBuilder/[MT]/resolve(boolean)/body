{
  Bundle systemBundle=FrameworkUtil.getBundle(DeploymentBuilder.class).getBundleContext().getBundle(0);
  resources.put("system-bundle",systemBundle.adapt(BundleRevision.class));
  ResolverImpl resolver=new ResolverImpl(new Slf4jResolverLog(LOGGER));
  ResolveContext context=new ResolveContextImpl(Collections.<Resource>singleton(requirements),Collections.<Resource>emptySet(),resources.values(),resolveOptionalImports);
  Map<Resource,List<Wire>> wiring=resolver.resolve(context);
  Map<String,Resource> deploy=new TreeMap<String,Resource>();
  for (  Resource res : wiring.keySet()) {
    String uri=getUri(res);
    if (uri != null) {
      deploy.put(uri,res);
    }
  }
  return deploy.values();
}
