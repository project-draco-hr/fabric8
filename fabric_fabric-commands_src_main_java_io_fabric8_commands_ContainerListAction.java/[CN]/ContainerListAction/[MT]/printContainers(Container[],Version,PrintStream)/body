{
  Set<String> missingProfiles=findMissingProfiles(containers);
  String header=String.format(FORMAT,(Object[])HEADERS);
  int count=0;
  out.println(String.format(FORMAT,(Object[])HEADERS));
  for (  Container container : containers) {
    count++;
    if (CommandUtils.matchVersion(container,version)) {
      String indent="";
      for (Container c=container; !c.isRoot(); c=c.getParent()) {
        indent+="  ";
      }
      String marker="";
      if (container.getId().equals(fabricService.getCurrentContainer().getId())) {
        marker="*";
      }
      String assignedProfiles=FabricCommand.toString(fabricService.getDataStore().getContainerProfiles(container.getId()));
      String str="";
      for (      String s : assignedProfiles.split(",")) {
        str+=Strings.rpadByMaxSize(" ",s,31) + ",";
      }
      String highlightedProfiles="";
      String secondlinehighlightedProfiles="";
      highlightedProfiles=str.split(",")[0];
      if (str.split(",").length > 1) {
        secondlinehighlightedProfiles=Strings.rpad(" ",System.getProperty("line.separator"),52) + Arrays.join(Strings.rpad(" ",System.getProperty("line.separator"),52),java.util.Arrays.asList(str.split(",")).subList(1,str.split(",").length).toArray());
      }
      if (count != 1) {
        highlightedProfiles=Strings.rpad(" ",highlightedProfiles,16);
      }
      String status=CommandUtils.status(container) + secondlinehighlightedProfiles;
      String line=String.format(FORMAT,indent + container.getId() + marker,container.getVersion().getId(),container.isAlive(),highlightedProfiles,status);
      int pStart=Math.max(header.indexOf(HEADERS[3]),line.indexOf(assignedProfiles));
      int pEnd=pStart + assignedProfiles.length();
      for (      String p : missingProfiles) {
        String highlighted=Ansi.ansi().fg(Ansi.Color.RED).a(p).toString() + Ansi.ansi().reset().toString();
        highlightedProfiles=highlightedProfiles.replaceAll(p,highlighted);
      }
      line=replaceAll(line,pStart,pEnd,assignedProfiles,highlightedProfiles);
      out.println(line);
    }
  }
}
