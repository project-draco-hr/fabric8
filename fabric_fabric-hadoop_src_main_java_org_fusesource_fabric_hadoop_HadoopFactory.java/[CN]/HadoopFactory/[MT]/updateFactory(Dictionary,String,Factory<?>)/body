{
  if (getBool(properties,prop)) {
    try {
      Subject.doAs(null,new PrivilegedExceptionAction<Object>(){
        @Override public Object run() throws Exception {
          ClassLoader oldTccl=Thread.currentThread().getContextClassLoader();
          try {
            Thread.currentThread().setContextClassLoader(getClass().getClassLoader());
            factory.delete();
            factory.create(properties);
          }
  finally {
            Thread.currentThread().setContextClassLoader(oldTccl);
          }
          return null;
        }
      }
);
    }
 catch (    PrivilegedActionException e) {
      if (e.getCause() instanceof ConfigurationException) {
        throw (ConfigurationException)e.getCause();
      }
 else {
        throw new RuntimeException(e.getCause());
      }
    }
  }
 else {
    factory.delete();
  }
}
