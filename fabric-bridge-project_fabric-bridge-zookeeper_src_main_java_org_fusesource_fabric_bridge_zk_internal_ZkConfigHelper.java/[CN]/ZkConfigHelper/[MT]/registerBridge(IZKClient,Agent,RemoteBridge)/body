{
  byte[] data=getZkData(remoteBridge);
  final String bridgeConfigPath=getBridgeConfigPath(agent);
  try {
    Stat stat=client.exists(bridgeConfigPath);
    if (stat == null) {
      client.createBytesNode(bridgeConfigPath,data,ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 else {
      client.setByteData(bridgeConfigPath,data);
    }
  }
 catch (  InterruptedException e) {
    String msg="Error registering bridge config at " + bridgeConfigPath + " : "+ e.getMessage();
    LOG.error(msg,e);
    throw new IllegalArgumentException(msg,e);
  }
catch (  KeeperException e) {
    String msg="Error registering bridge config at " + bridgeConfigPath + " : "+ e.getMessage();
    LOG.error(msg,e);
    throw new IllegalArgumentException(msg,e);
  }
}
