{
  for (  Entry<BridgedDestination,AbstractMessageListenerContainer> entry : listenerMap.entrySet()) {
    final BridgedDestination destination=entry.getKey();
    final AbstractMessageListenerContainer listener=entry.getValue();
    if (listener.isActive()) {
      try {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Destroying listener for " + destination);
        }
        listener.destroy();
        if (LOG.isDebugEnabled()) {
          LOG.debug("Listener destroyed for " + destination);
        }
      }
 catch (      JmsException e) {
        LOG.error("Error destroying listener for destination " + destination.getName() + " : "+ e.getMessage(),e);
      }
    }
  }
  listenerMap.clear();
  if (localBrokerConfig.getConnectionFactory() == null) {
    ((PooledConnectionFactory)localConnectionFactory).stop();
  }
  if (remoteBrokerConfig != null && remoteBrokerConfig.getConnectionFactory() == null) {
    ((PooledConnectionFactory)remoteConnectionFactory).stop();
  }
  LOG.info("Destroyed");
}
