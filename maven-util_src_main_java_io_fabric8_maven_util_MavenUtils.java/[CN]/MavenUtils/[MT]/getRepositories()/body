{
  List<Repository> repositories=new LinkedList<Repository>();
  Settings settings=getSettings();
  Set<String> profileNames=new LinkedHashSet<String>();
  profileNames.addAll(settings.getActiveProfiles());
  for (  Profile p : settings.getProfiles()) {
    if (p.getActivation() != null && p.getActivation().isActiveByDefault()) {
      profileNames.add(p.getId());
    }
  }
  for (  String profileName : profileNames) {
    Object obj=settings.getProfilesAsMap().get(profileName);
    if (Profile.class.isAssignableFrom(obj.getClass())) {
      Profile p=(Profile)obj;
      for (      Repository repository : p.getRepositories()) {
        repositories.add(repository);
      }
    }
  }
  return repositories;
}
