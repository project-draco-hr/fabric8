{
  DefaultProxySelector selector=new DefaultProxySelector();
  Settings settings=getSettings();
  if (protocol != null && !protocol.isEmpty() && host != null && !host.isEmpty() && port > 0) {
    AuthenticationBuilder builder=new AuthenticationBuilder();
    builder.addUsername(username);
    builder.addPassword(password);
    org.eclipse.aether.repository.Proxy p=new Proxy(protocol,host,port,builder.build());
    selector.add(p,nonProxyHosts);
  }
  for (  org.apache.maven.settings.Proxy proxy : settings.getProxies()) {
    AuthenticationBuilder builder=new AuthenticationBuilder();
    builder.addUsername(proxy.getUsername());
    builder.addPassword(proxy.getPassword());
    org.eclipse.aether.repository.Proxy p=new Proxy(proxy.getProtocol(),proxy.getHost(),proxy.getPort(),builder.build());
    selector.add(p,proxy.getNonProxyHosts());
  }
  return selector;
}
