{
  DefaultProxySelector selector=new DefaultProxySelector();
  Settings settings=getSettings();
  if (protocol != null && !protocol.isEmpty() && host != null && !host.isEmpty() && port > 0) {
    Authentication auth=new Authentication(username,password);
    org.sonatype.aether.repository.Proxy p=new Proxy(protocol,host,port,auth);
    selector.add(p,nonProxyHosts);
  }
  for (  org.apache.maven.settings.Proxy proxy : settings.getProxies()) {
    Authentication auth=new Authentication(proxy.getUsername(),proxy.getPassword());
    org.sonatype.aether.repository.Proxy p=new Proxy(proxy.getProtocol(),proxy.getHost(),proxy.getPort(),auth);
    selector.add(p,proxy.getNonProxyHosts());
  }
  return selector;
}
