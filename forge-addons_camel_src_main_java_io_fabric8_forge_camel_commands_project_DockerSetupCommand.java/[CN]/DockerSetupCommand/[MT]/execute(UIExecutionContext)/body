{
  Project project=getSelectedProject(context);
  MavenPluginFacet pluginFacet=project.getFacet(MavenPluginFacet.class);
  MavenPluginBuilder plugin=MavenPluginBuilder.create().setCoordinate(createCoordinate("org.jolokia","docker-maven-plugin",VersionHelper.dockerVersion()));
  if (pluginFacet.hasPlugin(plugin.getCoordinate())) {
    return Results.success("Docker is already setup");
  }
  ConfigurationElement cfgName=ConfigurationElementBuilder.create().setName("name").setText("${docker.image}");
  ConfigurationElement cfgFrom=ConfigurationElementBuilder.create().setName("from").setText("${docker.from}");
  ConfigurationElement cfgDescriptorRef=ConfigurationElementBuilder.create().setName("descriptorRef").setText("${docker.assemblyDescriptorRef}");
  ConfigurationElement cfgAssembly=ConfigurationElementBuilder.create().setName("assembly");
  cfgAssembly.getChildren().add(cfgDescriptorRef);
  ConfigurationElement cfgBuild=ConfigurationElementBuilder.create().setName("build");
  cfgBuild.getChildren().add(cfgFrom);
  cfgBuild.getChildren().add(cfgAssembly);
  ConfigurationElement cfgImage=ConfigurationElementBuilder.create().setName("image");
  cfgImage.getChildren().add(cfgName);
  cfgImage.getChildren().add(cfgBuild);
  ConfigurationElement cfgImages=ConfigurationElementBuilder.create().setName("images");
  cfgImages.getChildren().add(cfgImage);
  String fromImage=from != null ? from.getValue() : "fabric8/java";
  MavenFacet maven=project.getFacet(MavenFacet.class);
  Model pom=maven.getModel();
  Properties properties=pom.getProperties();
  properties.put("docker.registryPrefix","${env.DOCKER_REGISTRY}/");
  properties.put("docker.from",fromImage);
  properties.put("docker.image","${docker.registryPrefix}fabric8/${project.artifactId}:${project.version}");
  properties.put("docker.assemblyDescriptorRef","artifact-with-dependencies");
  properties.put("docker.port.container.jolokia","8778");
  maven.setModel(pom);
  plugin.createConfiguration().addConfigurationElement(cfgImages);
  pluginFacet.addPlugin(plugin);
  return Results.success("Added Docker to the project");
}
