{
  if (initialized.compareAndSet(true,false)) {
    instrumentation.removeTransformer(this);
    Thread t=transformThread;
    transformThread=null;
    if (t != null && !t.isInterrupted()) {
      t.interrupt();
    }
    cleanUp.set(true);
    try {
      instrument(args);
    }
 catch (    Throwable e) {
      LOG.error("Failed to shutdown",e);
    }
  }
}
