{
  FeaturesService service=createNiceMock(FeaturesService.class);
  Feature feature1=FeaturesTest.createMockFeatureWithOptionalBundles("feature-a","mvn:required/bundle1/1.0","mvn:optional/bundle1/1.0");
  Feature feature2=FeaturesTest.createMockFeatureWithOptionalBundles("feature-b","mvn:required/bundle2/1.0","mvn:optional/bundle2/1.0");
  Feature[] features=new Feature[]{feature1,feature2};
  expect(service.listFeatures()).andReturn(features).anyTimes();
  replay(service);
  return service;
}
