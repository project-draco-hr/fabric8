{
  super.doStart();
  if (polling) {
    long scheduleTime=ParsingUtil.getTimeAsMilliseconds(statisticsEndpoint.getBatchUpdateTime());
    LOG.debug("Scheduled StatisticsConsumer to batch every " + statisticsEndpoint.getBatchUpdateTime());
    final Runnable runnable=new Runnable(){
      public void run(){
        Exchange exchange=lastGeneratedExchange;
        if (exchange != null) {
          try {
            StatisticsConsumer.this.doSuperSendToConsumers(exchange);
          }
 catch (          Exception e) {
            LOG.error(statisticsEndpoint.getEndpointUri() + " Failed to send batch statistics ",e);
          }
        }
      }
    }
;
    future=executor.scheduleAtFixedRate(runnable,scheduleTime,scheduleTime,TimeUnit.MILLISECONDS);
  }
}
