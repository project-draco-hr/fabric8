{
  if (subject != null && subject.getPrivateCredentials(String.class) != null && !subject.getPrivateCredentials(String.class).isEmpty() && subject.getPrincipals(UserPrincipal.class) != null && !subject.getPrincipals(UserPrincipal.class).isEmpty()) {
    Set<UserPrincipal> userPrincipals=subject.getPrincipals(UserPrincipal.class);
    UserPrincipal userPrincipal=userPrincipals.iterator().next();
    return userPrincipal.getName();
  }
  return null;
}
