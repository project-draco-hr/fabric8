{
  byte formatCode=in.readByte();
  if (formatCode == -1) {
    return null;
  }
  if (formatCode == TypeRegistry.DESCRIBED_FORMAT_CODE) {
    AmqpType descriptor=read(in);
    AmqpType rc=null;
    if (descriptor instanceof AMQPULong) {
      rc=(AmqpType)TypeRegistry.instance().getFormatCodeMap().get(((AMQPULong)descriptor).getValue()).newInstance();
    }
 else     if (descriptor instanceof AMQPSymbol) {
      rc=(AmqpType)TypeRegistry.instance().getSymbolicCodeMap().get(((AMQPSymbol)descriptor).getValue()).newInstance();
    }
 else {
      throw new IllegalArgumentException("Unknown AMQP descriptor type");
    }
    if (rc != null) {
      rc.read(formatCode,in);
    }
    return rc;
  }
 else   if (formatCode == TypeRegistry.NULL_FORMAT_CODE) {
    return null;
  }
  AmqpType primitive=(AmqpType)TypeRegistry.instance().getPrimitiveFormatCodeMap().get(formatCode).newInstance();
  if (primitive != null) {
    primitive.read(formatCode,in);
  }
  return primitive;
}
