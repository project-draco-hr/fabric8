{
synchronized (lock) {
    while (pendings.get() > 0) {
      lock.wait();
    }
    if (!errors.isEmpty()) {
      StringWriter sw=new StringWriter();
      int nr=1;
      int pad=Integer.toString(errors.size()).length();
      for (      Throwable t : errors) {
        sw.append(String.format("%n\t%0" + pad + "d: %s",nr++,t.getMessage()));
      }
      LOGGER.error("Summary of errors while downloading artifacts:" + sw.toString());
      throw new MultiException(String.format("Error%s while downloading artifacts:%s",errors.size() == 1 ? "" : "s",sw.toString()),errors);
    }
    return artifacts;
  }
}
