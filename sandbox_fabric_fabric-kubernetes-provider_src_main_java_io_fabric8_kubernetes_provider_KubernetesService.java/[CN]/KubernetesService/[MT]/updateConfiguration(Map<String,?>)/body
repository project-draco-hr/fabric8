{
  ClassLoader tccl=Thread.currentThread().getContextClassLoader();
  try {
    getConfigurer().configure(configuration,this);
    kubernetesFactory=new KubernetesFactory();
    if (Strings.isNotBlank(kubernetesMaster)) {
      kubernetesFactory.setAddress(kubernetesMaster);
    }
    Thread.currentThread().setContextClassLoader(Kubernetes.class.getClassLoader());
    this.kubernetes=kubernetesFactory.createKubernetes();
  }
 catch (  Throwable e) {
    LOG.error("Failed to update configuration " + configuration + ". "+ e,e);
    throw e;
  }
 finally {
    Thread.currentThread().setContextClassLoader(tccl);
  }
}
