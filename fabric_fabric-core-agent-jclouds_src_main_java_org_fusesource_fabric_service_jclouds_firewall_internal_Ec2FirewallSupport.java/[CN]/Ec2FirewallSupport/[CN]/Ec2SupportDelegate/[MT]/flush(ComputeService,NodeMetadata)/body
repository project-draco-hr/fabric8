{
  String region=AWSUtils.parseHandle(node.getId())[0];
  EC2Client ec2Client=EC2Client.class.cast(service.getContext().unwrap().getProviderMetadata().getApiMetadata());
  String groupName="jclouds#" + node.getGroup() + "#"+ region;
  Set<SecurityGroup> matchedSecurityGroups=ec2Client.getSecurityGroupServices().describeSecurityGroupsInRegion(region,groupName);
  for (  SecurityGroup securityGroup : matchedSecurityGroups) {
    for (    IpPermission ipPermission : securityGroup) {
      for (      String cdr : ipPermission.getIpRanges()) {
        ec2Client.getSecurityGroupServices().revokeSecurityGroupIngressInRegion(region,groupName,IpProtocol.TCP,ipPermission.getFromPort(),ipPermission.getToPort(),cdr);
      }
    }
  }
  authorize(service,node,"0.0.0.0/0",22);
}
