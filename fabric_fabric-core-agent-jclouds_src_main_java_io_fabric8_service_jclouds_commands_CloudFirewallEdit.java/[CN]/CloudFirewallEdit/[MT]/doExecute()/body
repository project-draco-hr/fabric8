{
  if (validateArguments()) {
    ComputeService computeService=findTargetComputeService();
    if (computeService == null) {
      return null;
    }
    Set<String> sourceCidrs=collectCirds();
    FirewallManager firewallManager=firewallManagerFactory.getFirewallManager(computeService);
    NodeMetadata node=null;
    if (!Strings.isNullOrEmpty(targetContainerName) && getCurator().getZookeeperClient().isConnected() && fabricService != null) {
      CreateJCloudsContainerMetadata metadata=getContainerCloudMetadata(targetContainerName);
      if (metadata != null && !Strings.isNullOrEmpty(metadata.getNodeId())) {
        targetNodeId=metadata.getNodeId();
      }
    }
    if (!Strings.isNullOrEmpty(targetNodeId)) {
      node=computeService.getNodeMetadata(targetNodeId);
    }
    if (node == null) {
      System.err.println("Could not find target node. Make sure you specified either --target-node-id or --target-container using a valid cloud container.");
      return null;
    }
    if (flush) {
      firewallManager.addRule(Rule.create().destination(node).flush());
      return null;
    }
    for (    String cidr : sourceCidrs) {
      Rule rule=Rule.create().destination(node).source(cidr);
      if (port != null && port.length > 0) {
        rule=rule.ports(port);
      }
      if (revoke) {
        firewallManager.addRule(rule.revoke());
      }
 else {
        firewallManager.addRule(rule);
      }
    }
  }
  return null;
}
