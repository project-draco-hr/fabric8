{
  int idx=remaining.indexOf(':');
  if (idx > 0) {
    String name=remaining.substring(0,idx);
    String fabricPath=getFabricPath(name);
    String childUri=replaceAnyIpAddress(remaining.substring(idx + 1));
    if (params != null && params.size() > 0) {
      childUri=childUri + "?" + URISupport.createQueryString(params);
    }
    Group group=ZooKeeperGroupFactory.create(getCurator(),fabricPath);
    return new FabricPublisherEndpoint(uri,this,group,childUri);
  }
 else {
    String fabricPath=getFabricPath(remaining);
    Group group=ZooKeeperGroupFactory.create(getCurator(),fabricPath);
    return new FabricLocatorEndpoint(uri,this,group);
  }
}
