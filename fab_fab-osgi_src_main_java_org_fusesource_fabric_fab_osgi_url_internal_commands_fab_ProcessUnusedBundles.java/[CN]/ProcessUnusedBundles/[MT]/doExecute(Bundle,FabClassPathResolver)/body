{
  List<DependencyTree> sharedDependencies=resolver.getSharedDependencies();
  List<Bundle> bundles=new ArrayList<Bundle>();
  for (  DependencyTree dependency : sharedDependencies) {
    String name=dependency.getBundleSymbolicName();
    String version=dependency.getVersion();
    Bundle b=Bundles.findBundle(bundleContext,name,version);
    if (b != null) {
      bundles.add(b);
    }
 else {
      System.out.println("Warning could not find bundle: " + name + " version: "+ version);
    }
  }
  bundles.add(bundle);
  Set<Bundle> bundleSet=new HashSet<Bundle>(bundles);
  for (  Bundle b : bundles) {
    if (!bundleUsedByOtherBundles(b,bundleSet)) {
      processBundle(b);
    }
  }
}
