{
  String mvnUrl=stripUrl(url);
  if (mvnUrl.startsWith("mvn:")) {
    MavenDownloadTask task=new MavenDownloadTask(mvnUrl,cache,system,configuration,executor);
    executor.submit(task);
    return task;
  }
 else   if (mvnUrl.startsWith("profile:")) {
    NoDownloadTask task=new NoDownloadTask(url,executor);
    executor.submit(task);
    return task;
  }
 else {
    final SimpleDownloadTask task=new SimpleDownloadTask(url,executor);
    executor.submit(task);
    return task;
  }
}
