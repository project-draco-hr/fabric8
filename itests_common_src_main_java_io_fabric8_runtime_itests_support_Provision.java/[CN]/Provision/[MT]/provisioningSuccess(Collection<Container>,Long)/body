{
  Set<Container> cntset=new HashSet<>(containers);
  long startedAt=System.currentTimeMillis();
  long remaining=timeout;
  while (!cntset.isEmpty() && remaining > 0 && !Thread.interrupted()) {
    containerStatus(containers,"success",remaining);
    remaining=startedAt + timeout - System.currentTimeMillis();
    for (    Container container : containers) {
      if (!container.isAliveAndOK()) {
        if (container.getProvisionException() != null) {
          throw new Exception(container.getProvisionException());
        }
 else         if (remaining < 0) {
          throw new Exception("Container " + container.getId() + " failed to provision. Status:"+ container.getProvisionStatus()+ " Exception:"+ container.getProvisionException());
        }
      }
 else {
        cntset.remove(container);
      }
    }
    Thread.sleep(1000);
    remaining=startedAt + timeout - System.currentTimeMillis();
  }
}
