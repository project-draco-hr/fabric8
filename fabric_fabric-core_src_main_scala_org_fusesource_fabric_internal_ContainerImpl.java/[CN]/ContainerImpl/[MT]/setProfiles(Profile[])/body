{
  try {
    String version=service.getZooKeeper().getStringData(ZkPath.CONFIG_CONTAINER.getPath(id));
    String node=ZkPath.CONFIG_VERSIONS_CONTAINER.getPath(version,id);
    String str="";
    if (profiles != null) {
      for (      Profile parent : profiles) {
        if (!version.equals(parent.getVersion())) {
          throw new IllegalArgumentException("Version mismatch setting profile " + parent + " with version "+ parent.getVersion()+ " expected version "+ version);
        }
        if (parent.isAbstract()) {
          throw new IllegalArgumentException("The profile " + parent + " is abstract and can not "+ "be associated to containers");
        }
        if (!str.isEmpty()) {
          str+=" ";
        }
        str+=parent.getId();
      }
    }
    if (str.trim().isEmpty()) {
      str="default";
    }
    service.getZooKeeper().setData(node,str);
  }
 catch (  Exception e) {
    throw new FabricException(e);
  }
}
