{
  try {
    return containerTemplate.execute(new ContainerTemplate.BundleStateCallback<BundleInfo[]>(){
      public BundleInfo[] doWithBundleState(      BundleStateMBean bundleState) throws Exception {
        TabularData bundles=bundleState.listBundles();
        BundleInfo[] info=new BundleInfo[bundles.size()];
        int i=0;
        for (        Object data : bundles.values().toArray()) {
          info[i++]=new JmxBundleInfo((CompositeData)data);
        }
        Arrays.sort(info,new BundleInfoComparator());
        return info;
      }
    }
);
  }
 catch (  Exception e) {
    logger.warn("Error while retrieving bundles. This exception will be ignored.",e);
    return new BundleInfo[0];
  }
}
