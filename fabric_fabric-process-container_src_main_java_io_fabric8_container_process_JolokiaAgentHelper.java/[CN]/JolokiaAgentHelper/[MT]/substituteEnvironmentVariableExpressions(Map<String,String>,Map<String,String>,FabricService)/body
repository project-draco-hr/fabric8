{
  String zkUser=null;
  String zkPassword=null;
  if (fabricService != null) {
    zkUser=fabricService.getZooKeeperUser();
    zkPassword=fabricService.getZookeeperPassword();
  }
  Set<Map.Entry<String,String>> envEntries=environmentVariables.entrySet();
  for (  String key : map.keySet()) {
    String text=map.get(key);
    String oldText=text;
    if (Strings.isNotBlank(text)) {
      for (      Map.Entry<String,String> envEntry : envEntries) {
        String envKey=envEntry.getKey();
        String envValue=envEntry.getValue();
        if (Strings.isNotBlank(envKey) && Strings.isNotBlank(envValue)) {
          text=text.replace("${env:" + envKey + "}",envValue);
        }
      }
      if (Strings.isNotBlank(zkUser)) {
        text=text.replace("${zookeeper.user}",zkUser);
      }
      if (Strings.isNotBlank(zkPassword)) {
        text=text.replace("${zookeeper.password}",zkPassword);
      }
      if (!Objects.equal(oldText,text)) {
        map.put(key,text);
      }
    }
  }
}
