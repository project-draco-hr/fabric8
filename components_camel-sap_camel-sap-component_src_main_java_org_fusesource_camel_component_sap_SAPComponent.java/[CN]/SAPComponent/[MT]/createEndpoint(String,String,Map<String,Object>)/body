{
  String[] urlComponents=remaining.split(":");
  if (urlComponents.length != 3) {
    throw new IllegalArgumentException("URI must be of the form: sap:[destination:<destinationName>|server:<serverName>]:<rfcName>");
  }
  Endpoint endpoint;
  if (urlComponents[0].equals("destination")) {
    parameters.put("destinationName",urlComponents[1]);
    parameters.put("rfcName",urlComponents[2]);
    endpoint=new SAPDestinationEndpoint(uri,this);
  }
 else   if (urlComponents[0].equals("server")) {
    parameters.put("serverName",urlComponents[1]);
    parameters.put("rfcName",urlComponents[2]);
    endpoint=new SAPServerEndpoint(uri,this);
  }
 else {
    throw new IllegalArgumentException("Must specify 'client' or 'server' in URL");
  }
  setProperties(endpoint,parameters);
  return endpoint;
}
