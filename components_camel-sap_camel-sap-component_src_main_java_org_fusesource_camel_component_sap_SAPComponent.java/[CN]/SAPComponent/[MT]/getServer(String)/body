{
  JCoServer server=activeServers.get(serverName);
  if (server == null) {
    server=JCoServerFactory.getServer(serverName);
    server.setCallHandlerFactory(new FunctionHandlerFactory());
    server.addServerExceptionListener(serverErrorAndExceptionListener);
    server.addServerErrorListener(serverErrorAndExceptionListener);
    server.addServerStateChangedListener(serverStateChangedListener);
    JCoCustomRepository repository=getRepository(serverName);
    if (repository != null) {
      String repositoryDestination=server.getRepositoryDestination();
      if (repositoryDestination != null) {
        try {
          repository.setDestination(JCoDestinationManager.getDestination(repositoryDestination));
        }
 catch (        Exception e) {
          LOG.warn("Unable to set destination on custom repository '" + serverName + "'",e);
        }
      }
      server.setRepository(repository);
    }
    activeServers.put(serverName,server);
    if (isStarted()) {
      server.start();
      LOG.debug("Started server " + server.getProgramID());
    }
  }
  return server;
}
