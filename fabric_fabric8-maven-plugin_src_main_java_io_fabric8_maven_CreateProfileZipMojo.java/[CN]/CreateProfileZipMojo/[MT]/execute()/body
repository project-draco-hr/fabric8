{
  try {
    if (isIgnoreProject())     return;
    generateZip();
    if (reactorProjects != null) {
      List<MavenProject> pomZipProjects=new ArrayList<>();
      List<MavenProject> projectsWithZip=new ArrayList<>();
      for (      MavenProject reactorProject : reactorProjects) {
        if ("pom".equals(reactorProject.getPackaging())) {
          pomZipProjects.add(reactorProject);
        }
        List<Plugin> buildPlugins=reactorProject.getBuildPlugins();
        for (        Plugin buildPlugin : buildPlugins) {
          String artifactId=buildPlugin.getArtifactId();
          if ("fabric8-maven-plugin".equals(artifactId)) {
            Object goals=buildPlugin.getGoals();
            boolean hasZipGoal=goals != null && goals.toString().contains("zip");
            List<PluginExecution> executions=buildPlugin.getExecutions();
            for (            PluginExecution execution : executions) {
              List<String> execGoals=execution.getGoals();
              if (execGoals.contains("zip")) {
                hasZipGoal=true;
              }
            }
            getLog().debug("project " + reactorProject.getArtifactId() + " has zip goal: "+ hasZipGoal);
            projectsWithZip.add(reactorProject);
          }
        }
      }
      if (reactorProjects.size() > 1 && project == reactorProjects.get(reactorProjects.size() - 1)) {
        getLog().info("");
        getLog().info("Creating aggregated profile zip");
        getLog().info("built the last fabric8:zip project so generating a combined zip for all " + projectsWithZip.size() + " projects with a fabric8:zip goal");
        MavenProject rootProject=reactorProjects.get(0);
        getLog().info("Choosing root project " + rootProject.getArtifactId() + " for generation of aggregated zip");
        generateAggregatedZip(rootProject,projectsWithZip,pomZipProjects);
      }
    }
  }
 catch (  MojoExecutionException e) {
    throw e;
  }
catch (  Exception e) {
    throw new MojoExecutionException("Error executing",e);
  }
}
