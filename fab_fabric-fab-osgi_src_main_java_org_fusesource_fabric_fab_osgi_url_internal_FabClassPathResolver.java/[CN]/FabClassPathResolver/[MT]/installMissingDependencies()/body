{
  BundleContext bundleContext=connection.getBundleContext();
  if (bundleContext == null) {
    LOG.warn("No BundleContext available so cannot install provided dependencies");
  }
 else {
    for (    DependencyTree dependency : installDependencies) {
      String name=dependency.getBundleSymbolicName();
      if (Bundles.isInstalled(bundleContext,name)) {
        LOG.info("Bundle already installed: " + name);
      }
 else {
        URL url=dependency.getJarURL();
        String installUri=url.toExternalForm();
        try {
          if (!dependency.isBundle()) {
            FabConnection childConnection=connection.createChild(url);
            PomDetails pomDetails=childConnection.resolvePomDetails();
            if (pomDetails != null && pomDetails.isValid()) {
              LOG.info("Installing fabric bundle: " + name + " from: "+ installUri);
              bundleContext.installBundle(installUri,childConnection.getInputStream());
            }
 else {
              LOG.warn("Could not deduce the pom.xml for the jar " + installUri + " so cannot treat as FAB");
            }
          }
 else {
            LOG.info("Installing bundle: " + name + " from: "+ installUri);
            bundleContext.installBundle(installUri);
          }
        }
 catch (        BundleException e) {
          LOG.error("Failed to deploy " + installUri + " due to error: "+ e,e);
          throw e;
        }
catch (        IOException e) {
          LOG.error("Failed to deploy " + installUri + " due to error: "+ e,e);
          throw e;
        }
catch (        RuntimeException e) {
          LOG.error("Failed to deploy " + installUri + " due to error: "+ e,e);
          throw e;
        }
      }
    }
  }
}
