{
  byte magic[]=new byte[4];
  in.readFully(magic);
  if (!Arrays.equals(magic,AmqpDefinitions.MAGIC)) {
    throw new IOException("Invalid magic");
  }
  AmqpProtocolHeader rc=new AmqpProtocolHeader();
  rc.protocolId=(short)(in.readByte() & 0xFF);
  rc.major=(short)(in.readByte() & 0xFF);
  rc.minor=(short)(in.readByte() & 0xFF);
  rc.revision=(short)(in.readByte() & 0xFF);
  return rc;
}
