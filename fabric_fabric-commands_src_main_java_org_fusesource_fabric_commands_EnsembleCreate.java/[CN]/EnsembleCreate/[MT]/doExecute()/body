{
  if (clean) {
    service.clean();
  }
 else {
    if (agents == null || agents.isEmpty()) {
      throw new IllegalStateException("No agents specified.");
    }
  }
  if (agents != null && !agents.isEmpty()) {
    service.createCluster(agents);
    if (!noImport) {
      Import tool=new Import();
      tool.setBundleContext(getBundleContext());
      tool.setZooKeeper(service.getZooKeeper());
      tool.setSource(importDir);
      return tool.execute(session);
    }
  }
  return null;
}
