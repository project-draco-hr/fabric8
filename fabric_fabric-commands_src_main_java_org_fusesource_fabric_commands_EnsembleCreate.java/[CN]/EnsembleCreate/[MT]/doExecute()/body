{
  if (clean) {
    service.clean();
  }
 else {
    if (agents == null || agents.isEmpty()) {
      throw new IllegalStateException("No agents specified.");
    }
  }
  if (agents != null && !agents.isEmpty()) {
    service.createCluster(agents);
    if (!noImport) {
      if (ensembleStartupTime > 0L) {
        try {
          Thread.sleep(ensembleStartupTime);
        }
 catch (        InterruptedException e) {
        }
      }
      Import tool=new Import();
      tool.setSource(importDir);
      tool.setBundleContext(getBundleContext());
      tool.setZooKeeper(service.getZooKeeper());
      if (verbose) {
        tool.setVerbose(verbose);
      }
      return tool.execute(session);
    }
  }
  return null;
}
