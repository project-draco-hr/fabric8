{
  try {
    String name=System.getProperty(SystemProperties.KARAF_NAME);
    mbeanServer=(MBeanServer)bundleContext.getService(ref);
    if (mbeanServer != null) {
      mbeanServer.addNotificationListener(new ObjectName("JMImplementation:type=MBeanServerDelegate"),this,null,name);
      registerDomains();
    }
  }
 catch (  Exception e) {
    LOGGER.warn("An error occurred during mbean server registration. This exception will be ignored.",e);
  }
}
