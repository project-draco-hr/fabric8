{
  return gitReadOperation(new GitOperation<VersionData>(){
    public VersionData call(    Git git,    GitContext context) throws Exception {
      VersionData data=new VersionData();
      data.profiles=new HashMap<String,ProfileData>();
      checkoutVersion(git,version);
      File profilesDir=getProfilesDirectory(git);
      if (profilesDir.exists()) {
        File[] files=profilesDir.listFiles();
        if (files != null) {
          for (          File file : files) {
            if (file.isDirectory()) {
              String profile=file.getName();
              ProfileData profileData=new ProfileData();
              data.profiles.put(profile,profileData);
              profileData.configurations=doGetFileConfigurations(git,profile);
              File profileDirectory=file;
              File metadataFile=new File(profileDirectory,AGENT_METADATA_FILE);
              profileData.lastModified=profileDirectory.lastModified();
              if (metadataFile.exists()) {
                long modified=metadataFile.lastModified();
                profileData.lastModified=Math.max(profileData.lastModified,modified);
              }
            }
          }
        }
      }
      return data;
    }
  }
);
}
