{
  LOG.info("checking if token {} can interact with destination {}",new Object[]{token,destination});
  if (destination == null) {
    return;
  }
  if (destination.isComposite()) {
    for (    ActiveMQDestination dest : destination.getCompositeDestinations()) {
      authorizeDestinations(dest,token,action);
    }
  }
 else {
    String uri="/" + action + "/"+ destination.getDestinationTypeAsString()+ "/"+ destination.getPhysicalName();
    LOG.info("Authorizing token {} for uri {}",new Object[]{token,client.getURLPrefix() + uri});
    if (!client.authorize(uri,token)) {
      throw new SecurityException(String.format("Client is not authorized to perform action \"%s\" on destination \"%s\"",action,destination.getQualifiedName()));
    }
  }
}
