{
  LOG.info("Adding connection with context {} and info {}",new Object[]{context,info});
  if (context.getSecurityContext() == null) {
    ClassLoader original=Thread.currentThread().getContextClassLoader();
    Thread.currentThread().setContextClassLoader(OpenAMAuthenticationBroker.class.getClassLoader());
    try {
      JassCredentialCallbackHandler callback=new JassCredentialCallbackHandler(info.getUserName(),info.getPassword());
      LoginContext lc=new LoginContext(jassConfiguration,callback);
      lc.login();
      Subject subject=lc.getSubject();
      LOG.info("Got subject {}",subject);
      SecurityContext s=new OpenAMSecurityContext(info.getUserName(),subject,lc);
      context.setSecurityContext(s);
      securityContexts.add(s);
    }
 catch (    Exception e) {
      throw (SecurityException)new SecurityException("User name or password is invalid.").initCause(e);
    }
 finally {
      Thread.currentThread().setContextClassLoader(original);
    }
  }
  super.addConnection(context,info);
}
