{
  Profile overlayProfile;
  if (profile.isOverlay()) {
    overlayProfile=profile;
  }
 else {
    String environment=runtimeProperties.get().getProperty(SystemProperties.FABRIC_ENVIRONMENT);
    ProfileBuilder builder=ProfileBuilder.Factory.create(profile.getVersion(),profile.getId());
    builder.addOptions(new OverlayOptionsProvider(profile,environment));
    overlayProfile=builder.getProfile();
    LOGGER.info("Overlay profile");
  }
  return overlayProfile;
}
