{
  assertValid();
  LockHandle writeLock=profileRegistry.get().aquireWriteLock();
  try {
    LOGGER.info("updateProfile: {}",profile);
    return createOrUpdateProfileInternal(profile,false,new HashMap<String,Profile>());
  }
  finally {
    writeLock.unlock();
  }
}
