{
  if (mbeanInfo == null) {
    MBeanServer server=ManagementFactory.getPlatformMBeanServer();
    try {
      try {
        StandardMBean impl=new StandardMBean(Mockito.mock(mxbeanInterface),mxbeanInterface,true);
        server.registerMBean(impl,objectName);
        mbeanInfo=server.getMBeanInfo(objectName);
      }
  finally {
        if (server.isRegistered(objectName)) {
          server.unregisterMBean(objectName);
        }
      }
    }
 catch (    Exception ex) {
      throw new IllegalStateException("Cannot obtain MBeanInfo",ex);
    }
  }
  ClassLoader classLoader=mxbeanInterface.getClassLoader();
  InvocationHandler handler=new MXBeanInvocationHandler(serviceURL,objectName,username,password,classLoader,mbeanInfo);
  return (T)Proxy.newProxyInstance(classLoader,new Class<?>[]{mxbeanInterface},handler);
}
