{
  if (startCounter.addAndGet(1) == 1) {
    running.set(true);
    if (zkClient == null) {
      LOG.info("Using local ZKClient");
      managedZkClient=true;
      ZKClient client=new ZKClient(System.getProperty("zookeeper.url","localhost:2181"),Timespan.parse("10s"),null);
      client.start();
      client.waitForStart();
      zkClient=client;
    }
 else {
      managedZkClient=false;
    }
    group=ZooKeeperGroupFactory.create(zkClient,"/fabric/registry/clusters/fusemq/" + groupName,acl);
    singleton.start(group);
    if (id != null) {
      singleton.join(createState());
    }
  }
}
