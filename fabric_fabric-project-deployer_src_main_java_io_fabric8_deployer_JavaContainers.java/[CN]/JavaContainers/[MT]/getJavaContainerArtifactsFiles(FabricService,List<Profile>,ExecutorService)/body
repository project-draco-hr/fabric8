{
  DownloadManager downloadManager=DownloadManagers.createDownloadManager(fabricService,downloadExecutor);
  Map<String,File> answer=new HashMap<String,File>();
  ProfileService profileService=fabricService.adapt(ProfileService.class);
  for (  Profile profile : profileList) {
    Profile overlay=profileService.getOverlayProfile(profile);
    Map<String,Parser> profileArtifacts=AgentUtils.getProfileArtifacts(fabricService,downloadManager,overlay);
    appendMavenDependencies(profileArtifacts,profile);
    Set<String> rawUrls=profileArtifacts.keySet();
    List<String> cleanUrlsToDownload=new ArrayList<String>();
    for (    String rawUrl : rawUrls) {
      String mvnUrl=removeUriPrefixBeforeMaven(rawUrl);
      cleanUrlsToDownload.add(mvnUrl);
    }
    Map<String,File> profileFiles=AgentUtils.downloadLocations(downloadManager,cleanUrlsToDownload);
    if (profileFiles != null) {
      answer.putAll(profileFiles);
    }
  }
  return answer;
}
