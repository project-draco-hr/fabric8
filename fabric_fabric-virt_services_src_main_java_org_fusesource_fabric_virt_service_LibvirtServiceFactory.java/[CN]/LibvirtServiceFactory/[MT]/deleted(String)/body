{
  ServiceRegistration oldRegistration=registrations.remove(pid);
  if (bundleContext != null) {
    Connect connect=(Connect)bundleContext.getService(oldRegistration.getReference());
    try {
      connect.close();
    }
 catch (    LibvirtException e) {
      LOG.error("Error closing libvirt connection",e);
    }
  }
  if (oldRegistration != null) {
    oldRegistration.unregister();
  }
}
