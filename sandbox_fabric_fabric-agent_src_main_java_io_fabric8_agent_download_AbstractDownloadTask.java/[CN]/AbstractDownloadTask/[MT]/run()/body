{
  boolean done=false;
  try {
    while (!done) {
      try {
        File file=download();
        setFile(file);
        done=true;
        return;
      }
 catch (      IOException e) {
        if (++scheduleNbRun < 5) {
          long delay=(long)(scheduleDelay * 3 / 2 + Math.random() * scheduleDelay / 2);
          LOGGER.debug("Error downloading " + url + ": "+ e.getMessage()+ ". Retrying in approx "+ delay+ " ms.");
          Thread.sleep(delay);
          scheduleDelay*=2;
        }
 else {
          setException(initIOException("Error downloading " + url,e));
          done=true;
        }
      }
    }
  }
 catch (  Throwable e) {
    setException(initIOException("Error downloading " + url,e));
  }
}
