{
  facet.visitResources(new ResourceVisitor(){
    @Override public void visit(    VisitContext context,    Resource<?> resource){
      String name=resource.getName();
      if (name.endsWith(".xml")) {
        boolean camel=resource.getContents().contains("<camelContext");
        if (camel) {
          try {
            Document dom=XmlLineNumberParser.parseXml(resource.getResourceInputStream());
            if (dom != null) {
              List<Node> nodes=CamelXmlHelper.findAllEndpoints(dom);
              for (              Node node : nodes) {
                String uri=getSafeAttribute(node,"uri");
                String id=getSafeAttribute(node,"id");
                String lineNumber=(String)node.getUserData(XmlLineNumberParser.LINE_NUMBER);
                CamelEndpointDetails detail=new CamelEndpointDetails();
                detail.setResource(resource);
                detail.setLineNumber(lineNumber);
                detail.setEndpointInstance(id);
                detail.setEndpointUri(uri);
                detail.setEndpointComponentName(camelCatalog.endpointComponentName(uri));
                endpoints.add(detail);
              }
            }
          }
 catch (          Exception e) {
          }
        }
      }
    }
  }
);
}
