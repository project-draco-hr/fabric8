{
  closed.set(true);
  CuratorFramework curator=this.curator;
  if (curator != null) {
    for (    ConnectionStateListener listener : connectionStateListeners) {
      listener.stateChanged(curator,ConnectionState.LOST);
    }
    curator.getZookeeperClient().stop();
  }
  try {
    executor.submit(this).get();
  }
 catch (  Exception e) {
    LOGGER.warn("Error while closing curator",e);
  }
}
