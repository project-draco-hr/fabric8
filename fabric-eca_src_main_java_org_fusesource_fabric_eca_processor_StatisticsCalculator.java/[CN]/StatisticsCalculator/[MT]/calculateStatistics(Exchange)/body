{
  ObjectMapper objectMapper=new ObjectMapper();
  ObjectNode objectNode=objectMapper.createObjectNode();
  ObjectNode statsNode=objectNode.putObject("statistics");
  if (this.expressionDefinitions != null && this.expressionDefinitions.length > 0) {
    for (    ExpressionDefinition expressionDefinition : expressionDefinitions) {
      ObjectNode expressionNode=statsNode.putObject(expressionDefinition.getExpression());
      process(expressionDefinition,exchange,expressionNode);
    }
  }
 else {
    Map<String,Number> map=getNumbersFromExchange(exchange);
    if (map != null) {
      for (      Map.Entry<String,Number> entry : map.entrySet()) {
        ObjectNode valueNode=statsNode.putObject(entry.getKey());
        try {
          process(entry.getValue(),valueNode);
        }
 catch (        Throwable e) {
          LOG.error("Failed to process statistics on " + exchange + " for parameter "+ entry.getKey()+ " = "+ entry.getValue(),e);
        }
      }
    }
  }
  return objectNode.toString();
}
