{
  LOG.info("Generating archetypes from {} to {}",sourceDir.getCanonicalPath(),outputDir.getCanonicalPath());
  File[] files=sourceDir.listFiles();
  if (files != null) {
    for (    File file : files) {
      if (file.isDirectory()) {
        File pom=new File(file,"pom.xml");
        if (pom.exists() && isValidPom(pom)) {
          String fileName=file.getName();
          String outputName=fileName.replace("example","archetype");
          if (fileName.equals(outputName)) {
            outputName+="-archetype";
          }
          File archetypeDir=new File(outputDir,outputName);
          generateArchetype(file,pom,archetypeDir);
          File archetypePom=new File(archetypeDir,"pom.xml");
          if (archetypePom.exists()) {
            addArchetypeMetaData(archetypePom,outputName);
          }
        }
      }
    }
  }
}
