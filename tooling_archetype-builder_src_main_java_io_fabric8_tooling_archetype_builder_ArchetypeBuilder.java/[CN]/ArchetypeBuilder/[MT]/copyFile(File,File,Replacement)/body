{
  if (replaceFn != null && isSourceFile(src)) {
    String original=IOHelpers.readFully(src);
    String escapedContent=original;
    if (original.contains("${")) {
      String replaced=escapedContent.replaceAll(Pattern.quote("${"),"\\${D}{");
      escapedContent="#set( $D = '$' )\n" + replaced;
    }
    if (original.contains("##")) {
      String replaced=escapedContent.replaceAll(Pattern.quote("##"),"\\${H}");
      escapedContent="#set( $H = '##' )\n" + replaced;
    }
    String text=replaceFn.replace(escapedContent);
    IOHelpers.writeFully(dest,text);
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.warn("Not a source dir as the extension is {}",Files.getExtension(src.getName()));
    }
    Files.copy(src,dest);
  }
}
