{
  LOG.info("Generating archetypes from {} to {}",baseDir.getCanonicalPath(),outputDir.getCanonicalPath());
  File[] files=baseDir.listFiles();
  if (files != null) {
    for (    File file : files) {
      if (file.isDirectory()) {
        File projectDir=file;
        File projectPom=new File(projectDir,"pom.xml");
        if (projectPom.exists() && archetypeHelper.isValidProjectPom(projectPom)) {
          String fileName=file.getName();
          String archetypeDirName=fileName.replace("example","archetype");
          if (fileName.equals(archetypeDirName)) {
            archetypeDirName+="-archetype";
          }
          File archetypeDir=new File(outputDir,archetypeDirName);
          generateArchetype(projectDir,projectPom,archetypeDir,clean);
          File archetypePom=new File(archetypeDir,"pom.xml");
          if (archetypePom.exists()) {
            addArchetypeMetaData(archetypePom,archetypeDirName);
          }
        }
      }
    }
  }
}
