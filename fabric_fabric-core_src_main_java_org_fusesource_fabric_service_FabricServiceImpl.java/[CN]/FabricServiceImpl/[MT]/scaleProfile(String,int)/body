{
  if (numberOfInstances == 0) {
    throw new IllegalArgumentException("numberOfInstances should be greater or less than zero");
  }
  FabricRequirements requirements=getRequirements();
  ProfileRequirements profileRequirements=requirements.getOrCreateProfileRequirement(profile);
  Integer minimumInstances=profileRequirements.getMinimumInstances();
  List<Container> containers=Containers.containersForProfile(getContainers(),profile);
  int containerCount=containers.size();
  int newCount=containerCount + numberOfInstances;
  if (newCount < 0) {
    newCount=0;
  }
  boolean update=minimumInstances == null || newCount != minimumInstances;
  if (update) {
    profileRequirements.setMinimumInstances(newCount);
    setRequirements(requirements);
  }
  return update;
}
