{
  runtimeType=RuntimeType.getRuntimeType(System.getProperty("target.container"));
  if (runtimeType == RuntimeType.KARAF) {
    String jmxServiceURL="service:jmx:rmi://127.0.0.1:44444/jndi/rmi://127.0.0.1:1099/karaf-root";
    Map<String,Object> env=ManagementUtils.getDefaultEnvironment(jmxServiceURL);
    env.put(JMXConnector.CREDENTIALS,new String[]{credentials[0],credentials[1]});
    connector=ManagementUtils.getJMXConnector(jmxServiceURL,env,10,TimeUnit.SECONDS);
  }
 else   if (runtimeType == RuntimeType.TOMCAT) {
    String jmxServiceURL="service:jmx:rmi:///jndi/rmi://127.0.0.1:8089/jmxrmi";
    Map<String,Object> env=ManagementUtils.getDefaultEnvironment(jmxServiceURL);
    env.put(JMXConnector.CREDENTIALS,new String[]{credentials[0],credentials[1]});
    connector=ManagementUtils.getJMXConnector(jmxServiceURL,env,10,TimeUnit.SECONDS);
  }
 else   if (runtimeType == RuntimeType.WILDFLY) {
    String jmxServiceURL="service:jmx:http-remoting-jmx://127.0.0.1:9990";
    Map<String,Object> env=ManagementUtils.getDefaultEnvironment(jmxServiceURL);
    env.put(JMXConnector.CREDENTIALS,new String[]{credentials[0],credentials[1]});
    connector=WildFlyManagementUtils.getJMXConnector(jmxServiceURL,env,10,TimeUnit.SECONDS);
  }
 else {
    throw new IllegalStateException("Usupported target container: " + runtimeType);
  }
  proxy=JMX.newMXBeanProxy(connector.getMBeanServerConnection(),ProfileManagement.OBJECT_NAME,ProfileManagement.class);
}
