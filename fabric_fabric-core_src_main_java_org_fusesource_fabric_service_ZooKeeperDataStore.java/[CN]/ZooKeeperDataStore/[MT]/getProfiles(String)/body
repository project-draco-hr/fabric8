{
  assertValid();
  try {
    List<String> profiles=new ArrayList<String>();
    profiles.addAll(getTreeCache().getChildrenNames(ZkPath.CONFIG_ENSEMBLE_PROFILES.getPath()));
    profiles.addAll(getTreeCache().getChildrenNames(ZkPath.CONFIG_VERSIONS_PROFILES.getPath(version)));
    return profiles;
  }
 catch (  Exception e) {
    throw new FabricException(e);
  }
}
