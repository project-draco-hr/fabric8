{
  assertValid();
  try {
    Map<String,Map<String,String>> oldCfgs=getConfigurations(version,profile);
    String path=ZkProfiles.getPath(version,profile);
    for (    Map.Entry<String,Map<String,String>> entry : configurations.entrySet()) {
      String pid=entry.getKey();
      oldCfgs.remove(pid);
      setConfiguration(version,profile,pid,entry.getValue());
    }
    for (    String key : oldCfgs.keySet()) {
      deleteSafe(getCurator(),path + "/" + key+ ".properties");
    }
  }
 catch (  Exception e) {
    throw new FabricException(e);
  }
}
