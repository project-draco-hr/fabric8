{
  assertValid();
  try {
    String path=ZkProfiles.getPath(version,profile);
    byte[] data=DataStoreHelpers.toBytes(DataStoreHelpers.toProperties(configuration));
    String p=path + "/" + pid+ ".properties";
    setData(getCurator(),p,data);
  }
 catch (  Exception e) {
    throw new FabricException(e);
  }
}
