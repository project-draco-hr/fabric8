{
  String errors=null;
  String answer=null;
  String message=join(asList(commands)," ");
  try {
    System.out.println("Executing " + message);
    ProcessBuilder builder=new ProcessBuilder().command(commands).directory(workDir);
    Map<String,String> env=builder.environment();
    Map<String,String> envVars=createChildEnvironmentVariables();
    env.putAll(envVars);
    logEnvironmentVariables(env);
    Process process=builder.start();
    answer=readProcessOutput(process.getInputStream(),message);
    errors=processErrors(process.getErrorStream(),message);
    int status=process.waitFor();
    assertEquals("Command " + message + "; "+ answer+ " Status",0,status);
  }
 catch (  Exception e) {
    fail("Failed to execute command " + message + ": "+ e);
  }
  errors=errors.trim();
  if (errors.length() > 0) {
    fail("Command: " + message + " got errors: "+ errors);
  }
  return answer;
}
