{
  SslContextFactory sslContextFactory=null;
  if (trustAllCerts) {
    sslContextFactory=new SslContextFactory(trustAllCerts);
  }
 else   if (caCertData != null || caCertFile != null) {
    KeyStore trustStore=WebClients.createTrustStore(caCertData,caCertFile);
    sslContextFactory=new SslContextFactory();
    sslContextFactory.setTrustStore(trustStore);
  }
  if ((clientCertFile != null || clientCertData != null) && (clientKeyFile != null || clientKeyData != null)) {
    if (sslContextFactory == null) {
      sslContextFactory=new SslContextFactory();
    }
    KeyStore keyStore=WebClients.createKeyStore(this.clientCertData,this.clientCertFile,this.clientKeyData,this.clientKeyFile,this.clientKeyAlgo,this.clientKeyPassword);
    sslContextFactory.setKeyStore(keyStore);
    sslContextFactory.setKeyStorePassword(new String(this.clientKeyPassword));
    sslContextFactory.setKeyManagerPassword(new String(this.clientKeyPassword));
  }
  sslContextFactory.setIncludeProtocols("TLSv1","TLSv1.1","TLSv1.2");
  WebSocketClient client=new WebSocketClient(sslContextFactory);
  return client;
}
