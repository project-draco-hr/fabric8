{
  ConfigurationAdmin configAdmin=getOsgiService(ConfigurationAdmin.class);
  assertNotNull(configAdmin);
  FeaturesService featuresService=getOsgiService(FeaturesService.class);
  Feature feature=featuresService.getFeature("fabric-jaas");
  assertTrue(featuresService.isInstalled(feature));
  String sshRealm=readProperty(configAdmin,"org.apache.karaf.shell","sshRealm");
  String jmxRealm=readProperty(configAdmin,"org.apache.karaf.management","jmxRealm");
  assertEquals("karaf",sshRealm);
  assertEquals("karaf",jmxRealm);
  Thread.sleep(DEFAULT_WAIT);
  System.err.println(executeCommand("osgi:list"));
  System.err.println(executeCommand("fabric:create -n root"));
  sshRealm=readProperty(configAdmin,"org.apache.karaf.shell","sshRealm");
  jmxRealm=readProperty(configAdmin,"org.apache.karaf.management","jmxRealm");
  assertEquals("zookeeper",sshRealm);
  assertEquals("zookeeper",jmxRealm);
  featuresService.uninstallFeature("fabric-jaas");
  Thread.sleep(DEFAULT_WAIT);
  sshRealm=readProperty(configAdmin,"org.apache.karaf.shell","sshRealm");
  jmxRealm=readProperty(configAdmin,"org.apache.karaf.management","jmxRealm");
  assertEquals("karaf",sshRealm);
  assertEquals("karaf",jmxRealm);
}
