{
  boolean hasEnoughResource=data.hasEnoughResource();
  LOG.warn("DataNode.handleDiskError: Keep Running: " + hasEnoughResource);
  int dp_error=DatanodeProtocol.DISK_ERROR;
  if (hasEnoughResource == false) {
    dp_error=DatanodeProtocol.FATAL_DISK_ERROR;
  }
  notifyNamenode(dp_error,errMsgr);
  if (hasEnoughResource) {
    scheduleBlockReport(0);
    return;
  }
  LOG.warn("DataNode is shutting down.\n" + errMsgr);
  shouldRun=false;
}
