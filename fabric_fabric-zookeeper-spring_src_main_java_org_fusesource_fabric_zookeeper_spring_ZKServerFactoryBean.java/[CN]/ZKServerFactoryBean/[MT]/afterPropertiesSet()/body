{
  if (purge) {
    deleteFilesInDir(getDataLogDir());
    deleteFilesInDir(getDataDir());
  }
  FileTxnSnapLog ftxn=new FileTxnSnapLog(getDataLogDir(),getDataDir());
  zooKeeperServer.setTxnLogFactory(ftxn);
  zooKeeperServer.setTickTime(getTickTime());
  zooKeeperServer.setMinSessionTimeout(getMinSessionTimeout());
  zooKeeperServer.setMaxSessionTimeout(getMaxSessionTimeout());
  connectionFactory=new NIOServerCnxnFactory();
  connectionFactory.configure(getClientPortAddress(),getMaxClientConnections());
  connectionFactory.startup(zooKeeperServer);
}
