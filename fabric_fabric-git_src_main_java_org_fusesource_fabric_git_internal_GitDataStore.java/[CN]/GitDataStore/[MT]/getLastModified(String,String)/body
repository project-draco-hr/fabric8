{
  assertValid();
  Long answer=gitOperation(new GitOperation<Long>(){
    public Long call(    Git git,    GitContext context) throws Exception {
      checkoutVersion(git,GitProfiles.getBranch(version,profile));
      File profileDirectory=getProfileDirectory(git,profile);
      File metadataFile=new File(profileDirectory,AGENT_METADATA_FILE);
      Long answer=null;
      if (profileDirectory.exists()) {
        answer=profileDirectory.lastModified();
        if (metadataFile.exists()) {
          long modified=metadataFile.lastModified();
          if (modified > answer) {
            answer=modified;
          }
        }
      }
      return answer;
    }
  }
,!hasVersion(version));
  return answer != null ? answer.longValue() : 0;
}
