{
  assertValid();
  Repository repository=git.getRepository();
  StoredConfig config=repository.getConfig();
  String url=config.getString("remote",remote,"url");
  if (Strings.isNullOrBlank(url)) {
    LOG.info("No remote repository defined yet for the git repository at " + GitHelpers.getRootGitDirectory(git) + " so not doing a push");
    return Collections.EMPTY_LIST;
  }
  String branch=gitContext != null && gitContext.getPushBranch() != null ? gitContext.getPushBranch() : GitHelpers.currentBranch(git);
  if (!branch.equals(MASTER_BRANCH)) {
    return git.push().setCredentialsProvider(credentialsProvider).setRefSpecs(new RefSpec(MASTER_BRANCH),new RefSpec(branch)).call();
  }
 else {
    return git.push().setCredentialsProvider(credentialsProvider).setRefSpecs(new RefSpec(branch)).call();
  }
}
