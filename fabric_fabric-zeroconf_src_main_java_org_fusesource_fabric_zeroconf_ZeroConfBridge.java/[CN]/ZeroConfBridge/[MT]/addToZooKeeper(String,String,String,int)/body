{
  String id=name.replace(' ','-');
  String key="/fabric/registry/clusters/stats/" + id + ".properties";
  Properties properties=new Properties();
  properties.setProperty("name",name);
  properties.setProperty("zeroConfType",type);
  properties.setProperty("host",server);
  properties.setProperty("port","" + port);
  IZKClient zk=getZkClient();
  if (zk == null) {
    LOG.warn("No ZooKeeper client set so cannot write entry " + key + " with properties: "+ properties);
  }
 else {
    try {
      LOG.info("Writing to ZK + " + key + " ZeroConf properties "+ properties);
      StringWriter buffer=new StringWriter();
      String comments="Generated by fabric-zeroconf";
      properties.store(buffer,comments);
      String data=buffer.toString();
      zk.createOrSetWithParents(key,data,CreateMode.EPHEMERAL);
    }
 catch (    Exception e) {
      LOG.warn("Failed to write entry " + key + "to ZooKeeper: "+ e,e);
    }
  }
}
