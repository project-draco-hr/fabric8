{
  return Iterables.filter(securityGroup.getRules(),new Predicate<SecurityGroupRule>(){
    @Override public boolean apply(    @Nullable SecurityGroupRule input){
      if (!rangeFulfilled(input.getFromPort(),input.getToPort(),ports)) {
        return false;
      }
 else       if (!input.getIpRange().equals(source)) {
        return false;
      }
      return true;
    }
  }
);
}
