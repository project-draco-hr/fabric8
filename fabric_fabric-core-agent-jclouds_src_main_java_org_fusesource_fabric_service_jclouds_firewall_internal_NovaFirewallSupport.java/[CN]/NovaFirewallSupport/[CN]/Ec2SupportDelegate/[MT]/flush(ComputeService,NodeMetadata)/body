{
  String region=AWSUtils.parseHandle(node.getId())[0];
  Optional<? extends SecurityGroupApi> securityGroupApi=getSecurityGroup(service,region);
  if (securityGroupApi.isPresent()) {
    String groupName="jclouds-" + node.getGroup();
    Optional<? extends SecurityGroup> securityGroup=getSecurityGroupForGroup(securityGroupApi.get(),groupName);
    if (securityGroup.isPresent()) {
      try {
        for (        SecurityGroupRule rule : securityGroup.get().getRules()) {
          securityGroupApi.get().deleteRule(rule.getId());
        }
      }
 catch (      IllegalStateException e) {
      }
    }
  }
  authorize(service,node,"0.0.0.0",22);
}
