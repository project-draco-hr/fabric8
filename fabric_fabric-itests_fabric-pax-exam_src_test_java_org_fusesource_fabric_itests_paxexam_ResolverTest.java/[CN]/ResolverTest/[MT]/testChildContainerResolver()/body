{
  System.err.println(executeCommand("fabric:create -n"));
  IZKClient zookeeper=getOsgiService(IZKClient.class);
  try {
    createAndAssertChildContainer("child1","root","default");
    Container child1=getFabricService().getContainer("child1");
    Assert.assertEquals("localhostname",ZooKeeperUtils.getSubstitutedPath(zookeeper,ZkPath.CONTAINER_RESOLVER.getPath("child1")));
    String sshUrlWithLocalhostResolver=child1.getSshUrl();
    executeCommand("fabric:container-resolver-set --container child1 localip");
    Assert.assertEquals("localip",ZooKeeperUtils.getSubstitutedPath(zookeeper,ZkPath.CONTAINER_RESOLVER.getPath("child1")));
    String sshUrlWithLocalIpResolver=child1.getSshUrl();
    System.out.println("SSH URL with " + sshUrlWithLocalhostResolver + " resolver: localhostname");
    System.out.println("SSH URL with " + sshUrlWithLocalIpResolver + " resolver: localip");
    Assert.assertNotSame(sshUrlWithLocalhostResolver,sshUrlWithLocalIpResolver);
    ZooKeeperUtils.set(zookeeper,ZkPath.CONTAINER_PUBLIC_IP.getPath("child1"),"my.public.ip.address");
    executeCommand("fabric:container-resolver-set --container child1 publicip");
    Assert.assertEquals("publicip",ZooKeeperUtils.getSubstitutedPath(zookeeper,ZkPath.CONTAINER_RESOLVER.getPath("child1")));
    String sshUrlWithPublicIpResolver=child1.getSshUrl();
    System.out.println("SSH URL with " + sshUrlWithPublicIpResolver + " resolver: publicip");
    Assert.assertNotNull(sshUrlWithPublicIpResolver);
    Assert.assertTrue(sshUrlWithPublicIpResolver.startsWith("my.public.ip.address"));
    ZooKeeperUtils.set(zookeeper,ZkPath.CONTAINER_MANUAL_IP.getPath("child1"),"my.manual.ip.address");
    executeCommand("fabric:container-resolver-set --container child1 manualip");
    Assert.assertEquals("manualip",ZooKeeperUtils.getSubstitutedPath(zookeeper,ZkPath.CONTAINER_RESOLVER.getPath("child1")));
    String sshUrlWithManualIpResolver=child1.getSshUrl();
    System.out.println("SSH URL with " + sshUrlWithManualIpResolver + " resolver: manualip");
    Assert.assertNotNull(sshUrlWithManualIpResolver);
    Assert.assertTrue(sshUrlWithManualIpResolver.startsWith("my.manual.ip.address"));
  }
  finally {
    destroyChildContainer("child1");
  }
}
