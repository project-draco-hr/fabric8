{
  Encryption encryption=encryptionSupport.getEncryption();
  String encryptionPrefix=encryptionSupport.getEncryptionPrefix();
  String encryptionSuffix=encryptionSupport.getEncryptionSuffix();
  if (encryption == null) {
    return password;
  }
 else {
    boolean prefix=encryptionPrefix == null || password.startsWith(encryptionPrefix);
    boolean suffix=encryptionSuffix == null || password.endsWith(encryptionSuffix);
    if (prefix && suffix) {
      return password;
    }
 else {
      String p=encryption.encryptPassword(password);
      if (encryptionPrefix != null) {
        p=encryptionPrefix + p;
      }
      if (encryptionSuffix != null) {
        p=p + encryptionSuffix;
      }
      return p;
    }
  }
}
