{
  super.initialize(subject,callbackHandler,options);
  if (bundleContext != null) {
    encryptionSupport=new EncryptionSupport(options);
  }
 else {
    encryptionSupport=new BasicEncryptionSupport(options);
  }
  debug="true".equalsIgnoreCase((String)options.get("debug"));
  if (zookeeper == null) {
    ZKClientFactoryBean factory=new ZKClientFactoryBean();
    users=new Properties();
    try {
      zookeeper=factory.getObject();
      zookeeper.registerListener(this);
      connected.await(1,TimeUnit.SECONDS);
    }
 catch (    Exception e) {
      LOG.warn("Failed initializing authentication plugin",e);
    }
  }
}
