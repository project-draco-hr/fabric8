{
  HashMap<String,Object> env=new HashMap<String,Object>();
  if (user != null) {
    String[] creds={user,password};
    env.put(JMXConnector.CREDENTIALS,creds);
  }
  JMXConnector connector=JMXConnectorFactory.connect(new JMXServiceURL(jmx),env);
  try {
    connection=connector.getMBeanServerConnection();
    Stats oldStats=fetchStats();
    while (true) {
      Thread.sleep(interval);
      Stats newStats=fetchStats();
      analyze(oldStats,newStats);
    }
  }
  finally {
    connector.close();
  }
}
