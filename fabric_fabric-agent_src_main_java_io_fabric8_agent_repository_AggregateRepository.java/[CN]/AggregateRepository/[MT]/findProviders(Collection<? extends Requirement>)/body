{
  Map<Requirement,Collection<Capability>> result=new HashMap<Requirement,Collection<Capability>>();
  for (  Requirement requirement : requirements) {
    List<Capability> caps=new ArrayList<Capability>();
    for (    Repository repository : repositories) {
      Map<Requirement,Collection<Capability>> resMap=repository.findProviders(Collections.singleton(requirement));
      Collection<Capability> res=resMap != null ? resMap.get(requirement) : null;
      if (res != null) {
        caps.addAll(res);
      }
    }
    result.put(requirement,caps);
  }
  return result;
}
