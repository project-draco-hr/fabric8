{
  @SuppressWarnings("serial") InstallTask installTask=new InstallTask(){
    @Override public void install(    InstallContext installContext,    ProcessConfig config,    String id,    File installDir) throws Exception {
      config.setName(parameters.getName());
      String resourceName="process-launcher.tar.gz";
      final InputStream in=getClass().getClassLoader().getResourceAsStream(resourceName);
      Preconditions.checkNotNull(in,"Could not find " + resourceName + " on the file system");
      File tmpFile=File.createTempFile("process-launcher",".tar.gz");
      Files.copy(new InputSupplier<InputStream>(){
        @Override public InputStream getInput() throws IOException {
          return in;
        }
      }
,tmpFile);
      FileUtils.extractArchive(tmpFile,installDir,"tar zxf",untarTimeout,executor);
      File etc=new File(installDir,"etc");
      if (etc.mkdirs()) {
        LOGGER.debug("Creating etc directory {} of process {}.",etc,id);
      }
 else {
        LOGGER.debug("Directory etc {} of process {} exists. Skipping.",etc,id);
      }
      Files.write("",new File(etc,"config.properties"),Charsets.UTF_8);
      writeJvmConfig(etc,parameters.getJvmOptions());
      JarInstaller installer=new JarInstaller(parameters,executor);
      installer.install(installContext,config,id,installDir);
      if (postInstall != null) {
        postInstall.install(installContext,config,id,installDir);
      }
    }
  }
;
  return installViaScript(parameters,installTask);
}
