{
  if (initialized.compareAndSet(false,true)) {
    try {
      ObjectName objectName=new ObjectName(DEFAULT_DOMAIN,"type","apmAgent");
      ObjectInstance objectInstance=getMBeanServer().registerMBean(apmAgent,objectName);
      agentObjectName=objectInstance.getObjectName();
      ApmConfiguration configuration=apmAgent.getConfiguration();
      objectName=new ObjectName(DEFAULT_DOMAIN,"type","configuration");
      objectInstance=getMBeanServer().registerMBean(configuration,objectName);
      configurationObjectName=objectInstance.getObjectName();
    }
 catch (    Throwable e) {
      LOG.error("Failed to register apmAgent mbeans with mBeanServer ",e);
    }
  }
}
