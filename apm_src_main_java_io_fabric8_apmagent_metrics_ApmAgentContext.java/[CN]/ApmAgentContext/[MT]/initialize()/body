{
  if (initialized.compareAndSet(false,true)) {
    try {
      agentObjectName=new ObjectName(DEFAULT_DOMAIN,"type","apmAgent");
      registerMBean(agentObjectName,apmAgent);
      ApmConfiguration configuration=apmAgent.getConfiguration();
      configurationObjectName=new ObjectName(DEFAULT_DOMAIN,"type","configuration");
      registerMBean(configurationObjectName,configuration);
    }
 catch (    Throwable e) {
      LOG.error("Failed to register apmAgent mbeans with mBeanServer ",e);
    }
  }
}
