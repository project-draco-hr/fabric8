{
  Archetype archetype=archetypeService.getArchetype(archetypeGAV);
  if (archetype != null) {
    System.out.println(String.format("Generating %s:%s in %s",archetype.groupId,archetype.artifactId,target.getCanonicalPath()));
    InputStream archetypeInputStream=fetchArchetype(archetype);
    if (archetypeInputStream == null) {
      System.err.println("No archetype found for \"" + archetypeGAV + "\" coordinates");
      return null;
    }
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    IOUtils.copy(archetypeInputStream,baos);
    IOUtils.closeQuietly(archetypeInputStream);
    InputStream stream=new ByteArrayInputStream(baos.toByteArray());
    String defaultGroupId="io.fabric8";
    String defaultArtifactId=archetype.artifactId + "-example";
    String defaultVersion="1.0-SNAPSHOT";
    System.out.println("----- Configure archetype -----");
    String groupId=ShellUtils.readLine(session,String.format("Define value for property 'groupId' (%s):",defaultGroupId),false);
    String artifactId=ShellUtils.readLine(session,String.format("Define value for property 'artifactId' (%s):",defaultArtifactId),false);
    String version=ShellUtils.readLine(session,String.format("Define value for property 'version' (%s):",defaultVersion),false);
    groupId=groupId == null || groupId.trim().equals("") ? defaultGroupId : groupId;
    artifactId=artifactId == null || artifactId.trim().equals("") ? defaultArtifactId : artifactId;
    version=version == null || version.trim().equals("") ? defaultVersion : version;
    String defaultPackageName=(groupId + "." + artifactId).replaceAll("-",".");
    String packageName=ShellUtils.readLine(session,String.format("Define value for property 'package' (%s):",defaultPackageName),false);
    packageName=packageName == null || packageName.trim().equals("") ? defaultPackageName : packageName;
    ArchetypeHelper helper=new ArchetypeHelper(stream,target,groupId,artifactId,version);
    helper.setPackageName(packageName);
    Map<String,String> properties=helper.parseProperties();
    if (!properties.isEmpty()) {
      System.out.println("----- Configure additional properties -----");
      for (      String key : properties.keySet()) {
        String p=ShellUtils.readLine(session,String.format("Define value for property '%s' (%s):",key,properties.get(key)),false);
        p=p == null || p.trim().equals("") ? properties.get(key) : p;
        properties.put(key,p);
      }
    }
    helper.setOverrideProperties(properties);
    stream.reset();
    helper.execute();
  }
 else {
    System.err.println("No archetype found for \"" + archetypeGAV + "\" coordinates");
  }
  return null;
}
