{
  File baseDir=new File(System.getProperty("basedir","."));
  File srcDir=new File(baseDir,"src/main/resources");
  assertTrue("source dir doesn't exist! " + srcDir,srcDir.exists());
  assertTrue("source folder is not a directory " + srcDir,srcDir.isDirectory());
  File classesDir=new File(baseDir,"target/classes");
  File outFile=new File(classesDir,"io/fabric8/process/manager/controllerKinds");
  outFile.getParentFile().mkdirs();
  System.out.println("Generating controller kinds file: " + outFile);
  FileWriter writer=null;
  try {
    writer=new FileWriter(outFile);
    File[] list=srcDir.listFiles();
    String postfix=".json";
    List<String> kinds=Lists.newArrayList();
    assertNotNull("No JSON files found in source dir: " + srcDir,list);
    for (    File file : list) {
      if (!file.isFile())       continue;
      String name=file.getName();
      if (name.endsWith(postfix)) {
        String kind=name.substring(0,name.length() - postfix.length());
        kinds.add(kind);
        writer.write(kind + "\n");
      }
    }
    System.out.println("Found controller kinds: " + kinds);
  }
  finally {
    Closeables.closeQuietly(writer);
  }
  String groupId=System.getProperty("groupId","io.fabric8.process");
  String artifactId="process-launcher";
  String version=System.getProperty("version","1.1.0-SNAPSHOT");
  String classifier="bin";
  String extension="tar.gz";
  String name=groupId + "/" + artifactId+ "/"+ version;
  System.out.println("Loading bundle: " + name);
  File file=new File(baseDir + "/../process-launcher/target/" + artifactId+ "-"+ version+ "-bin.tar.gz");
  assertNotNull("Cannot find the file for " + name + " using "+ file.getPath(),file);
  File newFile=new File(classesDir,"process-launcher.tar.gz");
  Files.move(file,newFile);
  Files.copy(newFile,file);
  System.out.println("Moved process launch tarball to " + newFile);
}
