{
  Logger log=LoggerFactory.getLogger("test");
  PojoServiceRegistry registry=getRegistry();
  BundleContext bc=registry.getBundleContext();
  for (  Bundle b : bc.getBundles()) {
    log.info(String.format("Found bundle : %s with version %s in state %s",b.getSymbolicName(),b.getVersion(),b.getState()));
  }
  for (  ServiceReference ref : bc.getAllServiceReferences(null,null)) {
    log.info(String.format("Found Service reference : %s",ref.toString()));
  }
  log.info("Getting zk cluster service");
  ZooKeeperClusterService clusterService=getService(ZooKeeperClusterService.class,registry);
  assertNotNull(clusterService);
  log.info("done");
  List<String> agents=new ArrayList<String>();
  agents.add("root");
  log.info("Creating zk cluster config");
  clusterService.createCluster(agents);
  Thread.sleep(10000);
  log.info("Getting fabric service");
  FabricService service=getService(FabricService.class,registry);
  assertNotNull(service);
  log.info("Done");
  Thread.sleep(10000);
  log.info("Profiles :");
  for (  Profile profile : service.getDefaultVersion().getProfiles()) {
    log.info("Profile : " + profile.getId());
  }
}
