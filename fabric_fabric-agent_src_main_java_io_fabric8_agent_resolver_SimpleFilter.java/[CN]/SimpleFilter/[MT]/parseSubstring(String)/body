{
  List<String> pieces=new ArrayList();
  StringBuffer ss=new StringBuffer();
  boolean wasStar=false;
  boolean leftstar=false;
  boolean rightstar=false;
  int idx=0;
  boolean escaped=false;
  loop:   for (; ; ) {
    if (idx >= value.length()) {
      if (wasStar) {
        rightstar=true;
      }
 else {
        pieces.add(ss.toString());
      }
      ss.setLength(0);
      break loop;
    }
    char c=value.charAt(idx++);
    if (!escaped && (c == '*')) {
      if (!wasStar) {
        if (ss.length() > 0) {
          pieces.add(ss.toString());
        }
        ss.setLength(0);
        if (pieces.isEmpty()) {
          leftstar=true;
        }
        wasStar=true;
      }
    }
 else     if (!escaped && (c == '\\')) {
      escaped=true;
    }
 else {
      escaped=false;
      wasStar=false;
      ss.append(c);
    }
  }
  if (leftstar || rightstar || pieces.size() > 1) {
    if (rightstar) {
      pieces.add("");
    }
    if (leftstar) {
      pieces.add(0,"");
    }
  }
  return pieces;
}
